(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{1244:function(e,a,t){"use strict";var r=t(3),n=t.n(r),l=t(4),s=t.n(l),i=t(0),o=t.n(i),c=t(2),m=t(8),d=t(89),u=o.a.forwardRef(function(e,a){var t=e.children,r=e.classes,l=e.className,i=e.disableTypography,m=void 0!==i&&i,u=s()(e,["children","classes","className","disableTypography"]);return o.a.createElement("div",n()({className:Object(c.a)(r.root,l),ref:a},u),m?t:o.a.createElement(d.a,{variant:"h6"},t))});a.a=Object(m.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(u)},1245:function(e,a,t){"use strict";var r=t(3),n=t.n(r),l=t(0),s=t.n(l),i=t(8),o=t(89),c=s.a.forwardRef(function(e,a){return s.a.createElement(o.a,n()({component:"p",variant:"body1",color:"textSecondary",ref:a},e))});a.a=Object(i.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(c)},1252:function(e,a,t){!function(e){"use strict";e.defineLocale("fr",{months:"janvier_f\xe9vrier_mars_avril_mai_juin_juillet_ao\xfbt_septembre_octobre_novembre_d\xe9cembre".split("_"),monthsShort:"janv._f\xe9vr._mars_avr._mai_juin_juil._ao\xfbt_sept._oct._nov._d\xe9c.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd\u2019hui \xe0] LT",nextDay:"[Demain \xe0] LT",nextWeek:"dddd [\xe0] LT",lastDay:"[Hier \xe0] LT",lastWeek:"dddd [dernier \xe0] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,a){switch(a){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})}(t(59))},1534:function(e,a,t){"use strict";t.r(a);var r=t(0),n=t.n(r),l=t(39),s=t(7),i=t(136),o=t(89),c=t(1130),m=t(1221),d=t(1140),u=t(1204),p=t(1244),h=t(1229),f=t(1245),E=t(1230),v=t(1227),g=t(365),b=t(50),y=(t(60),t(102)),A=t(33),N=t(10);const w="[TEAMS APP] GET TEAMS",x="[TEAMS APP] SET SEARCH TEXT",O="[TEAMS APP] OPEN NEW TEAMS DIALOG",j="[TEAMS APP] CLOSE NEW TEAMS DIALOG",P="[TEAMS APP] OPEN EDIT TEAMS DIALOG",T="[TEAMS APP] CLOSE EDIT TEAMS DIALOG",M="[TEAMS APP] ADD TEAM",D="[TEAMS APP] SAVE ERROR",S="[TEAMS APP] UPDATE TEAM",C="[TEAMS APP] REMOVE TEAM",_="[TEAMS APP] UPLOAD IMAGE",L="[TEAMS APP] UPLOAD REQUEST",q="[TEAMS APP] UPLOAD ERROR";function R(e){const a=b.a.get("/api/acheteurs/".concat(e,"/teams"));return e=>a.then(a=>{e({type:w,payload:a.data["hydra:member"]})})}function I(){return{type:j}}function H(e,a){let t={del:!0};return(r,n)=>{return b.a.put(e["@id"],t).then(e=>Promise.all([r({type:C}),r(Object(A.B)({message:"Acheteur / Master bien supprim\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>r(R(a))))}}const k="[DIALOG] OPEN",F="[DIALOG] CLOSE";function Y(){return{type:F}}var W=t(59),V=t.n(W);var B=function(e){const a=Object(s.b)(),t=Object(s.c)(e=>{let{teamsApp:a}=e;return a.teams.entities}),i=Object(s.c)(e=>{let{auth:a}=e;return a.user}),b=Object(s.c)(e=>{let{teamsApp:a}=e;return a.teams.searchText}),[y,A]=Object(r.useState)(null);return Object(r.useEffect)(()=>{t&&A(function(e,a){const t=Object.keys(e).map(a=>e[a]);return 0===a.length?t:l.y.filterArrayByString(t,a)}(t,b))},[t,b]),y?0===y.length?n.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},n.a.createElement(o.a,{color:"textSecondary",variant:"h5"},"Il n'y a pas d'Acheteur / Master!")):n.a.createElement(l.d,{animation:"transition.slideUpIn",delay:300},n.a.createElement(g.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",data:y,columns:[{Header:"",Cell:e=>e.original.avatar?n.a.createElement(c.a,{className:"mr-8",alt:e.original.firstName,src:l.G+e.original.avatar.url}):n.a.createElement(c.a,{className:"mr-8",alt:e.original.firstName,src:"assets/images/avatars/images.png"}),className:"justify-center",width:64,sortable:!1},{Header:"Soci\xe9t\xe9",accessor:"user.societe",filterable:!0,Cell:e=>e.original.user?e.original.user.societe:""},{Header:"Nom & Pr\xe9nom",accessor:"user",filterable:!0,Cell:e=>e.original.acheteur?"".concat(e.original.acheteur.first_name," ").concat(e.original.acheteur.last_name):"".concat(e.original.user.first_name," ").concat(e.original.user.last_name)},{Header:"Ville",accessor:"user.ville",filterable:!0,Cell:e=>e.original.user?e.original.user.ville:""},{Header:"Email",accessor:"email",filterable:!0,Cell:e=>e.original.email?e.original.email:""},{Header:"T\xe9l\xe9phone",accessor:"phone",filterable:!0,Cell:e=>e.original.phone?e.original.phone:""},{Header:"Date de cr\xe9ation",Cell:e=>V()(e.original.created).format("DD/MM/YYYY HH:mm")},{Header:"",width:128,Cell:e=>n.a.createElement("div",{className:"flex items-center"},n.a.createElement(m.a,{title:"Editer"},n.a.createElement(d.a,{className:"text-orange text-20",onClick:t=>{t.stopPropagation(),a(function(e){return{type:P,data:e}}(e.original))}},n.a.createElement(u.a,null,"edit"))),n.a.createElement(m.a,{title:"Supprimer"},n.a.createElement(d.a,{className:"text-red text-20",onClick:t=>{t.stopPropagation(),a(function(e){return{type:k,options:e}}({children:n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{id:"alert-dialog-title"},"Suppression"),n.a.createElement(h.a,null,n.a.createElement(f.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),n.a.createElement(E.a,null,n.a.createElement(v.a,{onClick:()=>a(Y()),color:"primary"},"Non"),n.a.createElement(v.a,{onClick:t=>{a(H(e.original,i.id)),a(Y())},color:"primary",autoFocus:!0},"Oui")))}))}},n.a.createElement(u.a,null,"delete"))))}],defaultPageSize:10,noDataText:"No teams found"})):null},z=t(135),G=t(1139),U=t(1205);var Q=function(e){const a=Object(s.b)(),t=Object(s.c)(e=>{let{teamsApp:a}=e;return a.teams.searchText}),r=Object(s.c)(e=>{let{fuse:a}=e;return a.settings.mainTheme});return n.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},n.a.createElement("div",{className:"flex items-center"},n.a.createElement(l.d,{animation:"transition.expandIn",delay:300},n.a.createElement(u.a,{className:"text-32 mr-0 sm:mr-12"},"group")),n.a.createElement(l.d,{animation:"transition.slideLeftIn",delay:300},n.a.createElement(o.a,{className:"hidden sm:flex",variant:"h6"},"Cr\xe9ation d'acheteur / Master"))),n.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"},n.a.createElement(U.a,{theme:r},n.a.createElement(l.d,{animation:"transition.slideDownIn",delay:300},n.a.createElement(z.a,{className:"flex items-center w-full max-w-512 px-8 py-4 rounded-8",elevation:1},n.a.createElement(u.a,{className:"mr-8",color:"action"},"search"),n.a.createElement(G.a,{placeholder:"Rechercher...",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:t,inputProps:{"aria-label":"Search"},onChange:e=>a(function(e){return{type:x,searchText:e.target.value}}(e))}))))),n.a.createElement(l.d,{animation:"transition.slideRightIn",delay:300},n.a.createElement(v.a,{onClick:e=>a({type:O}),className:"whitespace-no-wrap",variant:"contained"},n.a.createElement("span",{className:"hidden sm:flex"},"Ajouter"),n.a.createElement("span",{className:"flex sm:hidden"},"New"))))},J=t(1223),X=t(1218),K=t(1228),Z=t(1231),$=t(1233),ee=t(1215),ae=t(1216),te=t(137),re=t(201),ne=t(51),le=t.n(ne),se=t(369),ie=t.n(se),oe=t(370),ce=t.n(oe);const me={};var de=function(e){const a=Object(s.b)(),t=Object(s.c)(e=>{let{teamsApp:a}=e;return a.teams.teamsDialog}),i=Object(s.c)(e=>{let{teamsApp:a}=e;return a.teams.imageReqInProgress}),m=Object(s.c)(e=>{let{teamsApp:a}=e;return a.teams.avatar}),p=Object(s.c)(e=>{let{auth:a}=e;return a.user}),{form:f,handleChange:g,setForm:w}=Object(te.b)(me),x=e=>{e.preventDefault()},[O,j]=Object(r.useState)(!1),P=Object(r.useRef)(null),[C,k]=Object(r.useState)({showPassword:!1}),F=()=>{k({...C,showPassword:!C.showPassword})},W=Object(r.useCallback)(()=>{"edit"===t.type&&t.data&&w({...t.data}),"new"===t.type&&w({...t.data,...me})},[t.data,t.type,w]);function V(){"edit"===t.type?a({type:T}):a(I())}function B(e){""!==f.societe&&""!==f.firstName&&""!==f.lastName&&""!==f.phone&&""!==f.email&&("new"!==t.type||""!==f.password&&""!==f.confirmpassword)&&("new"===t.type?a(function(e,a){const t={...e,codepostal:parseInt(e.codepostal,10),avatar:e.avatar?e.avatar["@id"]:null,isactif:!0};return(e,r)=>b.a.post("/api/teams",t).then(r=>{const n={societe:t.societe,firstName:t.firstName,lastName:t.lastName,phone:t.phone,email:t.email,password:t.password,confirmpassword:t.confirmpassword,avatar:t.avatar,isactif:!0};return b.a.post("/api/acheteurs",n).then(t=>(e({type:M}),e(Object(A.B)({message:"Acheteur / Master bien ajout\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"})),e(I()),e(R(a)),t))}).catch(a=>{throw e({type:D}),e(Object(A.B)({message:N.a.map(y.a.parseApiErrors(a),(e,a)=>"".concat(a,": ").concat(e)).join(", "),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"})),a})}(f,p.id)):a(function(e,a){const t={...e,avatar:e.avatar?e.avatar["@id"]:null};return(r,n)=>b.a.put(e["@id"],t).then(e=>Promise.all([r({type:S}),r(Object(A.B)({message:"Acheteur / Master bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>r(R(a)))).catch(e=>{r({type:D}),r(Object(A.B)({message:N.a.map(y.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}(f,p.id)),V())}return Object(r.useEffect)(()=>{t.props.open&&W()},[t.props.open,W]),Object(r.useEffect)(()=>{w(m?N.a.set({...f},"avatar",m):N.a.set({...f},"avatar",null))},[m]),n.a.createElement(J.a,Object.assign({classes:{paper:"m-24"}},t.props,{onClose:V,fullWidth:!0,maxWidth:"xs"}),n.a.createElement(X.a,{position:"static",elevation:1},n.a.createElement(K.a,{className:"flex w-full"},n.a.createElement(o.a,{variant:"subtitle1",color:"inherit"},"new"===t.type?"Nouveau Acheteur / Master":f.name))),n.a.createElement(le.a,{onValidSubmit:B,onValid:function(){j(!0)},onInvalid:function(){j(!1)},ref:P,className:"flex flex-col overflow-hidden"},n.a.createElement(h.a,{classes:{root:"p-24"}},n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"Soci\xe9t\xe9",id:"societe",name:"societe",value:f.societe,onChange:g,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"Nom",autoFocus:!0,id:"lastName",name:"lastName",value:f.lastName,onChange:g,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"Pr\xe9nom",id:"firstName",name:"firstName",value:f.firstName,onChange:g,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"Adresse 1",id:"adresse1",name:"adresse1",value:f.adresse1,onChange:g,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"Adresse 2",id:"adresse2",name:"adresse2",value:f.adresse2,onChange:g,variant:"outlined",fullWidth:!0})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"Code postal",id:"codepostal",type:"number",name:"codepostal",value:N.a.toString(f.codepostal),onChange:g,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"T\xe9l\xe9phone",id:"phone",name:"phone",value:f.phone,onChange:g,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",label:"E-mail",id:"email",name:"email",value:f.email,onChange:g,variant:"outlined",validations:"isEmail",validationErrors:{isEmail:"Ce n'est pas un email valide",isDefaultRequiredValue:"Ce champ est requis"},required:!0,fullWidth:!0})),"new"===t.type&&n.a.createElement("div",null,n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",type:C.showPassword?"text":"password",name:"password",label:"Mot de passe",value:f.password,onChange:g,variant:"outlined",required:!0,fullWidth:!0,InputProps:{endAdornment:n.a.createElement(Z.a,{position:"end"},n.a.createElement(d.a,{"aria-label":"toggle password visibility",onClick:F,onMouseDown:x},C.showPassword?n.a.createElement(ie.a,null):n.a.createElement(ce.a,null)))},validations:{minLength:6},validationErrors:{minLength:"Le mot de passe doit contenir au moins 6 caract\xe8res",isDefaultRequiredValue:"Ce champ est requis"}})),n.a.createElement("div",{className:"flex"},n.a.createElement(l.F,{className:"mb-24",type:C.showPassword?"text":"password",name:"confirmpassword",label:"Confirmer mot de passe",value:f.confirmpassword,onChange:g,validations:{equalsField:"password"},validationErrors:{equalsField:"Les mots de passe doivent correspondre",isDefaultRequiredValue:"Ce champ est requis"},variant:"outlined",required:!0,fullWidth:!0,InputProps:{endAdornment:n.a.createElement(Z.a,{position:"end"},n.a.createElement(d.a,{"aria-label":"toggle password visibility",onClick:F,onMouseDown:x},C.showPassword?n.a.createElement(ie.a,null):n.a.createElement(ce.a,null)))}}))),i?n.a.createElement("div",{style:{paddingBottom:10,paddingTop:10,textAlign:"center"}},n.a.createElement($.a,null)):m&&n.a.createElement("div",{style:{textAlign:"center",paddingBottom:10,paddingTop:10}},n.a.createElement(c.a,{src:"".concat(re.d).concat(m),style:{margin:"0 auto",height:"150px",width:"150px"}})),n.a.createElement("div",{className:"flex items-center"},n.a.createElement(ee.a,{control:n.a.createElement(ae.a,{checked:f.isactif,onChange:e=>{console.log("Toggling isactif to:",e.target.checked),w({...f,isactif:e.target.checked})}}),label:"Actif"}))," *",n.a.createElement("div",{className:"flex"},n.a.createElement("input",{accept:"image/*",className:"hidden",id:"button-file",type:"file",onChange:function(e){const t=e.target.files[0];t&&a(function(e){return(a,t)=>{const r=new FormData;r.append("file",e);const n=b.a.post("/api/avatars",r,{headers:{"Content-Type":"multipart/form-data"}});return a({type:L}),n.then(e=>Promise.all([e,a({type:_,payload:e.data}),a(Object(A.B)({message:"Image t\xe9l\xe9charg\xe9e!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))])).catch(e=>{a({type:q}),a(Object(A.B)({message:N.a.map(y.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(t))}}),n.a.createElement("label",{htmlFor:"button-file"},n.a.createElement(v.a,{variant:"outlined",component:"span",className:"flex flex-1",disabled:i},"T\xe9l\xe9charger une image")))),"edit"===t.type?n.a.createElement(E.a,{className:"justify-between p-8"},n.a.createElement("div",{className:"px-16"},n.a.createElement(v.a,{variant:"contained",color:"primary",onClick:B,disabled:!O},"Sauvegarder")),n.a.createElement(d.a,{className:"min-w-auto",onClick:function(){a(H(f,p.id)),a(Y()),V()}},n.a.createElement(u.a,null,"delete"))):n.a.createElement(E.a,{className:"justify-between p-8"},n.a.createElement("div",{className:"px-16"},n.a.createElement(v.a,{variant:"contained",color:"primary",type:"submit",disabled:!O},"Ajouter")))))},ue=t(43);const pe={entities:null,searchText:"",selectedTeamsIds:[],routeParams:{},teamsDialog:{type:"new",props:{open:!1},data:null},avatar:null,imageReqInProgress:!1};var he=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case w:return{...e,entities:a.payload};case x:return{...e,searchText:a.searchText};case O:return{...e,teamsDialog:{type:"new",props:{open:!0},data:null}};case j:return{...e,teamsDialog:{type:"new",props:{open:!1},data:null}};case P:return{...e,teamsDialog:{type:"edit",props:{open:!0},data:a.data}};case T:return{...e,teamsDialog:{type:"edit",props:{open:!1},data:null}};case L:return{...e,imageReqInProgress:!0};case _:return{...e,avatar:a.payload,imageReqInProgress:!1};case q:return{...e,imageReqInProgress:!1};case"[TEAMS APP APP] REQUEST_SAVE":return{...e,loading:!0};case"[TEAMS APP APP]  SAVE_DATA":return{...e,loading:!1};default:return e}};const fe={state:!1,options:{children:"Hi"}};var Ee=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case A.f:return{...e,state:!0,options:{...e.options,...a.options}};case A.a:return{...e,state:!1};default:return e}};var ve=Object(ue.d)({teams:he,dialog:Ee}),ge=t(364);t(1252);a.default=Object(i.a)("teamsApp",ve)(function(e){const a=Object(s.b)(),t=Object(r.useRef)(null),i=Object(s.c)(e=>{let{auth:a}=e;return a.user}),o=Object(s.c)(e=>{let{auth:a}=e;return a.user.abonnement}),c=Object(s.c)(e=>{let{auth:a}=e;return a.user.loadingAbonnement}),[m,d]=Object(r.useState)(!1),[u,p]=Object(r.useState)(!0),[h,f]=Object(r.useState)(!1),[E,v]=Object(r.useState)(0);return Object(r.useEffect)(()=>{if(!o)return;if(!o.statut)return void p(!1);let e=V()(o.expired).diff(V()(),"days");v(e),e<=0&&f(!0),o.statut&&e>0&&d(!0)},[o]),Object(r.useEffect)(()=>{i.id&&a(R(i.id))},[a,i]),c?n.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},n.a.createElement($.a,{color:"secondary"})," \u2002 Chargement ..."):n.a.createElement(n.a.Fragment,null,n.a.createElement(ge.Helmet,null,n.a.createElement("title",null,"Acheteur / Master | Les Achats Industriels"),n.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),n.a.createElement("meta",{name:"googlebot",content:"noindex"})),n.a.createElement(l.p,{classes:{contentWrapper:"p-0 sm:p-24 pb-80 sm:pb-80 h-full",content:"flex flex-col h-full",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:n.a.createElement(Q,{pageLayout:t}),content:n.a.createElement(B,null),sidebarInner:!0,ref:t,innerScroll:!0}),n.a.createElement(de,null))})}}]);