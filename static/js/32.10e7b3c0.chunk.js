(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1049:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};t.default=n},1051:function(e,t,a){"use strict";var n=a(3),r=a.n(n),i=a(4),c=a.n(i),o=a(0),s=a.n(o),l=(a(1),a(2)),u=a(7),d=a(98),m=s.a.forwardRef(function(e,t){var a=e.children,n=e.classes,i=e.className,o=e.disableTypography,u=void 0!==o&&o,m=c()(e,["children","classes","className","disableTypography"]);return s.a.createElement("div",r()({className:Object(l.a)(n.root,i),ref:t},m),u?a:s.a.createElement(d.a,{variant:"h6"},a))});t.a=Object(u.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(m)},1052:function(e,t,a){"use strict";var n=a(3),r=a.n(n),i=a(0),c=a.n(i),o=(a(1),a(7)),s=a(98),l=c.a.forwardRef(function(e,t){return c.a.createElement(s.a,r()({component:"p",variant:"body1",color:"textSecondary",ref:t},e))});t.a=Object(o.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(l)},1068:function(e,t,a){"use strict";var n=a(36),r=a(54),i=a(64),c=a.n(i),o="[DEMANDES APP] REQUEST DEMANDES",s="[DEMANDES APP] REMOVE DEMANDES",l="[DEMANDES APP] STATUT DEMANDES",u="[DEMANDES APP] SET PARAMETRES DATA",d="[DEMANDES APP] CLEAN_UP",m="[USERS APP] GET DEMANDES",f="[USERS APP] SET DEMANDES SEARCH TEXT";function E(){return function(e){return e({type:d})}}function p(e,t){var a="";t.search.length>0&&t.search.map(function(e,t){e.value&&("created"===e.id||"dateExpiration"===e.id?a+="&"+e.id+"[after]="+e.value:"statut"===e.id?"0"===e.value?a+="&statut=0&dateExpiration[strictly_after]=".concat(c()().format("YYYY-MM-DDTHH:mm:ss")):"1"===e.value?a+="&statut=1&dateExpiration[strictly_after]=".concat(c()().format("YYYY-MM-DDTHH:mm:ss")):"2"===e.value?a+="&statut=2&dateExpiration[strictly_after]=".concat(c()().format("YYYY-MM-DDTHH:mm:ss")):"3"===e.value?a+="&statut=3":"4"===e.value&&(a+="&dateExpiration[strictly_before]=".concat(c()().format("YYYY-MM-DDTHH:mm:ss"))):a+="&"+e.id+"="+e.value)});var n=r.a.get("/api/acheteurs/".concat(e,"/demandes?page=").concat(t.page).concat(a,"&order[").concat(t.filter.id,"]=").concat(t.filter.direction));return function(e){return e({type:o}),n.then(function(t){return e({type:m,payload:t.data})})}}function g(e,t,a){var i={del:!0,reference:e.reference+"_deleted-"+e.id};return function(c,o){return r.a.put("/api/demande_achats/".concat(e.id),i).then(function(e){return Promise.all([c({type:s}),c(Object(n.B)({message:"Demande bien supprim\xe9e!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return c(p(a,t))})})}}function h(e,t,a,i){var c={isPublic:t};return function(o){return r.a.put("/api/demande_achats/".concat(e.id),c).then(function(e){return Promise.all([o({type:l}),o(Object(n.B)({message:t?"Votre demande est publi\xe9e aux publics":"Votre demande est priv\xe9e",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return o(p(i,a))})})}}function b(e){return{type:u,parametres:e}}var v=a(8),y=a(40),N=a(10),A="[ DEMANDE ACHETEUR APP] REQUEST DEMANDE",O="[ DEMANDE ACHETEUR APP] GET DEMANDE",x="[ DEMANDE ACHETEUR APP] REQUEST DEMANDE FOURNISSEURS",S="[ DEMANDE ACHETEUR APP] GET DEMANDEFOURNISSEURS",j="[ DEMANDE ACHETEUR APP] REQUEST SAVE",P="[ DEMANDE ACHETEUR APP] NEW DEMANDE",D="[ DEMANDE ACHETEUR APP] SAVE ERROR",C="[ DEMANDE ACHETEUR APP] REQUEST SOUS_SECTEUR",R="[ DEMANDE ACHETEUR APP] GET SOUS SECTEUR",T="[ DEMANDE ACHETEUR APP] UPLOAD ATTACHEMENT",w="[ DEMANDE ACHETEUR APP] UPLOAD REQUEST",M="[ DEMANDE ACHETEUR APP] UPLOAD ERROR",F="[ DEMANDE ACHETEUR APP] REQUEST DELETE",I="[ DEMANDE ACHETEUR APP] DELETE SUCCESS",U="[ DEMANDE ACHETEUR APP] ERROR DELETE",H="[ DEMANDE ACHETEUR APP] CLEAN_UP",k="[ DEMANDE ACHETEUR APP] REQUEST_SAVE_FOURNISSEUR",_="[ DEMANDE ACHETEUR APP] SAVE_FOURNISSEUR";function z(){return function(e){return e({type:H})}}function L(e){var t=r.a.get("/api/demande_achats/".concat(e));return function(e){return e({type:A}),t.then(function(t){e({type:O,payload:t.data})}).catch(function(t){e({type:D,payload:y.y.parseApiErrors(t)})})}}function q(e){var t=r.a.get("/api/demande_achats/".concat(e,"/visites"));return function(e){return e({type:x}),t.then(function(t){e({type:S,payload:t.data})})}}function Y(e,t){var a={id_fournisseur:e},n=r.a.post("/api/demande_achats/".concat(t,"/fournisseur_gagne"),a);return function(e){return e({type:k}),n.then(function(t){e({type:_}),e(L(t.data.id))}).catch(function(e){})}}function G(e,t,a,i,c){var o=Object(v.a)({},e,{categories:N.a.map(a,function(e,t){return e["@id"]}),attachements:N.a.map(e.attachements,function(e,t){return e["@id"]}),autreCategories:i.length>0?N.a.join(N.a.map(i),", "):null,budget:e.budget&&parseFloat(e.budget)}),s=r.a.post("/api/demande_achats",o);return function(e){return e({type:j}),s.then(function(a){e(Object(n.B)({message:"Demande enregistr\xe9e"})),c?(e(W()),e({type:P})):t.push("/demandes")}).catch(function(t){e({type:D,payload:y.y.parseApiErrors(t)})})}}function V(e,t,a,i,c,o,s,l){var u=Object(v.a)({},e,{categories:N.a.map(i,function(e,t){return e["@id"]}),attachements:N.a.map(e.attachements,function(e,t){return e["@id"]}),budget:e.budget&&parseFloat(e.budget),autreCategories:c.length>0?N.a.join(N.a.map(c),", "):null,updated:o,updateExpiration:s,annulation:l});delete u.reference,u.motifRejet&&delete u.motifRejet;var d=r.a.put("/api/demande_achats/".concat(t),u);return function(e){return e({type:j}),d.then(function(t){e(Object(n.B)({message:"Demande Modifi\xe9e"})),a.push("/demandes")}).catch(function(t){e({type:D,payload:y.y.parseApiErrors(t)})})}}function B(e){var t=r.a.delete(e["@id"]);return function(a){return a({type:F}),t.then(function(t){return a(Object(n.B)({message:"Document supprim\xe9"})),a({type:I,id:e.id})}).catch(function(e){a({type:U,payload:y.y.parseApiErrors(e)})})}}function Q(e){return function(t,a){var i=new FormData;i.append("file",e);var c=r.a.post("/api/attachements",i,{headers:{"Content-Type":"multipart/form-data"}});return t({type:w}),c.then(function(e){return Promise.all([e,console.log(e.data),t({type:T,payload:e.data}),t(Object(n.B)({message:"Document t\xe9l\xe9charg\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))])}).catch(function(e){t({type:M}),t(Object(n.B)({message:N.a.map(y.y.parseApiErrors(e),function(e,t){return t+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}function W(){return{type:O,payload:{id:null,reference:"",description:"",localisation:1,dateExpiration:null,isPublic:!1,isAnonyme:!1,categories:null,budget:0,motifRejet:"",statut:null,attachements:[],diffusionsdemandes:[]}}}var J,$,K=a(67),X=a.n(K),Z="[SEARCH CATEGORIES FRS APP] SC_SET_SEARCH_TEXT",ee="[SEARCH CATEGORIES FRS APP] REQUEST_DATA",te="[SEARCH CATEGORIES FRS APP] GET_DATA",ae="[SEARCH CATEGORIES FRS APP] SC_OPEN",ne="[SEARCH CATEGORIES FRS APP] SC_CLOSE",re="[SEARCH CATEGORIES FRS APP] SC_SUSSP",ie=X.a.CancelToken;function ce(e){return $&&clearTimeout($),function(t){t({type:ee}),$=setTimeout(function(){t(function(e){J&&J();var t=r.a.get("/api/categories?name=".concat(e,"&del=false&props[]=id&props[]=name"),{cancelToken:new ie(function(e){J=e})});return function(e){return t.then(function(t){e({type:te,payload:t.data})}).catch(function(e){X.a.isCancel(e)&&console.log("get canceled")})}}(e))},300+1e3*Math.random())}}function oe(e){return{type:Z,searchText:e.target.value}}function se(){return{type:ae}}function le(){return{type:ne}}var ue="[DIALOG] OPEN",de="[DIALOG] CLOSE";function me(){return{type:de}}function fe(e){return{type:ue,options:e}}a.d(t,"n",function(){return o}),a.d(t,"A",function(){return u}),a.d(t,"a",function(){return d}),a.d(t,"f",function(){return m}),a.d(t,"z",function(){return f}),a.d(t,"E",function(){return E}),a.d(t,"J",function(){return p}),a.d(t,"Q",function(){return g}),a.d(t,"j",function(){return h}),a.d(t,"U",function(){return b}),a.d(t,"m",function(){return A}),a.d(t,"e",function(){return O}),a.d(t,"o",function(){return x}),a.d(t,"g",function(){return S}),a.d(t,"p",function(){return j}),a.d(t,"s",function(){return"[ DEMANDE ACHETEUR APP] SAVE DEMANDE"}),a.d(t,"i",function(){return P}),a.d(t,"t",function(){return D}),a.d(t,"r",function(){return C}),a.d(t,"h",function(){return R}),a.d(t,"B",function(){return T}),a.d(t,"D",function(){return w}),a.d(t,"C",function(){return M}),a.d(t,"l",function(){return F}),a.d(t,"c",function(){return I}),a.d(t,"b",function(){return H}),a.d(t,"q",function(){return k}),a.d(t,"u",function(){return _}),a.d(t,"F",function(){return z}),a.d(t,"I",function(){return L}),a.d(t,"K",function(){return q}),a.d(t,"S",function(){return Y}),a.d(t,"R",function(){return G}),a.d(t,"P",function(){return V}),a.d(t,"H",function(){return B}),a.d(t,"W",function(){return Q}),a.d(t,"N",function(){return W}),a.d(t,"x",function(){return Z}),a.d(t,"k",function(){return ee}),a.d(t,"d",function(){return te}),a.d(t,"w",function(){return ae}),a.d(t,"v",function(){return ne}),a.d(t,"y",function(){return re}),a.d(t,"a",function(){}),a.d(t,"E",function(){}),a.d(t,"M",function(){return ce}),a.d(t,"T",function(){return oe}),a.d(t,"V",function(){return se}),a.d(t,"L",function(){return le}),a.d(t,"G",function(){return me}),a.d(t,"O",function(){return fe})},1151:function(e,t,a){"use strict";var n=a(46),r=a(8),i=a(1068),c=a(107),o={data:[],pageCount:null,loading:!1,searchText:"",parametres:{page:1,search:[],description:"",filter:{id:"created",direction:"desc"}}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.a:return Object(r.a)({},e,{data:[]});case i.n:return Object(r.a)({},e,{loading:!0});case i.f:return Object(r.a)({},e,{data:t.payload["hydra:member"],pageCount:c.a.hydraPageCount(t.payload),loading:!1});case i.z:return Object(r.a)({},e,{searchText:t.searchText});case i.A:return Object(r.a)({},e,{parametres:{page:t.parametres.page,search:t.parametres.search,description:t.parametres.description,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}});default:return e}},l={data:null,fournisseurs:[],error:null,sousSecteurs:null,loading:!1,attachementReqInProgress:!1,deleteReqInProgress:!1,attachement:null,attachement_deleted:null,new:!1,requestSaveFrs:!1},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.r:case i.m:case i.p:return Object(r.a)({},e,{loading:!0,new:!1});case i.q:return Object(r.a)({},e,{requestSaveFrs:!0});case i.u:return Object(r.a)({},e,{requestSaveFrs:!1});case i.o:return Object(r.a)({},e,{loadingFrs:!0});case i.g:return Object(r.a)({},e,{fournisseurs:t.payload["hydra:member"],loadingFrs:!1});case i.b:return Object(r.a)({},l,{new:!1});case i.i:return Object(r.a)({},e,{new:!0});case i.D:return Object(r.a)({},e,{attachementReqInProgress:!0});case i.l:return Object(r.a)({},e,{deleteReqInProgress:!0});case i.B:return Object(r.a)({},e,{attachement:t.payload,attachementReqInProgress:!1});case i.c:return Object(r.a)({},e,{deleteReqInProgress:!1,attachement_deleted:t.id});case i.C:return Object(r.a)({},e,{attachementReqInProgress:!1});case i.h:return Object(r.a)({},e,{sousSecteurs:t.payload,loading:!1});case i.e:return Object(r.a)({},e,{data:t.payload,loading:!1});case i.s:return Object(r.a)({},e,{loading:!1,data:null});case i.t:return Object(r.a)({},e,{error:t.payload,loading:!1});default:return e}},d={searchText:"",suggestions:[],loading:!1,opened:!1,noSuggestions:!1},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.a:return Object(r.a)({},e,{suggestions:[],noSuggestions:!1});case i.i:return Object(r.a)({},d);case i.k:return Object(r.a)({},e,{loading:!0,suggestions:[],noSuggestions:!1});case i.d:var a=t.payload["hydra:member"],n=0===a.length;return Object(r.a)({},e,{suggestions:a,noSuggestions:n,loading:!1});case i.x:return Object(r.a)({},e,{searchText:t.searchText});case i.w:return Object(r.a)({},e,{opened:!0});case i.v:return Object(r.a)({},e,{opened:!1,searchText:""});case i.y:return Object(r.a)({},e,{opened:!1});default:return e}},f=a(36),E={state:!1,options:{children:"Hi"}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.f:return Object(r.a)({},e,{state:!0,options:Object(r.a)({},e.options,t.options)});case f.a:return Object(r.a)({},e,{state:!1});default:return e}},g=Object(n.d)({demandes:s,demande:u,dialog:p,searchCategories:m});t.a=g},1234:function(e,t,a){"use strict";var n=a(173);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),i=(0,n(a(348)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),r.default.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})),"Error");t.default=i},1332:function(e,t,a){"use strict";a.r(t);var n=a(21),r=a(8),i=a(23),c=a(92),o=a(0),s=a.n(o),l=a(1035),u=a(1017),d=a(98),m=a(1013),f=a(1041),E=a(1032),p=a(1044),g=a(1027),h=a(971),b=a(1040),v=a(1039),y=a(966),N=a(974),A=a(1023),O=a(1046),x=a(1029),S=a(1031),j=a(1051),P=a(1037),D=a(1052),C=a(1038),R=a(958),T=a(163),w=a(954),M=a(345),F=a(40),I=a(197),U=a(141),H=a(18),k=a(2),_=a(10),z=a(6),L=a(140),q=a(1068),Y=a(1151),G=a(55),V=a.n(G),B=a(64),Q=a.n(B),W=a(1049),J=a.n(W),$=a(1234),K=a.n($),X=a(347),Z=a(143),ee=a.n(Z),te=a(967),ae=a(139),ne=a(963),re=a(353),ie=a.n(re),ce=a(346),oe=Object(w.a)(function(e){return{root:{color:e.palette.secondary.main,backgroundColor:"white","&:hover":{backgroundColor:e.palette.secondary.main,color:"white"}}}})(l.a),se=(Object(w.a)(function(e){return{root:{color:T.a[500],borderColor:T.a[500],"&:hover":{backgroundColor:T.a[700],color:"white"}}}})(l.a),Object(w.a)(function(e){return{root:{color:J.a[500],borderColor:J.a[500],"&:hover":{backgroundColor:J.a[700],color:"white"}}}})(l.a),Object(M.a)(function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chips:{flex:1,display:"flex",flexWrap:"wrap"},buttonProgress:{color:J.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},demandeImageFeaturedStar:{position:"absolute",top:0,right:0,color:T.a[400],opacity:0},demandeImageUpload:{transitionProperty:"box-shadow",transitionDuration:e.transitions.duration.short,transitionTimingFunction:e.transitions.easing.easeInOut},select:{zIndex:999},demandeImageItem:{transitionProperty:"box-shadow",transitionDuration:e.transitions.duration.short,transitionTimingFunction:e.transitions.easing.easeInOut,"&:hover":{"& $demandeImageFeaturedStar":{opacity:.8}},"&.featured":{pointerEvents:"none",boxShadow:e.shadows[3],"& $demandeImageFeaturedStar":{opacity:1},"&:hover $demandeImageFeaturedStar":{opacity:1}}},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:e.spacing(2)},error:{backgroundColor:e.palette.error.dark},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"},margin:{margin:e.spacing(1)},titre:{paddingLeft:"10px",borderLeft:"10px solid "+e.palette.secondary.main}}}));function le(e,t){var a=t.query,n=t.isHighlighted;return s.a.createElement(ne.a,{selected:n,component:"div",className:"z-999",dense:!0},s.a.createElement(u.a,{className:"pl-0 ",primary:s.a.createElement(ie.a,{highlightClassName:"YourHighlightClass",searchWords:[a],autoEscape:!0,textToHighlight:e.name})}))}function ue(e){var t=e.classes,a=e.inputRef,n=void 0===a?function(){}:a,r=e.ref,i=Object(c.a)(e,["classes","inputRef","ref"]);return s.a.createElement(te.a,Object.assign({fullWidth:!0,InputProps:{inputRef:function(e){r(e),n(e)},classes:{input:t.input}},required:!0},i))}Q.a.defaultFormat="DD/MM/YYYY HH:mm",t.default=Object(L.a)("demandesAcheteurApp",Y.a)(function(e){var t=Object(o.useRef)(null),a=Object(o.useRef)(null),c=Object(z.c)(function(e){return e.demandesAcheteurApp.searchCategories}),T=s.a.useState([]),w=Object(i.a)(T,2),M=w[0],L=w[1],Y=s.a.useState([]),G=Object(i.a)(Y,2),B=G[0],W=G[1],J=Object(z.b)(),$=Object(z.c)(function(e){return e.demandesAcheteurApp.demande}),Z=Object(o.useState)(!1),te=Object(i.a)(Z,2),re=te[0],ie=te[1],de=Object(o.useState)(!1),me=Object(i.a)(de,2),fe=me[0],Ee=me[1],pe=Object(o.useState)(!1),ge=Object(i.a)(pe,2),he=ge[0],be=ge[1],ve=Object(o.useState)(null),ye=Object(i.a)(ve,2),Ne=ye[0],Ae=ye[1],Oe=Object(o.useRef)(null),xe=Object(U.b)(null),Se=xe.form,je=xe.handleChange,Pe=xe.setForm,De=se(e),Ce=Object(o.useState)(0),Re=Object(i.a)(Ce,2),Te=Re[0],we=Re[1],Me=e.match.params.demandeId,Fe=Object(o.useState)(!1),Ie=Object(i.a)(Fe,2),Ue=Ie[0],He=Ie[1],ke=Object(o.useState)(!1),_e=Object(i.a)(ke,2),ze=_e[0],Le=_e[1];function qe(e,t){Pe(_.a.set(Object(r.a)({},Se),t,e.target.checked))}function Ye(){ie(!1)}function Ge(e){27===e.keyCode&&(Ve(),J(q.E()))}function Ve(){J(q.L()),document.removeEventListener("keydown",Ge,!1)}Object(o.useEffect)(function(){return"new"===Me?J(q.N()):(J(q.I(Me)),J(q.K(Me))),function(){J(q.F())}},[J,Me]),Object(o.useEffect)(function(){$.error&&($.error.titre||$.error.description||$.error.dateExpiration||$.error.isPublic||$.error.isAnonyme||$.error.sousSecteurs)&&(Oe.current.updateInputsWithError(Object(r.a)({},$.error)),Ye(),$.error=null)},[$.error]),Object(o.useEffect)(function(){$.attachement&&(Pe(_.a.set(Object(r.a)({},Se),"attachements",[$.attachement].concat(Object(n.a)(Se.attachements)))),$.attachement=null)},[Se,Pe,$.attachement]),Object(o.useEffect)(function(){$.attachement_deleted&&(Pe(_.a.set(Object(r.a)({},Se),"attachements",_.a.pullAllBy(Se.attachements,[{id:$.attachement_deleted}],"id"))),$.attachement_deleted=null)},[$.attachement_deleted]),Object(o.useEffect)(function(){$.new&&(Pe(Object(r.a)({},$.data)),L([]),$.new=!1)},[$,Pe]),Object(o.useEffect)(function(){($.data&&!Se||$.data&&Se&&$.data.id!==Se.id)&&(Pe(Object(r.a)({},$.data)),$.data.categories&&L($.data.categories.map(function(e){return e})),$.data.autreCategories&&W(_.a.split($.data.autreCategories,",")))},[Se,$.data,Pe]),Object(o.useEffect)(function(){"new"!==Me&&$.data&&Se&&1===$.data.statut&&($.data.titre===Se.titre&&$.data.description===Se.description&&_.a.isEqual($.data.attachements,Se.attachements)&&_.a.isEqual(M,$.data.categories)?Ee(!1):Ee(!0))},[Se,$.data,Me,M]),Object(o.useEffect)(function(){if("new"!==Me&&$.data&&Se&&1===$.data.statut)if(Q()($.data.dateExpiration).isSame(Se.dateExpiration))Ae(null),be(!1);else{var e=Q.a.duration(Q()(Se.dateExpiration).diff($.data.dateExpiration)),t=e.hours(),a=e.days(),n=e.months(),r=e.years(),i=0!==r&&"".concat(r," an(s)")||0!==n&&"".concat(n," mois")||0!==a&&"".concat(a," jour(s)")||0!==t&&"".concat(t," heure(s)");Ae(i=(r<0||n<0||a<0||t<0?"\xe9court\xe9e de ":"prolong\xe9e de ")+i),be(!0)}},[Se,$.data,Me]);var Be={renderInputComponent:ue,suggestions:c.suggestions,focusInputOnSuggestionClick:!1,onSuggestionsFetchRequested:function(e){var t=e.value;"input-changed"===e.reason&&t&&t.trim().length>1&&J(q.M(t.trim()))},onSuggestionsClearRequested:function(){},renderSuggestion:le};function Qe(){-1===B.indexOf(c.searchText)&&W([c.searchText].concat(Object(n.a)(B))),Ve(),J(q.E())}function We(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.match.params.demandeId;J("new"===a?q.R(Se,e.history,M,B,t):q.P(Se,Se.id,e.history,M,B,fe,he,t))}return s.a.createElement(s.a.Fragment,null,s.a.createElement(ce.Helmet,null,s.a.createElement("title",null,"new"===Me?"Nouvelle demande":"Edit demande"," | Les Achats Industriels"),s.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),s.a.createElement("meta",{name:"googlebot",content:"noindex"})),s.a.createElement(F.o,{classes:{toolbar:"p-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:$.loading?"":Se&&s.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},s.a.createElement("div",{className:"flex flex-col items-start max-w-full"},s.a.createElement(F.d,{animation:"transition.slideRightIn",delay:300},s.a.createElement(d.a,{className:"normal-case flex items-center sm:mb-12",component:H.a,role:"button",to:"/demandes",color:"inherit"},s.a.createElement(m.a,{className:"mr-4 text-20"},"arrow_back"),"Retour")),s.a.createElement("div",{className:"flex items-center max-w-full"},s.a.createElement("div",{className:"flex flex-col min-w-0"},s.a.createElement(F.d,{animation:"transition.slideLeftIn",delay:300},s.a.createElement(d.a,{className:"text-16 sm:text-20 truncate"},Se.titre?Se.titre:"Nouvelle Demande")),s.a.createElement(F.d,{animation:"transition.slideLeftIn",delay:300},s.a.createElement(d.a,{variant:"caption"},"D\xe9tails de la demande"))))),s.a.createElement("div",null,s.a.createElement(l.a,{className:"whitespace-no-wrap",variant:"contained",color:"secondary",disabled:!re||$.loading||!M.length&&!B.length||3===$.data.statut,onClick:function(){return We(!1)}},s.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder"),s.a.createElement("span",{className:"flex sm:hidden"},s.a.createElement(m.a,null,"save")),$.loading&&s.a.createElement(f.a,{size:24,className:De.buttonProgress})),"new"===Me&&s.a.createElement(l.a,{className:"ml-8",color:"secondary",variant:"contained",disabled:!re||$.loading||!M.length&&!B.length,onClick:function(){return We(!0)}},s.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder et ajouter nouvelle demande"),s.a.createElement("span",{className:"flex sm:hidden"},s.a.createElement(m.a,null,"repeat")),$.loading&&s.a.createElement(f.a,{size:24,className:De.buttonProgress})))),contentToolbar:$.loading?s.a.createElement("div",{className:De.root},s.a.createElement(E.a,{color:"secondary"})):s.a.createElement(p.a,{value:Te,onChange:function(e,t){we(t)},indicatorColor:"secondary",textColor:"secondary",variant:"scrollable",scrollButtons:"auto",classes:{root:"w-full h-64"}},s.a.createElement(g.a,{className:"h-64 normal-case",label:"Infos g\xe9n\xe9rales"}),s.a.createElement(g.a,{className:"h-64 normal-case",label:Se&&Se.attachements.length>0?"Pi\xe8ce(s) jointe(s) ("+Se.attachements.length+")":"Pi\xe8ce(s) jointe(s)"}),$&&$.fournisseurs.length>0&&!$.data.isAnonyme?s.a.createElement(g.a,{className:Object(k.a)("h-64 normal-case text-orange",3===$.data.statut?"text-green":"text-orange"),label:$.data&&$.data&&3===$.data.statut?"Adjug\xe9e":$.fournisseurs.length+" fournisseur(s) participant(s)"}):""),content:$.loading?"":Se&&s.a.createElement("div",{className:"p-10  sm:p-24 max-w-2xl"},0===Te&&s.a.createElement(V.a,{onValidSubmit:We,onValid:function(){ie(!0)},onInvalid:Ye,ref:Oe,className:"flex flex-col "},Se.statut&&2===Se.statut?s.a.createElement(h.a,{className:Object(k.a)(De.margin,De.error),"aria-describedby":"client-snackbar",message:s.a.createElement("span",{id:"client-snackbar",className:De.message},s.a.createElement(K.a,{className:Object(k.a)(De.icon,De.iconVariant)}),"Motif du rejet:"," ",Se.motifRejet?Se.motifRejet.name:"")}):"",s.a.createElement(b.a,{container:!0,spacing:3,className:"mb-8"},1===Se.statut&&s.a.createElement(b.a,{item:!0,xs:12},s.a.createElement(d.a,{variant:"caption",className:"font-bold flex items-center",color:"secondary"},s.a.createElement(m.a,{className:"mr-2"},"info"),"Toutes modifications sur les champs ( D\xe9signation, Description, Produits, Pi\xe8ce(s) jointe(s) ), la demande sera remis \xe0 l'\xe9tat initial \"En attente\" pour la validation de l'administrateur."))),s.a.createElement(b.a,{container:!0,spacing:3},s.a.createElement(b.a,{item:!0,xs:12,sm:7},s.a.createElement(F.F,{className:"mb-24",label:"Designation",autoFocus:!0,id:"titre",name:"titre",value:Se.titre,onChange:je,variant:"outlined",validations:{minLength:4,maxLength:255},validationErrors:{minLength:"Min character length is 4",maxLength:"Max character length is 255"},required:!0,fullWidth:!0})),s.a.createElement(b.a,{item:!0,xs:12,sm:4},s.a.createElement(F.F,{className:"mb-24",label:"R\xe9f\xe9rence",id:"reference",name:"reference",value:Se.reference?Se.reference:"En attente",variant:"outlined",InputProps:{startAdornment:s.a.createElement(v.a,{position:"start"},"RFQ-")},disabled:!0,fullWidth:!0}))),s.a.createElement(b.a,{container:!0,spacing:3},s.a.createElement(b.a,{item:!0,xs:12,sm:6},s.a.createElement(F.b,{label:"Date d'expiration",id:"dateExpiration",name:"dateExpiration",value:Se.dateExpiration,onChange:function(e){return function(e,t){Pe(_.a.set(Object(r.a)({},Se),t,Q()(e).format("YYYY-MM-DDTHH:mm")))}(e,"dateExpiration")},variant:"outlined",required:!0,fullWidth:!0}),he&&Ne&&s.a.createElement(d.a,{variant:"caption",className:"uppercase font-bold mb-16 flex items-center",color:"secondary"},s.a.createElement(m.a,null,"info"),"\u2002",Ne)),s.a.createElement(b.a,{item:!0,xs:12,sm:6},s.a.createElement(F.F,{className:"mb-24",label:"Budget",id:"budget",type:"number",name:"budget",value:_.a.toString(Se.budget),onChange:je,variant:"outlined",validations:{isNumeric:!0},validationErrors:{isNumeric:"Numeric value required"},step:"any",required:!0,fullWidth:!0}))),s.a.createElement("div",{ref:a},s.a.createElement(ee.a,Object.assign({},Be,{getSuggestionValue:function(e){return c.searchText},onSuggestionSelected:function(e,t){var r=t.suggestion;"enter"===t.method&&e.preventDefault(),!_.a.find(M,["name",r.name])&&L([r].concat(Object(n.a)(M))),a.current.focus()},required:!0,inputProps:{classes:De,label:"Produits Services \xe0 Recherchez ",placeholder:"Produit (ex: Projecteur)",value:c.searchText,variant:"outlined",name:"categories",onChange:function(e){J(q.T(e))},onFocus:function(){J(q.V()),document.addEventListener("keydown",Ge,!1)},InputLabelProps:{shrink:!0}},theme:{container:De.container,suggestionsContainerOpen:De.suggestionsContainerOpen,suggestionsList:De.suggestionsList,suggestion:De.suggestion},renderSuggestionsContainer:function(e){return s.a.createElement(y.a,{anchorEl:a.current,open:Boolean(e.children)||c.noSuggestions||c.loading,popperOptions:{positionFixed:!0},className:"z-9999 mb-8"},s.a.createElement("div",{ref:t},s.a.createElement(ae.a,Object.assign({elevation:1,square:!0},e.containerProps,{style:{width:a.current?a.current.clientWidth:null}}),e.children,c.noSuggestions&&s.a.createElement(ne.a,{component:"div",className:"z-999",onClick:Qe,dense:!0},s.a.createElement(u.a,{className:"pl-0 ",primary:c.searchText})),c.loading&&s.a.createElement("div",{className:"px-16 py-12 text-center"},s.a.createElement(f.a,{color:"secondary"})," ",s.a.createElement("br",null)," Chargement ..."))))}}))),s.a.createElement(d.a,{variant:"caption",className:"font-bold flex items-center",color:"secondary"},"IMPORTANT : Pour que votre demande soit diffus\xe9e aux fournisseurs d\xe9sign\xe9s, veuillez s\xe9lectionner le bon produit."),s.a.createElement("div",{className:Object(k.a)(De.chips)},M&&M.length>0&&M.map(function(e,t){return s.a.createElement(N.a,{key:t,label:e.name,onDelete:function(){return t=e.id,void L(_.a.reject(M,function(e){return e.id===t}));var t},className:"mt-8 mr-8"})}),B&&B.length>0&&B.map(function(e,t){return s.a.createElement(N.a,{key:t,label:e,onDelete:function(){return function(e){W(_.a.reject(B,function(t){return t===e}))}(e)},className:"mt-8 mr-8"})})),s.a.createElement(b.a,{container:!0,spacing:3},s.a.createElement(b.a,{item:!0,xs:12,sm:12},s.a.createElement(F.F,{className:"mb-16 mt-16  w-full",type:"text",name:"description",value:Se.description,onChange:je,label:"Description",autoFocus:!0,validations:{minLength:10},validationErrors:{minLength:"La longueur minimale de caract\xe8re est 10"},required:!0,variant:"outlined",multiline:!0,rows:"4"}))),s.a.createElement(b.a,{container:!0,spacing:3,className:"flex items-center"},s.a.createElement(b.a,{item:!0,xs:12,sm:4},s.a.createElement(F.C,{className:"inline",name:"statut",label:"Diffuser \xe0 l'\xe9chelle",onChange:function(e){Pe(_.a.set(Object(r.a)({},Se),"localisation",parseInt(e.target.value)))}},s.a.createElement(A.a,{value:"2",disabled:1===Se.statut,checked:2===Se.localisation,control:s.a.createElement(O.a,null),label:"Locale"}),s.a.createElement(A.a,{value:"3",disabled:1===Se.statut,checked:3===Se.localisation,control:s.a.createElement(O.a,null),label:"Internationale"}),s.a.createElement(A.a,{value:"1",disabled:1===Se.statut,checked:1===Se.localisation,control:s.a.createElement(O.a,null),label:"Les deux"}))),s.a.createElement(b.a,{item:!0,xs:12,sm:4,className:"flex items-center"},s.a.createElement(F.a,{name:"isPublic",disabled:1===Se.statut,onChange:function(e){return qe(e,"isPublic")},value:Se.isPublic,label:"Mettre en ligne apr\xe8s validation"}),s.a.createElement(x.a,{placement:"top",title:"Si vous mettez la demande en ligne apr\xe8s validation, elle sera visibile par les founrisseurs et les visiteurs du site web.","aria-label":"anonyme"},s.a.createElement(m.a,{className:"ml-4 text-20"},"help_outline"))),s.a.createElement(b.a,{item:!0,xs:12,sm:4,className:"flex items-center"},s.a.createElement(F.a,{onChange:function(e){return qe(e,"isAnonyme")},name:"isAnonyme",disabled:1===Se.statut,value:Se.isAnonyme,label:"Mettre la demande anonyme"}),s.a.createElement(x.a,{placement:"top",title:"Si vous mettez la demande anonyme, les achats industriels prend en charge la reception des devis d'aupr\xe8s les fournisseurs et elle vous choisi la meiileure offre.","aria-label":"anonyme"},s.a.createElement(m.a,{className:"ml-4 text-20"},"help_outline")))),s.a.createElement(b.a,{container:!0,spacing:3,className:"mb-8"},s.a.createElement(b.a,{item:!0,xs:12,sm:8},s.a.createElement(d.a,{variant:"caption"},"- Soumettez votre demande c'est gratuit et sans engagement.",s.a.createElement("br",null),"- D\xe9taillez la demande, vous recevrez de meilleures offres.",s.a.createElement("br",null),"- Attention seules les demandes s\xe9rieuses (pas de projets \xe9tudiants) seront valid\xe9es.",s.a.createElement("br",null))),s.a.createElement(b.a,{item:!0,xs:12,sm:4,className:"justify-end text-right"},s.a.createElement(d.a,{variant:"caption",className:"font-extrabold"},s.a.createElement("span",{className:"text-red font-600"},"*")," Champs obligatoires."))),s.a.createElement(b.a,{container:!0,spacing:3,className:"mt-4"},s.a.createElement(b.a,{item:!0,xs:12,sm:10},s.a.createElement(l.a,{className:"whitespace-no-wrap",variant:"contained",color:"secondary",disabled:!re||$.loading||!M.length&&!B.length||3===$.data.statut,onClick:function(){return He(!0)}},s.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder avant diffuser"),s.a.createElement("span",{className:"flex sm:hidden"},s.a.createElement(m.a,null,"save")),$.loading&&s.a.createElement(f.a,{size:24,className:De.buttonProgress})),s.a.createElement(l.a,{style:{backgroundColor:"orangered",marginLeft:"20px"},className:"whitespace-no-wrap",variant:"contained",color:"secondary",disabled:!re||$.loading||!M.length&&!B.length||3===$.data.statut,onClick:function(){return Le(!0)}},s.a.createElement("span",{className:"hidden sm:flex"},"Envoyer"),s.a.createElement("span",{className:"flex sm:hidden"},s.a.createElement(m.a,null,"send")),$.loading&&s.a.createElement(f.a,{size:24,className:De.buttonProgress})),s.a.createElement(S.a,{open:Ue,onClose:function(){return He(!1)},"aria-labelledby":"save-dialog-title","aria-describedby":"save-dialog-description"},s.a.createElement(j.a,{id:"save-dialog-title"},"Sauvegarder"),s.a.createElement(P.a,null,s.a.createElement(D.a,{id:"save-dialog-description"},"Voulez-vous vraiment sauvegarder cet enregistrement avant de diffuser ?")),s.a.createElement(C.a,null,s.a.createElement(l.a,{onClick:function(){return He(!1)},color:"primary"},"Non"),s.a.createElement(l.a,{onClick:function(){We(!1),He(!1)},color:"primary",autoFocus:!0},"Oui"))),s.a.createElement(S.a,{open:ze,onClose:function(){return Le(!1)},"aria-labelledby":"send-dialog-title","aria-describedby":"send-dialog-description"},s.a.createElement(j.a,{id:"send-dialog-title"},"Envoyer"),s.a.createElement(P.a,null,s.a.createElement(D.a,{id:"send-dialog-description"},"Voulez-vous vraiment envoyer cet enregistrement ?")),s.a.createElement(C.a,null,s.a.createElement(l.a,{onClick:function(){return Le(!1)},color:"primary"},"Non"),s.a.createElement(l.a,{onClick:function(){We(!1),Le(!1)},color:"primary",autoFocus:!0},"Oui"))),"new"===Me&&s.a.createElement(l.a,{className:"ml-8",variant:"contained",color:"secondary",disabled:!re||$.loading||!M.length&&!B.length,onClick:function(){return We(!0)}},s.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder et ajouter nouvelle demande"),s.a.createElement("span",{className:"flex sm:hidden"},s.a.createElement(m.a,null,"save")," et ",s.a.createElement(m.a,null,"repeat")),$.loading&&s.a.createElement(f.a,{size:24,className:De.buttonProgress}))))),1===Te&&s.a.createElement("div",null,s.a.createElement("input",{accept:"text/plain,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.ms-powerpoint,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,application/pdf,image/jpeg,image/gif,image/png,application/pdf,",className:"hidden",id:"button-file",type:"file",disabled:$.attachementReqInProgress,onChange:function(e){var t=e.target.files[0];t&&J(q.W(t))}}),s.a.createElement("div",{className:"flex justify-center sm:justify-start flex-wrap"},s.a.createElement("label",{htmlFor:"button-file",className:Object(k.a)(De.demandeImageUpload,"flex items-center justify-center relative w-128 h-128 rounded-4 mr-16 mb-16 overflow-hidden cursor-pointer shadow-1 hover:shadow-5",5===Se.attachements.length&&"hidden")},$.attachementReqInProgress?s.a.createElement(f.a,{size:24,className:De.buttonProgress}):s.a.createElement(m.a,{fontSize:"large",color:"action"},"arrow_upward")),Se.attachements.map(function(e){return s.a.createElement("div",{className:Object(k.a)(De.demandeImageItem,"flex items-center cursor-pointer justify-center relative w-128 h-128 rounded-4 mr-16 mb-16 overflow-hidden  shadow-1 hover:shadow-5"),key:e.id,onClick:function(){return window.open(I.d+e.url,"_blank")}},s.a.createElement(x.a,{title:"Supprimer"},s.a.createElement(R.a,{className:De.demandeImageFeaturedStar,onClick:function(t){t.stopPropagation(),J(q.H(e))}},s.a.createElement(m.a,null,"delete"))),"image"===_.a.split(e.type,"/",1)[0]?s.a.createElement("img",{className:"max-w-none w-auto h-full",src:I.d+e.url,alt:"demande"}):s.a.createElement(m.a,{color:"secondary",style:{fontSize:80}},"insert_drive_file"))}),s.a.createElement(b.a,{container:!0,spacing:3},s.a.createElement(b.a,{item:!0,xs:12,sm:6},s.a.createElement(d.a,{variant:"caption"},"- Taille maximale par fichier : 2 Mo ",s.a.createElement("br",null),"- 5 fichiers \xe0 t\xe9l\xe9charger ",s.a.createElement("br",null),"- Extensions de fichier autoris\xe9es: .jpg, .jpeg, .png, .xls, .xlsx , .bmp , .doc , .docx , .pdf , .txt"))))),2===Te&&s.a.createElement("div",{className:"w-full flex flex-col"},$.data&&3===$.data.statut&&!$.data.isAnonyme?s.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},s.a.createElement(d.a,{variant:"h6",className:"flex items-center"},s.a.createElement(m.a,{className:"mr-2 text-40",color:"secondary"},"gavel")," ","Cette demande a \xe9t\xe9 adjug\xe9e par :"," ",s.a.createElement("strong",{className:"uppercase ml-2"}," ",$.data.fournisseurGagne?$.data.fournisseurGagne.societe:"Fournisseur hors site"))):s.a.createElement("div",null,s.a.createElement(d.a,{variant:"h6",className:Object(k.a)("mb-8 ml-2",De.titre)},"D\xe9tail de la demande"),s.a.createElement("div",{className:"table-responsive mb-16"},s.a.createElement("table",{className:"simple"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{className:"font-bold"},"R\xe9f\xe9rence"),s.a.createElement("th",{className:"font-bold"},"D\xe9signation"),s.a.createElement("th",{className:"font-bold"},"Description"),s.a.createElement("th",{className:"font-bold"},"Produits"))),s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("div",{className:"flex items-center"},s.a.createElement(d.a,{className:"truncate"},"RFQ-"+$.data.reference))),s.a.createElement("td",null,s.a.createElement(d.a,{className:"truncate"},$.data.titre)),s.a.createElement("td",null,s.a.createElement(d.a,{className:"truncate"},$.data.description)),s.a.createElement("td",null,s.a.createElement("span",{className:"truncate"},_.a.join(_.a.map($.data.categories,"name"),", "))))))),s.a.createElement("div",{className:"flex flex-1 items-center justify-between mb-10"},s.a.createElement(d.a,{variant:"h6",className:Object(k.a)("mb-8 ml-2",De.titre)},"Fournisseurs participants ("," ",$.fournisseurs.length," )"),s.a.createElement(oe,{color:"secondary",size:"small",variant:"outlined",disabled:$.requestSaveFrs,onClick:function(e){e.stopPropagation(),J(q.O({children:s.a.createElement(s.a.Fragment,null,s.a.createElement(j.a,{id:"alert-dialog-title"},"Attribution"),s.a.createElement(P.a,null,s.a.createElement(D.a,{id:"alert-dialog-description"},"Voulez vous vraiment attribuer cette demande \xe0 un fournisseur hors site ?")),s.a.createElement(C.a,null,s.a.createElement(l.a,{variant:"outlined",onClick:function(){return J(q.G())},color:"primary"},"Non"),s.a.createElement(l.a,{variant:"contained",color:"secondary",onClick:function(e){J(q.S(null,Se.id)),J(q.G())},autoFocus:!0},"Oui")))}))}},"attribu\xe9e \xe0 un fournisseur hors site",$.requestSaveFrs&&s.a.createElement(f.a,{size:24,className:De.buttonProgress}))),s.a.createElement(X.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",data:$.fournisseurs,columns:[{Header:"Nombre de fournisseur",accessor:"id",Cell:function(e){return s.a.createElement("div",{style:{textAlign:"center"}},e.index+1)}},{Header:"Fournisseur",className:"font-bold",id:"fournisseur",accessor:function(e){return e.fournisseur.societe+" "+e.fournisseur.firstName+" "+e.fournisseur.lastName+" "+e.fournisseur.phone}},{Header:"",Cell:function(e){return s.a.createElement("div",{className:"flex items-center"},s.a.createElement(oe,{color:"secondary",size:"small",variant:"outlined",disabled:$.requestSaveFrs,onClick:function(t){t.stopPropagation(),J(q.O({children:s.a.createElement(s.a.Fragment,null,s.a.createElement(j.a,{id:"alert-dialog-title"},"Attribution"),s.a.createElement(P.a,null,s.a.createElement(D.a,{id:"alert-dialog-description"},"Voulez vous vraiment attribuer cette demande \xe0"," ",s.a.createElement("strong",null,e.original.fournisseur.societe)," ","?")),s.a.createElement(C.a,null,s.a.createElement(l.a,{variant:"outlined",onClick:function(){return J(q.G())},color:"primary"},"Non"),s.a.createElement(l.a,{variant:"contained",color:"secondary",onClick:function(t){J(q.S(e.original.fournisseur.id,Se.id)),J(q.G())},autoFocus:!0},"Oui")))}))}},"Adjug\xe9e",$.requestSaveFrs&&s.a.createElement(f.a,{size:24,className:De.buttonProgress})))}}],defaultPageSize:$.fournisseurs.length<10?$.fournisseurs.length:10,ofText:"sur"})))),innerScroll:!0}))})}}]);