(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{1088:function(e,t,a){"use strict";var n=a(54),r=a(64),i=a.n(r),c="[CONSULTATIONS FOURNISSEUR APP] REQUEST CONSULTATIONS",o="[CONSULTATIONS FOURNISSEUR APP] SET PARAMETRES DATA",l="[USERS APP] GET CONSULTATIONS",s="[USERS APP] SET CONSULTATIONS SEARCH TEXT";function u(e,t){var a="";e.search.length>0&&e.search.map(function(e,t){e.value&&("created"===e.id||"dateExpiration"===e.id?a+="&"+e.id+"[after]="+e.value:"demande.statut"===e.id?"1"===e.value?a+="&demande.statut=1&demande.dateExpiration[strictly_after]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss")):"3"===e.value&&(a+="&demande.dateExpiration[strictly_before]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss"))):a+="&"+e.id+"="+e.value)});var r=n.a.get("/api/detail_visites?page=".concat(e.page).concat(a,"&fournisseur=").concat(t,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction));return function(e){return e({type:c}),r.then(function(t){return e({type:l,payload:t.data})})}}function d(e){return{type:o,parametres:e}}var f=a(40),m=a(36),p="[CONSULTATION FOURNISSEUR APP] REQUEST CONSULTATION",g="[CONSULTATION FOURNISSEUR APP] GET CONSULTATION",E="[CONSULTATION FOURNISSEUR APP] GET_PERSONNELS",h="[CONSULTATION FOURNISSEUR APP] REQUEST SAVE",b="[CONSULTATION FOURNISSEUR APP] SAVE CONSULTANTION",O="[CONSULTATION FOURNISSEUR APP] SAVE ERROR",N="[CONSULTATION FOURNISSEUR APP] CLEAN_UP";function v(){return function(e){return e({type:N})}}function S(e){var t=n.a.get("/api/detail_visites/".concat(e));return function(e){return e({type:p}),t.then(function(t){e({type:g,payload:t.data})})}}function T(e){var t=n.a.get("/api/fournisseurs/".concat(e,"/personnels"));return function(e){return t.then(function(t){e({type:E,payload:t.data["hydra:member"]})})}}function x(e){var t={budget:parseFloat(e.budget),personnel:e.personnel?e.personnel.value:null,sendEmail:!!e.sendEmail&&e.sendEmail},a=n.a.put(e["@id"],t);return function(e){return e({type:h}),a.then(function(t){return e(Object(m.B)({message:"Consultation Modifi\xe9e"})),e({type:b,payload:t.data})}).catch(function(t){e({type:O,payload:f.y.parseApiErrors(t)})})}}a.d(t,"f",function(){return c}),a.d(t,"k",function(){return o}),a.d(t,"c",function(){return l}),a.d(t,"j",function(){return s}),a.d(t,"n",function(){return u}),a.d(t,"q",function(){return d}),a.d(t,"e",function(){return p}),a.d(t,"b",function(){return g}),a.d(t,"d",function(){return E}),a.d(t,"g",function(){return h}),a.d(t,"h",function(){return b}),a.d(t,"i",function(){return O}),a.d(t,"a",function(){return N}),a.d(t,"l",function(){return v}),a.d(t,"m",function(){return S}),a.d(t,"o",function(){return T}),a.d(t,"p",function(){return x})},1161:function(e,t,a){"use strict";var n=a(46),r=a(8),i=a(1088),c=a(107),o={data:[],pageCount:null,loading:!1,searchText:"",parametres:{page:1,description:"",search:[],filter:{id:"created",direction:"desc"}}},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.f:return Object(r.a)({},e,{loading:!0});case i.c:return Object(r.a)({},e,{data:t.payload["hydra:member"],pageCount:c.a.hydraPageCount(t.payload),loading:!1});case i.j:return Object(r.a)({},e,{searchText:t.searchText});case i.k:return Object(r.a)({},e,{parametres:{page:t.parametres.page,search:t.parametres.search,description:t.parametres.description,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}});default:return e}},s={data:null,error:null,loading:!1,personnels:null,request:!1},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.e:return Object(r.a)({},e,{loading:!0});case i.g:return Object(r.a)({},e,{request:!0});case i.a:return Object(r.a)({},e,{data:null,loading:!1,error:null});case i.b:return Object(r.a)({},e,{data:t.payload,loading:!1});case i.d:return Object(r.a)({},e,{personnels:t.payload});case i.h:return Object(r.a)({},e,{request:!1});case i.i:return Object(r.a)({},e,{error:t.payload,loading:!1});default:return e}},d=Object(n.d)({consultations:l,consultation:u});t.a=d},1395:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(40),c=a(140),o=a(23),l=a(967),s=a(1039),u=a(974),d=a(1029),f=a(1013),m=a(958),p=a(78),g=a(1088),E=a(6),h=a(64),b=a.n(h),O=a(107),N=a(347),v=a(1034),S=a(10),T=Object(v.a)(function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chip:{marginLeft:e.spacing(1),padding:2,background:"#ef5350",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chip2:{marginLeft:e.spacing(1),padding:2,background:"#4caf50",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chipOrange:{marginLeft:e.spacing(1),padding:2,background:"#ff9800",color:"white",fontWeight:"bold",fontSize:"11px",height:20}}});var x=Object(p.g)(function(e){var t=T(),a=Object(E.b)(),c=Object(E.c)(function(e){return e.consultationsFrsApp.consultations.data}),p=Object(E.c)(function(e){return e.consultationsFrsApp.consultations.loading}),h=Object(E.c)(function(e){return e.consultationsFrsApp.consultations.pageCount}),v=Object(E.c)(function(e){return e.consultationsFrsApp.consultations.parametres}),x=Object(E.c)(function(e){return e.consultationsFrsApp.consultations.searchText}),y=Object(n.useState)(null),A=Object(o.a)(y,2),C=A[0],U=A[1],j=Object(E.c)(function(e){return e.auth.user});if(Object(n.useEffect)(function(){c&&U(function(e,t){var a=Object.keys(e).map(function(t){return e[t]});return 0===t.length?a:O.a.filterArrayByString(a,t)}(c,x))},[c,x]),!C)return null;var P=S.a.debounce(function(e){return a(g.q(e))},1e3);return r.a.createElement(i.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(N.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:function(t,a,n){return{className:"h-64 cursor-pointer",onClick:function(t,n){a&&e.history.push("/consultations/"+a.original.id)}}},getTheadProps:function(e,t,a){return{className:"h-64 font-bold"}},data:C,columns:[{Header:"R\xe9f\xe9rence",className:"font-bold",filterable:!0,accessor:"demande.reference",Cell:function(e){return e.original.demande.reference?"RFQ-"+e.original.demande.reference:"En attente"},Filter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement(l.a,{onChange:function(e){return a(e.target.value)},style:{width:"100%"},value:t?t.value:"",InputProps:{startAdornment:r.a.createElement(s.a,{position:"start"},"RFQ-")}})}},{Header:"\xc9tat",sortable:!1,accessor:"demande.statut",filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},b()(e.original.demande.dateExpiration)>=b()()?0===e.original.demande.statut?r.a.createElement("strong",{className:"text-orange"},"En attente"):1===e.original.demande.statut?r.a.createElement("strong",{className:"text-green"},"En cours"):r.a.createElement(u.a,{className:t.chip,label:"Refus\xe9e"}):r.a.createElement("strong",{className:"text-red"},"Expir\xe9e"))},Filter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement("select",{onChange:function(e){return a(e.target.value)},style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"1"},"En cours"),r.a.createElement("option",{value:"3"},"Expir\xe9e"))}},{Header:"Affect\xe9e \xe0",className:"font-bold",filterable:!0,accessor:"personnel.name",Cell:function(e){return e.original.personnel?e.original.personnel.name:""}},{Header:"Budget",className:"font-bold",accessor:"budget",sortable:!1,filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},e.original.budget,"\u2002",j.data&&j.data.currency?j.data.currency:"")}},{Header:"Societ\xe9",accessor:"demande.acheteur.societe",sortable:!1,filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},e.original.demande.acheteur.societe,r.a.createElement(d.a,{title:e.original.demande.acheteur.firstName+" "+e.original.demande.acheteur.lastName},r.a.createElement(f.a,null,"account_circle")))}},{Header:"Description",accessor:"demande.description",filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},S.a.capitalize(S.a.truncate(e.original.demande.description,{length:15,separator:" "})))}},{Header:"Date d'expiration",accessor:"demande.dateExpiration",minWidth:125,filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},b()(e.original.demande.dateExpiration).format("DD/MM/YYYY"),b()(e.original.demande.dateExpiration)>=b()()?r.a.createElement(u.a,{className:t.chip2,label:0===b()(e.original.demande.dateExpiration).diff(b()(),"days")?b()(e.original.demande.dateExpiration).diff(b()(),"hours")+" h":b()(e.original.demande.dateExpiration).diff(b()(),"days")+" j"}):r.a.createElement(u.a,{className:t.chip,label:0===b()(e.original.demande.dateExpiration).diff(b()(),"days")?b()(e.original.demande.dateExpiration).diff(b()(),"hours")+" h":b()(e.original.demande.dateExpiration).diff(b()(),"days")+" j"}))},Filter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement(l.a,{onChange:function(e){return a(e.target.value)},style:{width:"100%"},value:t?t.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"Statut",accessor:"statut",sortable:!1,filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},0===e.original.statut?r.a.createElement(u.a,{className:t.chipOrange,label:"En cours"}):1===e.original.statut?r.a.createElement(u.a,{className:t.chip2,label:"Gagn\xe9e"}):r.a.createElement(u.a,{className:t.chip,label:"Perdue"}))},Filter:function(e){var t=e.filter,a=e.onChange;return r.a.createElement("select",{onChange:function(e){return a(e.target.value)},style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"0"},"En cours"),r.a.createElement("option",{value:"1"},"Gagn\xe9e"),r.a.createElement("option",{value:"2"},"Perdue"))}},{Header:"",Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},r.a.createElement(d.a,{title:"D\xe9tails"},r.a.createElement(m.a,{className:"text-teal text-20"},r.a.createElement(f.a,null,"remove_red_eye"))))}}],manual:!0,defaultSortDesc:!0,pages:h,page:v.page-1,defaultPageSize:10,loading:p,showPageSizeOptions:!1,onPageChange:function(e){v.page=e+1,a(g.q(v))},onSortedChange:function(e,t,n){v.page=1,v.filter.id=e[0].id,v.filter.direction=e[0].desc?"desc":"asc",a(g.q(v))},onFilteredChange:function(e){v.page=1,v.search=e,P(v)},noDataText:"Aucune consultation trouv\xe9e",loadingText:"Chargement...",ofText:"sur"}))}),y=a(98);var A=function(e){return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(i.d,{animation:"transition.expandIn",delay:300},r.a.createElement(f.a,{className:"text-32 mr-0 sm:mr-12"},"move_to_inbox")),r.a.createElement(i.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(y.a,{className:"hidden sm:flex",variant:"h6"},"Vos consultations"))))},C=a(1161),U=a(346);t.default=Object(c.a)("consultationsFrsApp",C.a)(function(){var e=Object(E.b)(),t=Object(E.c)(function(e){return e.consultationsFrsApp.consultations.parametres}),a=Object(E.c)(function(e){return e.auth.user});return Object(n.useEffect)(function(){a&&e(g.n(t,a.id))},[e,t,a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(U.Helmet,null,r.a.createElement("title",null,"Mes consultations | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(i.o,{classes:{content:"flex flex-col h-full",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(A,null),content:r.a.createElement(x,null),innerScroll:!0}))})}}]);