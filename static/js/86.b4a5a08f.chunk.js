(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{1051:function(e,a,t){"use strict";var n=t(3),r=t.n(n),l=t(4),i=t.n(l),c=t(0),o=t.n(c),s=(t(1),t(2)),m=t(7),u=t(98),d=o.a.forwardRef(function(e,a){var t=e.children,n=e.classes,l=e.className,c=e.disableTypography,m=void 0!==c&&c,d=i()(e,["children","classes","className","disableTypography"]);return o.a.createElement("div",r()({className:Object(s.a)(n.root,l),ref:a},d),m?t:o.a.createElement(u.a,{variant:"h6"},t))});a.a=Object(m.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(d)},1052:function(e,a,t){"use strict";var n=t(3),r=t.n(n),l=t(0),i=t.n(l),c=(t(1),t(7)),o=t(98),s=i.a.forwardRef(function(e,a){return i.a.createElement(o.a,r()({component:"p",variant:"body1",color:"textSecondary",ref:a},e))});a.a=Object(c.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(s)},1360:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(40),i=t(6),c=t(140),o=t(23),s=t(98),m=t(945),u=t(1035),d=t(958),p=t(1013),f=t(1051),E=t(1037),v=t(1052),h=t(1038),g=t(1029),b=t(347),O=t(8),C=t(54),N=t(107),y=t(36),A=t(10),j="[VILLES APP] GET VILLES",x="[COMMERCIALS APP] GET COMMERCIALS",P="[COMMERCIALS APP] SET SEARCH TEXT",M="[COMMERCIALS APP] OPEN_NEW_COMMERCIALS_DIALOG",L="[COMMERCIALS APP] OPEN EDIT COMMERCIALS DIALOG",I="[COMMERCIALS APP] CLOSE EDIT COMMERCIALS DIALOG",S="[COMMERCIALS APP] SAVE ERROR",R="[COMMERCIALS APP] UPDATE COMMERCIAL",w="[COMMERCIALS APP] REMOVE COMMERCIAL",T="[COMMERCIALS APP] STATUT COMMERCIAL",D="[COMMERCIALS APP] UPLOAD IMAGE",k="[COMMERCIALS APP] UPLOAD REQUEST",F="[COMMERCIALS APP] UPLOAD ERROR",W="[COMMERCIALS APP] REQUEST SAVE",q="[COMMERCIALS APP] REQUEST_COMMERCIALS";function H(){var e=C.a.get("/api/commercials");return function(a){return a({type:q}),e.then(function(e){a({type:x,payload:e.data["hydra:member"]})})}}function z(){return{type:I}}function V(e){var a={del:!0,username:e.username+"_deleted-"+e.id,email:e.email+"_deleted-"+e.id};return function(t,n){return C.a.put(e["@id"],a).then(function(e){return Promise.all([t({type:w}),t(Object(y.B)({message:"Commercial bien supprim\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return t(H())})})}}function G(e,a){var t={isactif:a};return function(a,n){return C.a.put(e["@id"],t).then(function(e){return Promise.all([a({type:T}),a(Object(y.B)({message:"Statut modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return a(H())})})}}var U="[DIALOG] OPEN",_="[DIALOG] CLOSE";function B(){return{type:_}}function Y(e){return{type:U,options:e}}var Q=t(64),J=t.n(Q),X=t(7);var Z=function(e){var a=Object(i.b)(),t=Object(i.c)(function(e){return e.commercialsApp.commercials.entities}),c=Object(i.c)(function(e){return e.commercialsApp.commercials.loadingComl}),O=Object(i.c)(function(e){return e.commercialsApp.commercials.searchText}),C=Object(n.useState)(null),N=Object(o.a)(C,2),y=N[0],j=N[1],x=Object(X.a)(function(e){return{tooltip:{maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9","& b":{fontWeight:e.typography.fontWeightMedium}}}})(g.a);return Object(n.useEffect)(function(){t&&j(function(e,a){var t=Object.keys(e).map(function(a){return e[a]});return 0===a.length?t:l.y.filterArrayByString(t,a)}(t,O))},[t,O]),y?0===y.length?r.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},r.a.createElement(s.a,{color:"textSecondary",variant:"h5"},"Il n'y a pas de commerciaux!")):r.a.createElement(l.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(b.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:function(e,t,n){return{className:"cursor-pointer",onClick:function(e,n){var r;t&&a((r=t.original,{type:L,data:r}))}}},data:y,columns:[{Header:"",Cell:function(e){return e.original.avatar?r.a.createElement(m.a,{className:"mr-8",alt:e.original.firstName,src:l.G+e.original.avatar.url}):r.a.createElement(m.a,{className:"mr-8",alt:e.original.firstName,src:"assets/images/avatars/images.png"})},className:"justify-center",width:64,sortable:!1},{Header:"Nom",accessor:"lastName",filterable:!0},{Header:"Pr\xe9nom",accessor:"firstName",filterable:!0},{Header:"Email",accessor:"email",filterable:!0},{Header:"T\xe9l\xe9phone",accessor:"phone",filterable:!0},{Header:"Date de cr\xe9ation",Cell:function(e){return J()(e.original.created).format("DD/MM/YYYY HH:mm")}},{Header:"Admin",width:140,Cell:function(e){return e.original.parent1?e.original.parent1.firstName+" "+e.original.parent1.lastName:""}},{Header:"Villes",width:64,className:"font-bold",Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},r.a.createElement(x,{title:r.a.createElement(r.a.Fragment,null,0===Object.keys(e.original.villes).length?"Il n'y aucun villes":r.a.createElement("ul",null,A.a.map(e.original.villes,function(e,a){return r.a.createElement("li",{key:a}," ",e.name," ")})))},r.a.createElement(u.a,{onClick:function(e){e.stopPropagation()}},Object.keys(e.original.villes).length)))}},{Header:"Statut",width:64,Cell:function(e){return e.original.isactif?r.a.createElement(g.a,{title:"Activ\xe9"},r.a.createElement(d.a,{className:"text-green text-20",onClick:function(t){t.stopPropagation(),a(G(e.original,!1))}},r.a.createElement(p.a,null,"check_circle"))):r.a.createElement(g.a,{title:"D\xe9sactiv\xe9"},r.a.createElement(d.a,{className:"text-red text-20",onClick:function(t){t.stopPropagation(),a(G(e.original,!0))}},r.a.createElement(p.a,null,"remove_circle")))}},{Header:"",width:64,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},r.a.createElement(d.a,{className:"text-red text-20",onClick:function(t){t.stopPropagation(),a(Y({children:r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{id:"alert-dialog-title"},"Suppression"),r.a.createElement(E.a,null,r.a.createElement(v.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),r.a.createElement(h.a,null,r.a.createElement(u.a,{onClick:function(){return a(B())},color:"primary"},"Non"),r.a.createElement(u.a,{onClick:function(t){a(V(e.original)),a(B())},color:"primary",autoFocus:!0},"Oui")))}))}},r.a.createElement(p.a,null,"delete")))}}],loading:c,defaultPageSize:10,noDataText:"Aucun commercial trouv\xe9",loadingText:"Chargement...",ofText:"sur"})):null},K=t(139),$=t(957),ee=t(1014);var ae=function(e){var a=Object(i.b)(),t=Object(i.c)(function(e){return e.commercialsApp.commercials.searchText}),n=Object(i.c)(function(e){return e.fuse.settings.mainTheme});return r.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(l.d,{animation:"transition.expandIn",delay:300},r.a.createElement(p.a,{className:"text-32 mr-0 sm:mr-12"},"group")),r.a.createElement(l.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(s.a,{className:"hidden sm:flex",variant:"h6"},"Gestion des commerciaux"))),r.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"},r.a.createElement(ee.a,{theme:n},r.a.createElement(l.d,{animation:"transition.slideDownIn",delay:300},r.a.createElement(K.a,{className:"flex items-center w-full max-w-512 px-8 py-4 rounded-8",elevation:1},r.a.createElement(p.a,{className:"mr-8",color:"action"},"search"),r.a.createElement($.a,{placeholder:"Rechercher...",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:t,inputProps:{"aria-label":"Search"},onChange:function(e){return a({type:P,searchText:e.target.value})}}))))),r.a.createElement(l.d,{animation:"transition.slideRightIn",delay:300},r.a.createElement(u.a,{onClick:function(e){return a({type:M})},className:"whitespace-no-wrap",variant:"contained"},r.a.createElement("span",{className:"hidden sm:flex"},"Ajouter nouveau Comm."),r.a.createElement("span",{className:"flex sm:hidden"},"New"))))},te=t(1031),ne=t(1026),re=t(1036),le=t(1041),ie=t(974),ce=t(1039),oe=t(141),se=t(197),me=t(55),ue=t.n(me),de=t(350),pe={firstName:"",lastName:"",adresse1:"",adresse2:"",codepostal:null,phone:"",email:"",villes:null};var fe=function(e){var a=Object(i.b)(),t=Object(i.c)(function(e){return e.commercialsApp.commercials.commercialsDialog}),c=Object(i.c)(function(e){return e.commercialsApp.commercials}),g=Object(i.c)(function(e){return e.commercialsApp.commercials.villes}),b=Object(i.c)(function(e){return e.commercialsApp.commercials.imageReqInProgress}),j=Object(i.c)(function(e){return e.commercialsApp.commercials.avatar}),x=Object(oe.b)(pe),P=x.form,M=x.handleChange,L=x.setForm,I=Object(n.useState)(!1),w=Object(o.a)(I,2),T=w[0],q=w[1],G=Object(n.useRef)(null),U=Object(n.useCallback)(function(){if("edit"===t.type&&t.data){var e=t.data.villes.map(function(e){return{value:e["@id"],label:e.name}});L(Object(O.a)({},t.data)),L(A.a.set(Object(O.a)({},t.data),"villes",e))}},[t.data,t.type,L]);function _(){a(z())}function Q(){a(V(P)),a(B()),_()}function J(){q(!1)}return Object(n.useEffect)(function(){c.error&&(c.error.firstName||c.error.lastName||c.error.adresse1||c.error.adresse2||c.error.codepostal||c.error.phone||c.error.email||c.error.villes)&&(G.current.updateInputsWithError(Object(O.a)({},c.error)),J(),c.error=null)},[c.error]),Object(n.useEffect)(function(){t.props.open&&U()},[t.props.open,U]),Object(n.useEffect)(function(){L(j?A.a.set(Object(O.a)({},P),"avatar",j):A.a.set(Object(O.a)({},P),"avatar",null))},[j]),r.a.createElement(te.a,Object.assign({classes:{paper:"m-24"}},t.props,{onClose:_,fullWidth:!0,maxWidth:"xs"}),r.a.createElement(ne.a,{position:"static",elevation:1},r.a.createElement(re.a,{className:"flex w-full"},r.a.createElement(s.a,{variant:"subtitle1",color:"inherit"},"new"===t.type?"Nouvelle Commercial":"Editer Commercial")),r.a.createElement("div",{className:"flex flex-col items-center justify-center pb-24"},b?r.a.createElement(m.a,{className:""},r.a.createElement(le.a,{size:24})):r.a.createElement(m.a,{className:"w-96 h-96",alt:"contact avatar",src:P.avatar?se.d+P.avatar.url:"assets/images/avatars/images.png"}),"edit"===t.type&&r.a.createElement(s.a,{variant:"h6",color:"inherit",className:"pt-8"},P.firstName,"\u2002",P.lastName),P.parent1&&r.a.createElement(ie.a,{avatar:r.a.createElement(m.a,{alt:"Natacha",src:P.parent1.avatar?se.d+P.parent1.avatar.url:"assets/images/avatars/images.png"}),label:"Admin: "+P.parent1.firstName+" "+P.parent1.lastName,variant:"outlined",color:"secondary"}))),r.a.createElement(ue.a,{onValidSubmit:function(e){P.codepostal=A.a.parseInt(P.codepostal),"edit"===t.type&&a(function(e){var a=null,t=null;e.villes&&(a=e.villes.map(function(e){return e.value})),e.avatar&&e.avatar.url&&(t=e.avatar["@id"]);var n=Object(O.a)({},e,{villes:a,avatar:t});return function(a){return a({type:W}),C.a.put(e["@id"],n).then(function(e){return Promise.all([a({type:R}),a(Object(y.B)({message:"Commercial bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"})),a(z())]).then(function(){return a(H())})}).catch(function(e){a({type:S,payload:N.a.parseApiErrors(e)})})}}(P))},onValid:function(){q(!0)},onInvalid:J,ref:G,className:"flex flex-col overflow-hidden"},r.a.createElement(E.a,{classes:{root:"p-24"}},r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",label:"Nom",autoFocus:!0,id:"lastName",name:"lastName",value:P.lastName,onChange:M,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},required:!0,fullWidth:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",label:"Pr\xe9nom",id:"firstName",name:"firstName",value:P.firstName,onChange:M,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},required:!0,fullWidth:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",label:"Adresse 1",id:"adresse1",name:"adresse1",value:P.adresse1,onChange:M,variant:"outlined",validations:{minLength:6},validationErrors:{minLength:"La longueur minimale des caract\xe8res est de 6"},required:!0,fullWidth:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",label:"Adresse 2",id:"adresse2",name:"adresse2",value:P.adresse2,onChange:M,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"La longueur minimale des caract\xe8res est de 6"},fullWidth:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",label:"Code postal",id:"codepostal",type:"number",name:"codepostal",value:A.a.toString(P.codepostal),onChange:M,variant:"outlined",validations:{minLength:4,isNumeric:!0},validationErrors:{minLength:"Min character length is 4",isNumeric:"Numeric value required"},required:!0,fullWidth:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",label:"T\xe9l\xe9phone",id:"phone",name:"phone",value:P.phone,onChange:M,variant:"outlined",validations:{minLength:10,isNumeric:!0},validationErrors:{minLength:"Min character length is 10",isNumeric:"Numeric value required"},required:!0,fullWidth:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",label:"E-mail",id:"email",name:"email",value:P.email,onChange:M,variant:"outlined",validations:"isEmail",validationErrors:{isEmail:"This is not a valid email"},required:!0,fullWidth:!0})),"new"===t.type?r.a.createElement("div",null,r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",type:"password",name:"password",label:"Mot de passe",onChange:M,validations:{minLength:6},validationErrors:{minLength:"La longueur minimale des caract\xe8res est de 6"},InputProps:{endAdornment:r.a.createElement(ce.a,{position:"end"},r.a.createElement(p.a,{className:"text-20",color:"action"},"vpn_key"))},variant:"outlined",required:!0,fullWidth:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement(l.F,{className:"mb-24",id:"confirmpassword",type:"password",name:"confirmpassword",label:"Confirmer mot de passe",validations:"equalsField:password",onChange:M,validationErrors:{equalsField:"Passwords not identique"},InputProps:{endAdornment:r.a.createElement(ce.a,{position:"end"},r.a.createElement(p.a,{className:"text-20",color:"action"},"vpn_key"))},variant:"outlined",fullWidth:!0}))):"",r.a.createElement("div",{className:"flex"},r.a.createElement(de.a,{id:"villes",name:"villes",className:"MuiFormControl-fullWidth MuiTextField-root mb-24",value:P.villes,onChange:function(e){return function(e,a){L(A.a.set(Object(O.a)({},P),a,e))}(e,"villes")},placeholder:"S\xe9lectionner multiple villes",textFieldProps:{label:"Villes",InputLabelProps:{shrink:!0},variant:"outlined"},options:g,fullWidth:!0,isMulti:!0,required:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement("input",{accept:"image/*",id:"button-file",type:"file",onChange:function(e){var t=e.target.files[0];t&&a(function(e){return function(a,t){var n=new FormData;n.append("file",e);var r=C.a.post("/api/avatars",n,{headers:{"Content-Type":"multipart/form-data"}});return a({type:k}),r.then(function(e){return Promise.all([e,a({type:D,payload:e.data}),a(Object(y.B)({message:"Image uploaded!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))])}).catch(function(e){a({type:F}),a(Object(y.B)({message:A.a.map(N.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(t))}}))),"new"===t.type?r.a.createElement(h.a,{className:"justify-between pl-16"},r.a.createElement(u.a,{variant:"contained",color:"primary",type:"submit",disabled:!T||c.loading||b},"Ajouter",c.loading&&r.a.createElement(le.a,{size:24}))):r.a.createElement(h.a,{className:"justify-between pl-16"},r.a.createElement(u.a,{variant:"contained",color:"primary",type:"submit",disabled:!T||c.loading||b},"Modifier",c.loading&&r.a.createElement(le.a,{size:24})),r.a.createElement(d.a,{onClick:function(){return a(Y({children:r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{id:"alert-dialog-title"},"Suppression"),r.a.createElement(E.a,null,r.a.createElement(v.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),r.a.createElement(h.a,null,r.a.createElement(u.a,{onClick:function(){return a(B())},color:"primary"},"Non"),r.a.createElement(u.a,{onClick:Q,color:"primary",autoFocus:!0},"Oui")))}))}},r.a.createElement(p.a,null,"delete")))))},Ee=t(46),ve={entities:null,loadingComl:!1,loading:!1,error:null,searchText:"",selectedZonesIds:[],routeParams:{},commercialsDialog:{type:"new",props:{open:!1},data:null},avatar:null,villes:null,imageReqInProgress:!1},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case q:return Object(O.a)({},e,{loadingComl:!0});case W:return Object(O.a)({},e,{loading:!0});case R:return Object(O.a)({},e,{loading:!1,error:null});case j:return Object(O.a)({},e,{executed:!1,message:null,villes:A.a.keyBy(a.payload,"id")});case x:return Object(O.a)({},e,{loadingComl:!1,entities:a.payload});case P:return Object(O.a)({},e,{searchText:a.searchText});case L:return Object(O.a)({},e,{commercialsDialog:{type:"edit",props:{open:!0},data:a.data}});case I:return Object(O.a)({},e,{commercialsDialog:{type:"edit",props:{open:!1},data:null}});case k:return Object(O.a)({},e,{imageReqInProgress:!0});case D:return Object(O.a)({},e,{avatar:a.payload,imageReqInProgress:!1});case F:return Object(O.a)({},e,{imageReqInProgress:!1});case S:return Object(O.a)({},e,{error:a.payload,loading:!1});default:return e}},ge={state:!1,options:{children:"Hi"}},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case y.f:return Object(O.a)({},e,{state:!0,options:Object(O.a)({},e.options,a.options)});case y.a:return Object(O.a)({},e,{state:!1});default:return e}},Oe=Object(Ee.d)({commercials:he,dialog:be});a.default=Object(c.a)("commercialsApp",Oe)(function(e){var a=Object(i.b)(),t=Object(n.useRef)(null);return Object(n.useEffect)(function(){a(H()),a(function(){var e=C.a.get("/api/villes");return function(a){return e.then(function(e){a({type:j,payload:e.data["hydra:member"]})})}}())},[a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(l.p,{classes:{contentWrapper:"p-0 sm:p-24 pb-80 sm:pb-80 h-full",content:"flex flex-col h-full",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(ae,{pageLayout:t}),content:r.a.createElement(Z,null),sidebarInner:!0,ref:t,innerScroll:!0}),r.a.createElement(fe,null))})}}]);