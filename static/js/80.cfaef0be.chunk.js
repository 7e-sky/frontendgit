(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{1244:function(e,a,t){"use strict";var n=t(3),l=t.n(n),r=t(4),i=t.n(r),s=t(0),c=t.n(s),o=t(2),p=t(8),u=t(89),m=c.a.forwardRef(function(e,a){var t=e.children,n=e.classes,r=e.className,s=e.disableTypography,p=void 0!==s&&s,m=i()(e,["children","classes","className","disableTypography"]);return c.a.createElement("div",l()({className:Object(o.a)(n.root,r),ref:a},m),p?t:c.a.createElement(u.a,{variant:"h6"},t))});a.a=Object(p.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(m)},1245:function(e,a,t){"use strict";var n=t(3),l=t.n(n),r=t(0),i=t.n(r),s=t(8),c=t(89),o=i.a.forwardRef(function(e,a){return i.a.createElement(c.a,l()({component:"p",variant:"body1",color:"textSecondary",ref:a},e))});a.a=Object(s.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(o)},1537:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(39),i=t(7),s=t(136),c=t(1140),o=t(1244),p=t(1229),u=t(1245),m=t(1230),d=t(1227),E=t(1204),f=t(365),h=t(50),y=t(102),g=t(33),v=t(10);const b="[PAYS APP] GET PAYS",O="[VILLES APP] GET VILLES",L="[VILLES APP] REQUEST VILLES",A="[VILLES APP] SET SEARCH TEXT",j="[VILLES APP] OPEN NEW VILLES DIALOG",P="[VILLES APP] CLOSE NEW VILLES DIALOG",S="[VILLES APP] OPEN EDIT VILLES DIALOG",x="[VILLES APP] CLOSE EDIT VILLES DIALOG",I="[VILLES APP] ADD VILLE",N="[VILLES APP] SAVE ERROR",V="[VILLES APP] UPDATE VILLE",w="[VILLES APP] REMOVE VILLE",C="[SOUS_SECTEURS APP] SET PARAMETRES DATA";function T(e){var a="";e.search.length>0&&e.search.map(function(e,t){a+="&"+e.id+"="+e.value});const t=h.a.get("/api/villes?page=".concat(e.page).concat(a,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction,"&props[]=id&props[]=name&props[]=pays"));return e=>(e({type:L}),t.then(a=>{e({type:O,payload:a.data})}))}function D(e,a){let t={del:!0,name:e.name+"_deleted-"+e.id};return n=>{return n({type:L}),h.a.put(e["@id"],t).then(e=>Promise.all([n({type:w}),n(Object(g.B)({message:"Ville bien supprim\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>n(T(a)))).catch(e=>{n({type:N}),n(Object(g.B)({message:v.a.map(y.a.parseApiErrors(e),function(e,a){return e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}function k(e){return{type:C,parametres:e}}const B="[DIALOG] OPEN",R="[DIALOG] CLOSE";function F(){return{type:R}}function z(e){return{type:B,options:e}}var G=function(e){const a=Object(i.b)(),t=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.entities}),s=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.pageCount}),y=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.loading}),g=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.parametres}),O=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.searchText}),[L,A]=Object(n.useState)(null);if(Object(n.useEffect)(()=>{a(function(){const e=h.a.get("/api/pays?pagination=false&props[]=id&props[]=name");return a=>e.then(e=>{a({type:b,payload:e.data["hydra:member"]})})}())},[a]),Object(n.useEffect)(()=>{t&&A(function(e,a){const t=Object.keys(e).map(a=>e[a]);return 0===a.length?t:r.y.filterArrayByString(t,a)}(t,O))},[t,O]),!L)return null;const j=v.a.debounce(e=>a(k(e)),700);return l.a.createElement(r.d,{animation:"transition.slideUpIn",delay:300},l.a.createElement(f.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:(e,t,n)=>({className:"cursor-pointer",onClick:(e,n)=>{t&&a(function(e){return{type:S,data:e}}(t.original))}}),data:L,columns:[{Header:"Villes",accessor:"name",filterable:!0},{Header:"Pays",accessor:"pays.name",filterable:!0,Cell:e=>l.a.createElement("div",{className:"flex items-center"},e.original.pays?e.original.pays.name:"")},{Header:"",width:64,Cell:e=>l.a.createElement("div",{className:"flex items-center"},l.a.createElement(c.a,{className:"text-red text-20",onClick:t=>{t.stopPropagation(),a(z({children:l.a.createElement(l.a.Fragment,null,l.a.createElement(o.a,{id:"alert-dialog-title"},"Suppression"),l.a.createElement(p.a,null,l.a.createElement(u.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),l.a.createElement(m.a,null,l.a.createElement(d.a,{onClick:()=>a(F()),color:"primary"},"Non"),l.a.createElement(d.a,{onClick:t=>{a(D(e.original)),a(F())},color:"primary",autoFocus:!0},"Oui")))}))}},l.a.createElement(E.a,null,"delete")))}],manual:!0,pages:s,page:g.page-1,defaultPageSize:10,loading:y,showPageSizeOptions:!1,onPageChange:e=>{g.page=e+1,a(k(g))},onSortedChange:(e,t,n)=>{g.page=1,g.filter.id=e[0].id,g.filter.direction=e[0].desc?"desc":"asc",a(k(g))},onFilteredChange:e=>{g.page=1,g.search=e,j(g)},noDataText:"No ville found",loadingText:"Chargement...",ofText:"sur"}))},H=t(89);var M=function(e){const a=Object(i.b)();return l.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},l.a.createElement("div",{className:"flex items-center"},l.a.createElement(r.d,{animation:"transition.expandIn",delay:300},l.a.createElement(E.a,{className:"text-32 mr-0 sm:mr-12"},"location_city")),l.a.createElement(r.d,{animation:"transition.slideLeftIn",delay:300},l.a.createElement(H.a,{className:"hidden sm:flex",variant:"h6"},"Gestion des Villes"))),l.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"}),l.a.createElement(r.d,{animation:"transition.slideRightIn",delay:300},l.a.createElement(d.a,{onClick:e=>a({type:j}),className:"whitespace-no-wrap",variant:"contained"},l.a.createElement("span",{className:"hidden sm:flex"},"Ajouter nouvelle Ville"),l.a.createElement("span",{className:"flex sm:hidden"},"New"))))},W=t(1223),U=t(1218),_=t(1228),q=t(137),J=t(51),Y=t.n(J),Q=t(368);const X={name:"",pays:""};var K=function(e){const a=Object(i.b)(),t=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.villesDialog}),s=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.pays}),f=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.parametres}),{form:b,handleChange:O,setForm:A}=Object(q.b)(X),[j,S]=Object(n.useState)(!1),w=Object(n.useRef)(null),C=Object(n.useCallback)(()=>{if("edit"===t.type&&t.data){let e={value:t.data.pays["@id"],label:t.data.pays.name};A({...t.data}),A(v.a.set({...t.data},"pays",e))}"new"===t.type&&A({...X,...t.data})},[t.data,t.type,A]);function k(){"edit"===t.type?a({type:x}):a({type:P})}function B(){a(D(b)),a(F()),k()}return Object(n.useEffect)(()=>{t.props.open&&C()},[t.props.open,C]),l.a.createElement(W.a,Object.assign({classes:{paper:"m-24"}},t.props,{onClose:k,fullWidth:!0,maxWidth:"xs"}),l.a.createElement(U.a,{position:"static",elevation:1},l.a.createElement(_.a,{className:"flex w-full"},l.a.createElement(H.a,{variant:"subtitle1",color:"inherit"},"new"===t.type?"Nouvelle Ville":"Editer Ville"))),l.a.createElement(Y.a,{onValidSubmit:function(e){"new"===t.type?a(function(e,a){return e.pays=e.pays.value,t=>(t({type:L}),h.a.post("/api/villes",e).then(e=>Promise.all([t({type:I}),t(Object(g.B)({message:"Ville bien ajout\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>t(T(a)))).catch(e=>{t({type:N}),t(Object(g.B)({message:v.a.map(y.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))}))}(b,f)):a(function(e,a){return e.pays=e.pays.value,t=>(t({type:L}),h.a.put(e["@id"],e).then(e=>Promise.all([t({type:V}),t(Object(g.B)({message:"Ville bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>t(T(a)))).catch(e=>{t({type:N}),t(Object(g.B)({message:v.a.map(y.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))}))}(b,f)),k()},onValid:function(){S(!0)},onInvalid:function(){S(!1)},ref:w,className:"flex flex-col overflow-hidden"},l.a.createElement(p.a,{classes:{root:"p-24"}},l.a.createElement("div",{className:"flex"},l.a.createElement("div",{className:"min-w-48 pt-20"},l.a.createElement(E.a,{color:"action"},"location_city")),l.a.createElement(r.F,{className:"mb-24",label:"Nom",autoFocus:!0,id:"name",name:"name",value:b.name,onChange:O,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},required:!0,fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement("div",{className:"min-w-48 pt-20"},l.a.createElement(E.a,{color:"action"},"public")),l.a.createElement(Q.a,{id:"pays",name:"pays",className:"MuiFormControl-fullWidth MuiTextField-root mb-24",value:b.pays,onChange:e=>(function(e,a){A(v.a.set({...b},a,e))})(e,"pays"),placeholder:"S\xe9lectionner un pays",textFieldProps:{label:"Pays",InputLabelProps:{shrink:!0},variant:"outlined"},options:s,fullWidth:!0,required:!0}))),"new"===t.type?l.a.createElement(m.a,{className:"justify-between pl-16"},l.a.createElement(d.a,{variant:"contained",color:"primary",type:"submit",disabled:!j},"Ajouter")):l.a.createElement(m.a,{className:"justify-between pl-16"},l.a.createElement(d.a,{variant:"contained",color:"primary",type:"submit",disabled:!j},"Modifier"),l.a.createElement(c.a,{onClick:()=>a(z({children:l.a.createElement(l.a.Fragment,null,l.a.createElement(o.a,{id:"alert-dialog-title"},"Suppression"),l.a.createElement(p.a,null,l.a.createElement(u.a,{id:"alert-dialog-description"},0===Object.keys(v.a.pullAllBy(b.fournisseurs,[{del:!0}],"del")).length&&0===Object.keys(v.a.pullAllBy(b.acheteurs,[{del:!0}],"del")).length&&0===Object.keys(v.a.pullAllBy(b.commercials,[{del:!0}],"del")).length?"Voulez vous vraiment supprimer cet enregistrement ?":"Vous ne pouvez pas supprimer cet enregistrement, car il est en relation avec d'autre(s) objet(s) !")),l.a.createElement(m.a,null,l.a.createElement(d.a,{onClick:()=>a(F()),color:"primary"},"Non"),0===Object.keys(v.a.pullAllBy(b.fournisseurs,[{del:!0}],"del")).length&&0===Object.keys(v.a.pullAllBy(b.acheteurs,[{del:!0}],"del")).length&&0===Object.keys(v.a.pullAllBy(b.commercials,[{del:!0}],"del")).length?l.a.createElement(d.a,{onClick:B,color:"primary",autoFocus:!0},"Oui"):l.a.createElement(d.a,{disabled:!0,color:"primary",autoFocus:!0},"Oui")))}))},l.a.createElement(E.a,null,"delete")))))},Z=t(43);const $={entities:null,parametres:{page:1,search:[],filter:{id:"id",direction:"asc"}},pageCount:null,loading:!1,searchText:"",selectedVillesIds:[],routeParams:{},villesDialog:{type:"new",props:{open:!1},data:null},pays:null};var ee=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case L:return{...e,loading:!0};case b:return{...e,pays:v.a.keyBy(a.payload,"id")};case O:return{...e,entities:v.a.keyBy(a.payload["hydra:member"],"id"),pageCount:y.a.hydraPageCount(a.payload),loading:!1};case N:return{...e,loading:!1};case A:return{...e,searchText:a.searchText};case j:return{...e,villesDialog:{type:"new",props:{open:!0},data:null}};case P:return{...e,villesDialog:{type:"new",props:{open:!1},data:null}};case S:return{...e,villesDialog:{type:"edit",props:{open:!0},data:a.data}};case x:return{...e,villesDialog:{type:"edit",props:{open:!1},data:null}};case C:return{...e,parametres:{page:a.parametres.page,search:a.parametres.search,filter:{id:a.parametres.filter.id,direction:a.parametres.filter.direction}}};default:return e}};const ae={state:!1,options:{children:"Hi"}};var te=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case g.f:return{...e,state:!0,options:{...e.options,...a.options}};case g.a:return{...e,state:!1};default:return e}};var ne=Object(Z.d)({villes:ee,dialog:te}),le=t(364);a.default=Object(s.a)("villesApp",ne)(function(e){const a=Object(i.b)(),t=Object(i.c)(e=>{let{villesApp:a}=e;return a.villes.parametres}),s=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a(T(t))},[a,t]),l.a.createElement(l.a.Fragment,null,l.a.createElement(le.Helmet,null,l.a.createElement("title",null,"Villes | Les Achats Industriels"),l.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),l.a.createElement("meta",{name:"googlebot",content:"noindex"})),l.a.createElement(r.p,{classes:{contentWrapper:"p-0 sm:p-24 pb-80 sm:pb-80 h-full",content:"flex flex-col h-full",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:l.a.createElement(M,{pageLayout:s}),content:l.a.createElement(G,null),sidebarInner:!0,ref:s,innerScroll:!0}),l.a.createElement(K,null))})}}]);