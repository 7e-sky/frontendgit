(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1242:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};a.default=n},1244:function(e,a,t){"use strict";var n=t(3),r=t.n(n),s=t(4),i=t.n(s),l=t(0),o=t.n(l),c=t(2),d=t(8),u=t(89),m=o.a.forwardRef(function(e,a){var t=e.children,n=e.classes,s=e.className,l=e.disableTypography,d=void 0!==l&&l,m=i()(e,["children","classes","className","disableTypography"]);return o.a.createElement("div",r()({className:Object(c.a)(n.root,s),ref:a},m),d?t:o.a.createElement(u.a,{variant:"h6"},t))});a.a=Object(d.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(m)},1245:function(e,a,t){"use strict";var n=t(3),r=t.n(n),s=t(0),i=t.n(s),l=t(8),o=t(89),c=i.a.forwardRef(function(e,a){return i.a.createElement(o.a,r()({component:"p",variant:"body1",color:"textSecondary",ref:a},e))});a.a=Object(l.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(c)},1263:function(e,a,t){"use strict";var n=t(33),r=t(50),s=t(59),i=t.n(s);const l="[DEMANDES APP] REQUEST DEMANDES",o="[DEMANDES APP] REMOVE DEMANDES",c="[DEMANDES APP] STATUT DEMANDES",d="[DEMANDES APP] SET PARAMETRES DATA",u="[DEMANDES APP] CLEAN_UP",m="[USERS APP] GET DEMANDES",E="[USERS APP] SET DEMANDES SEARCH TEXT";function p(){return e=>e({type:u})}function f(e,a){var t="";a.search.length>0&&a.search.map(function(e,a){e.value&&("created"===e.id||"dateExpiration"===e.id?t+="&"+e.id+"[after]="+e.value:"statut"===e.id?"0"===e.value?t+="&statut=0&dateExpiration[strictly_after]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss")):"1"===e.value?t+="&statut=1&dateExpiration[strictly_after]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss")):"2"===e.value?t+="&statut=2&dateExpiration[strictly_after]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss")):"3"===e.value?t+="&statut=3":"4"===e.value&&(t+="&dateExpiration[strictly_before]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss"))):t+="&"+e.id+"="+e.value)});const n=r.a.get("/api/acheteurs/".concat(e,"/demandes?page=").concat(a.page).concat(t,"&order[").concat(a.filter.id,"]=").concat(a.filter.direction));return e=>(e({type:l}),n.then(a=>e({type:m,payload:a.data})))}function g(e,a,t){let s={del:!0,reference:e.reference+"_deleted-"+e.id};return(i,l)=>{return r.a.put("/api/demande_achats/".concat(e.id),s).then(e=>Promise.all([i({type:o}),i(Object(n.B)({message:"Demande bien supprim\xe9e!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>i(f(t,a))))}}function h(e,a,t,s){let i={isPublic:a};return l=>{return r.a.put("/api/demande_achats/".concat(e.id),i).then(e=>Promise.all([l({type:c}),l(Object(n.B)({message:a?"Votre demande est publi\xe9e aux publics":"Votre demande est priv\xe9e",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>l(f(s,t))))}}function v(e){return{type:d,parametres:e}}var b=t(39),y=t(10);const N="[ DEMANDE ACHETEUR APP] REQUEST DEMANDE",A="[ DEMANDE ACHETEUR APP] GET DEMANDE",x="[ DEMANDE ACHETEUR APP] REQUEST DEMANDE FOURNISSEURS",S="[ DEMANDE ACHETEUR APP] GET DEMANDEFOURNISSEURS",P="[ DEMANDE ACHETEUR APP] REQUEST SAVE",D="[ DEMANDE ACHETEUR APP] NEW DEMANDE",C="[ DEMANDE ACHETEUR APP] SAVE ERROR",R="[ DEMANDE ACHETEUR APP] REQUEST SOUS_SECTEUR",T="[ DEMANDE ACHETEUR APP] GET SOUS SECTEUR",O="[ DEMANDE ACHETEUR APP] UPLOAD ATTACHEMENT",j="[ DEMANDE ACHETEUR APP] UPLOAD REQUEST",w="[ DEMANDE ACHETEUR APP] UPLOAD ERROR",M="[ DEMANDE ACHETEUR APP] REQUEST DELETE",F="[ DEMANDE ACHETEUR APP] DELETE SUCCESS",I="[ DEMANDE ACHETEUR APP] ERROR DELETE",U="[ DEMANDE ACHETEUR APP] CLEAN_UP",H="[ DEMANDE ACHETEUR APP] REQUEST_SAVE_FOURNISSEUR",k="[ DEMANDE ACHETEUR APP] SAVE_FOURNISSEUR";function _(){return e=>e({type:U})}function z(e){const a=r.a.get("/api/demande_achats/".concat(e));return e=>(e({type:N}),a.then(a=>{e({type:A,payload:a.data})}).catch(a=>{e({type:C,payload:b.y.parseApiErrors(a)})}))}function L(e){const a=r.a.get("/api/demande_achats/".concat(e,"/visites"));return e=>(e({type:x}),a.then(a=>{e({type:S,payload:a.data})}))}function q(e,a){var t={id_fournisseur:e};const n=r.a.post("/api/demande_achats/".concat(a,"/fournisseur_gagne"),t);return e=>(e({type:H}),n.then(a=>{e({type:k}),e(z(a.data.id))}).catch(e=>{}))}function Y(e,a,t,s,i){var l={...e,categories:y.a.map(t,function(e,a){return e["@id"]}),attachements:y.a.map(e.attachements,function(e,a){return e["@id"]}),autreCategories:s.length>0?y.a.join(y.a.map(s),", "):null,budget:e.budget&&parseFloat(e.budget)};const o=r.a.post("/api/demande_achats",l);return e=>(e({type:P}),o.then(t=>{e(Object(n.B)({message:"Demande enregistr\xe9e"})),i?(e(Q()),e({type:D})):a.push("/demandes")}).catch(a=>{e({type:C,payload:b.y.parseApiErrors(a)})}))}function G(e,a,t,s,i,l,o,c){var d={...e,categories:y.a.map(s,function(e,a){return e["@id"]}),attachements:y.a.map(e.attachements,function(e,a){return e["@id"]}),budget:e.budget&&parseFloat(e.budget),autreCategories:i.length>0?y.a.join(y.a.map(i),", "):null,updated:l,updateExpiration:o,annulation:c};delete d.reference,d.motifRejet&&delete d.motifRejet;const u=r.a.put("/api/demande_achats/".concat(a),d);return e=>(e({type:P}),u.then(a=>{e(Object(n.B)({message:"Demande Modifi\xe9e"})),t.push("/demandes")}).catch(a=>{e({type:C,payload:b.y.parseApiErrors(a)})}))}function V(e){const a=r.a.delete(e["@id"]);return t=>(t({type:M}),a.then(a=>(t(Object(n.B)({message:"Document supprim\xe9"})),t({type:F,id:e.id}))).catch(e=>{t({type:I,payload:b.y.parseApiErrors(e)})}))}function B(e){return(a,t)=>{const s=new FormData;s.append("file",e);const i=r.a.post("/api/attachements",s,{headers:{"Content-Type":"multipart/form-data"}});return a({type:j}),i.then(e=>Promise.all([e,console.log(e.data),a({type:O,payload:e.data}),a(Object(n.B)({message:"Document t\xe9l\xe9charg\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))])).catch(e=>{a({type:w}),a(Object(n.B)({message:y.a.map(b.y.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}function Q(){return{type:A,payload:{id:null,reference:"",description:"",localisation:1,dateExpiration:null,isPublic:!1,isAnonyme:!1,categories:null,budget:0,motifRejet:"",statut:null,attachements:[],diffusionsdemandes:[]}}}var W=t(60),J=t.n(W);const $="[SEARCH CATEGORIES FRS APP] SC_SET_SEARCH_TEXT",K="[SEARCH CATEGORIES FRS APP] REQUEST_DATA",X="[SEARCH CATEGORIES FRS APP] GET_DATA",Z="[SEARCH CATEGORIES FRS APP] SC_OPEN",ee="[SEARCH CATEGORIES FRS APP] SC_CLOSE",ae="[SEARCH CATEGORIES FRS APP] SC_SUSSP",te=J.a.CancelToken;let ne,re;function se(e){return re&&clearTimeout(re),a=>{a({type:K}),re=setTimeout(()=>{a(function(e){ne&&ne();const a=r.a.get("/api/categories?name=".concat(e,"&del=false&props[]=id&props[]=name"),{cancelToken:new te(function(e){ne=e})});return e=>a.then(a=>{e({type:X,payload:a.data})}).catch(e=>{J.a.isCancel(e)&&console.log("get canceled")})}(e))},300+1e3*Math.random())}}function ie(e){return{type:$,searchText:e.target.value}}function le(){return{type:Z}}function oe(){return{type:ee}}const ce="[DIALOG] OPEN",de="[DIALOG] CLOSE";function ue(){return{type:de}}function me(e){return{type:ce,options:e}}t.d(a,"n",function(){return l}),t.d(a,"A",function(){return d}),t.d(a,"a",function(){return u}),t.d(a,"f",function(){return m}),t.d(a,"z",function(){return E}),t.d(a,"E",function(){return p}),t.d(a,"J",function(){return f}),t.d(a,"Q",function(){return g}),t.d(a,"j",function(){return h}),t.d(a,"U",function(){return v}),t.d(a,"m",function(){return N}),t.d(a,"e",function(){return A}),t.d(a,"o",function(){return x}),t.d(a,"g",function(){return S}),t.d(a,"p",function(){return P}),t.d(a,"s",function(){return"[ DEMANDE ACHETEUR APP] SAVE DEMANDE"}),t.d(a,"i",function(){return D}),t.d(a,"t",function(){return C}),t.d(a,"r",function(){return R}),t.d(a,"h",function(){return T}),t.d(a,"B",function(){return O}),t.d(a,"D",function(){return j}),t.d(a,"C",function(){return w}),t.d(a,"l",function(){return M}),t.d(a,"c",function(){return F}),t.d(a,"b",function(){return U}),t.d(a,"q",function(){return H}),t.d(a,"u",function(){return k}),t.d(a,"F",function(){return _}),t.d(a,"I",function(){return z}),t.d(a,"K",function(){return L}),t.d(a,"S",function(){return q}),t.d(a,"R",function(){return Y}),t.d(a,"P",function(){return G}),t.d(a,"H",function(){return V}),t.d(a,"W",function(){return B}),t.d(a,"N",function(){return Q}),t.d(a,"x",function(){return $}),t.d(a,"k",function(){return K}),t.d(a,"d",function(){return X}),t.d(a,"w",function(){return Z}),t.d(a,"v",function(){return ee}),t.d(a,"y",function(){return ae}),t.d(a,"a",function(){}),t.d(a,"E",function(){}),t.d(a,"M",function(){return se}),t.d(a,"T",function(){return ie}),t.d(a,"V",function(){return le}),t.d(a,"L",function(){return oe}),t.d(a,"G",function(){return ue}),t.d(a,"O",function(){return me})},1293:function(e,a,t){"use strict";var n=t(3),r=t.n(n),s=t(4),i=t.n(s),l=t(0),o=t.n(l),c=(t(28),t(54)),d=t.n(c),u=t(1157);var m=function(e){var a=e.theme,t=e.name,n=e.props;if(!a||!a.props||!a.props[t])return n;var r,s=a.props[t];for(r in s)void 0===n[r]&&(n[r]=s[r]);return n},E=t(1141);a.a=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(t){var n=a.defaultTheme,s=a.withTheme,l=void 0!==s&&s,c=a.name,p=i()(a,["defaultTheme","withTheme","name"]),f=c,g=Object(u.a)(e,r()({defaultTheme:n,Component:t,name:c||t.displayName,classNamePrefix:f},p)),h=o.a.forwardRef(function(e,a){e.classes;var s,d=e.innerRef,u=i()(e,["classes","innerRef"]),p=g(e),f=u;return("string"===typeof c||l)&&(s=Object(E.a)()||n,c&&(f=m({theme:s,name:c,props:u})),l&&!f.theme&&(f.theme=s)),o.a.createElement(t,r()({ref:d||a,classes:p},f))});return d()(h,t),h}}},1339:function(e,a,t){"use strict";var n=t(43),r=t(1263),s=t(102);const i={data:[],pageCount:null,loading:!1,searchText:"",parametres:{page:1,search:[],description:"",filter:{id:"created",direction:"desc"}}};var l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case r.a:return{...e,data:[]};case r.n:return{...e,loading:!0};case r.f:return{...e,data:a.payload["hydra:member"],pageCount:s.a.hydraPageCount(a.payload),loading:!1};case r.z:return{...e,searchText:a.searchText};case r.A:return{...e,parametres:{page:a.parametres.page,search:a.parametres.search,description:a.parametres.description,filter:{id:a.parametres.filter.id,direction:a.parametres.filter.direction}}};default:return e}};const o={data:null,fournisseurs:[],error:null,sousSecteurs:null,loading:!1,attachementReqInProgress:!1,deleteReqInProgress:!1,attachement:null,attachement_deleted:null,new:!1,requestSaveFrs:!1};var c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case r.r:case r.m:case r.p:return{...e,loading:!0,new:!1};case r.q:return{...e,requestSaveFrs:!0};case r.u:return{...e,requestSaveFrs:!1};case r.o:return{...e,loadingFrs:!0};case r.g:return{...e,fournisseurs:a.payload["hydra:member"],loadingFrs:!1};case r.b:return{...o,new:!1};case r.i:return{...e,new:!0};case r.D:return{...e,attachementReqInProgress:!0};case r.l:return{...e,deleteReqInProgress:!0};case r.B:return{...e,attachement:a.payload,attachementReqInProgress:!1};case r.c:return{...e,deleteReqInProgress:!1,attachement_deleted:a.id};case r.C:return{...e,attachementReqInProgress:!1};case r.h:return{...e,sousSecteurs:a.payload,loading:!1};case r.e:return{...e,data:a.payload,loading:!1};case r.s:return{...e,loading:!1,data:null};case r.t:return{...e,error:a.payload,loading:!1};default:return e}};const d={searchText:"",suggestions:[],loading:!1,opened:!1,noSuggestions:!1};var u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case r.a:return{...e,suggestions:[],noSuggestions:!1};case r.i:return{...d};case r.k:return{...e,loading:!0,suggestions:[],noSuggestions:!1};case r.d:{const t=a.payload["hydra:member"],n=0===t.length;return{...e,suggestions:t,noSuggestions:n,loading:!1}}case r.x:return{...e,searchText:a.searchText};case r.w:return{...e,opened:!0};case r.v:return{...e,opened:!1,searchText:""};case r.y:return{...e,opened:!1};default:return e}},m=t(33);const E={state:!1,options:{children:"Hi"}};var p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case m.f:return{...e,state:!0,options:{...e.options,...a.options}};case m.a:return{...e,state:!1};default:return e}};const f=Object(n.d)({demandes:l,demande:c,dialog:p,searchCategories:u});a.a=f},1412:function(e,a,t){"use strict";var n=t(175);Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=n(t(0)),s=(0,n(t(366)).default)(r.default.createElement(r.default.Fragment,null,r.default.createElement("path",{fill:"none",d:"M0 0h24v24H0z"}),r.default.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"})),"Error");a.default=s},1516:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(1227),i=t(1209),l=t(89),o=t(1204),c=t(1233),d=t(1224),u=t(1236),m=t(1219),E=t(1155),p=t(1232),f=t(1231),g=t(1150),h=t(1160),v=t(1215),b=t(1238),y=t(1221),N=t(1223),A=t(1244),x=t(1229),S=t(1245),P=t(1230),D=t(1140),C=t(163),R=t(1293),T=t(1157),O=t(39),j=t(201),w=t(137),M=t(16),F=t(2),I=t(10),U=t(7),H=t(136),k=t(1263),_=t(1339),z=t(51),L=t.n(z),q=t(59),Y=t.n(q),G=t(1242),V=t.n(G),B=t(1412),Q=t.n(B),W=t(365),J=t(139),$=t.n(J),K=t(1151),X=t(135),Z=t(1147),ee=t(371),ae=t.n(ee),te=t(364);const ne=Object(R.a)(e=>({root:{color:e.palette.secondary.main,backgroundColor:"white","&:hover":{backgroundColor:e.palette.secondary.main,color:"white"}}}))(s.a),re=(Object(R.a)(e=>({root:{color:C.a[500],borderColor:C.a[500],"&:hover":{backgroundColor:C.a[700],color:"white"}}}))(s.a),Object(R.a)(e=>({root:{color:V.a[500],borderColor:V.a[500],"&:hover":{backgroundColor:V.a[700],color:"white"}}}))(s.a),Object(T.a)(e=>({root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chips:{flex:1,display:"flex",flexWrap:"wrap"},buttonProgress:{color:V.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},demandeImageFeaturedStar:{position:"absolute",top:0,right:0,color:C.a[400],opacity:0},demandeImageUpload:{transitionProperty:"box-shadow",transitionDuration:e.transitions.duration.short,transitionTimingFunction:e.transitions.easing.easeInOut},select:{zIndex:999},demandeImageItem:{transitionProperty:"box-shadow",transitionDuration:e.transitions.duration.short,transitionTimingFunction:e.transitions.easing.easeInOut,"&:hover":{"& $demandeImageFeaturedStar":{opacity:.8}},"&.featured":{pointerEvents:"none",boxShadow:e.shadows[3],"& $demandeImageFeaturedStar":{opacity:1},"&:hover $demandeImageFeaturedStar":{opacity:1}}},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:e.spacing(2)},error:{backgroundColor:e.palette.error.dark},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"},margin:{margin:e.spacing(1)},titre:{paddingLeft:"10px",borderLeft:"10px solid "+e.palette.secondary.main}})));function se(e,a){let{query:t,isHighlighted:n}=a;return r.a.createElement(Z.a,{selected:n,component:"div",className:"z-999",dense:!0},r.a.createElement(i.a,{className:"pl-0 ",primary:r.a.createElement(ae.a,{highlightClassName:"YourHighlightClass",searchWords:[t],autoEscape:!0,textToHighlight:e.name})}))}function ie(e){const{classes:a,inputRef:t=(()=>{}),ref:n,...s}=e;return r.a.createElement(K.a,Object.assign({fullWidth:!0,InputProps:{inputRef:e=>{n(e),t(e)},classes:{input:a.input}},required:!0},s))}Y.a.defaultFormat="DD/MM/YYYY HH:mm",a.default=Object(H.a)("demandesAcheteurApp",_.a)(function(e){const a=Object(n.useRef)(null),t=Object(n.useRef)(null),C=Object(U.c)(e=>{let{demandesAcheteurApp:a}=e;return a.searchCategories}),[R,T]=r.a.useState([]),[H,_]=r.a.useState([]),z=Object(U.b)(),q=Object(U.c)(e=>{let{demandesAcheteurApp:a}=e;return a.demande}),[G,V]=Object(n.useState)(!1),[B,J]=Object(n.useState)(!1),[K,ee]=Object(n.useState)(!1),[ae,le]=Object(n.useState)(null),oe=Object(n.useRef)(null),{form:ce,handleChange:de,setForm:ue}=Object(w.b)(null),me=re(e),[Ee,pe]=Object(n.useState)(0),fe=e.match.params,{demandeId:ge}=fe,[he,ve]=Object(n.useState)(!1),[be,ye]=Object(n.useState)(!1);function Ne(e,a){ue(I.a.set({...ce},a,e.target.checked))}function Ae(){V(!1)}function xe(e){27===e.keyCode&&(Se(),z(k.E()))}function Se(){z(k.L()),document.removeEventListener("keydown",xe,!1)}Object(n.useEffect)(()=>("new"===ge?z(k.N()):(z(k.I(ge)),z(k.K(ge))),()=>{z(k.F())}),[z,ge]),Object(n.useEffect)(()=>{q.error&&(q.error.titre||q.error.description||q.error.dateExpiration||q.error.isPublic||q.error.isAnonyme||q.error.sousSecteurs)&&(oe.current.updateInputsWithError({...q.error}),Ae(),q.error=null)},[q.error]),Object(n.useEffect)(()=>{q.attachement&&(ue(I.a.set({...ce},"attachements",[q.attachement,...ce.attachements])),q.attachement=null)},[ce,ue,q.attachement]),Object(n.useEffect)(()=>{q.attachement_deleted&&(ue(I.a.set({...ce},"attachements",I.a.pullAllBy(ce.attachements,[{id:q.attachement_deleted}],"id"))),q.attachement_deleted=null)},[q.attachement_deleted]),Object(n.useEffect)(()=>{q.new&&(ue({...q.data}),T([]),q.new=!1)},[q,ue]),Object(n.useEffect)(()=>{(q.data&&!ce||q.data&&ce&&q.data.id!==ce.id)&&(ue({...q.data}),q.data.categories&&T(q.data.categories.map(e=>e)),q.data.autreCategories&&_(I.a.split(q.data.autreCategories,",")))},[ce,q.data,ue]),Object(n.useEffect)(()=>{"new"!==ge&&q.data&&ce&&1===q.data.statut&&(q.data.titre===ce.titre&&q.data.description===ce.description&&I.a.isEqual(q.data.attachements,ce.attachements)&&I.a.isEqual(R,q.data.categories)?J(!1):J(!0))},[ce,q.data,ge,R]),Object(n.useEffect)(()=>{if("new"!==ge&&q.data&&ce&&1===q.data.statut)if(Y()(q.data.dateExpiration).isSame(ce.dateExpiration))le(null),ee(!1);else{let e=Y.a.duration(Y()(ce.dateExpiration).diff(q.data.dateExpiration)),a=e.hours(),t=e.days(),n=e.months(),r=e.years(),s=0!==r&&"".concat(r," an(s)")||0!==n&&"".concat(n," mois")||0!==t&&"".concat(t," jour(s)")||0!==a&&"".concat(a," heure(s)");le(s=(r<0||n<0||t<0||a<0?"\xe9court\xe9e de ":"prolong\xe9e de ")+s),ee(!0)}},[ce,q.data,ge]);const Pe={renderInputComponent:ie,suggestions:C.suggestions,focusInputOnSuggestionClick:!1,onSuggestionsFetchRequested:function(e){let{value:a,reason:t}=e;"input-changed"===t&&a&&a.trim().length>1&&z(k.M(a.trim()))},onSuggestionsClearRequested:function(){},renderSuggestion:se};function De(){-1===H.indexOf(C.searchText)&&_([C.searchText,...H]),Se(),z(k.E())}function Ce(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=e.match.params,{demandeId:n}=t;z("new"===n?k.R(ce,e.history,R,H,a):k.P(ce,ce.id,e.history,R,H,B,K,a))}return r.a.createElement(r.a.Fragment,null,r.a.createElement(te.Helmet,null,r.a.createElement("title",null,"new"===ge?"Nouvelle demande":"Edit demande"," | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(O.o,{classes:{toolbar:"p-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:q.loading?"":ce&&r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex flex-col items-start max-w-full"},r.a.createElement(O.d,{animation:"transition.slideRightIn",delay:300},r.a.createElement(l.a,{className:"normal-case flex items-center sm:mb-12",component:M.a,role:"button",to:"/demandes",color:"inherit"},r.a.createElement(o.a,{className:"mr-4 text-20"},"arrow_back"),"Retour")),r.a.createElement("div",{className:"flex items-center max-w-full"},r.a.createElement("div",{className:"flex flex-col min-w-0"},r.a.createElement(O.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(l.a,{className:"text-16 sm:text-20 truncate"},ce.titre?ce.titre:"Nouvelle Demande")),r.a.createElement(O.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(l.a,{variant:"caption"},"D\xe9tails de la demande"))))),r.a.createElement("div",null,r.a.createElement(s.a,{className:"whitespace-no-wrap",variant:"contained",color:"secondary",disabled:!G||q.loading||!R.length&&!H.length||3===q.data.statut,onClick:()=>Ce(!1)},r.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder"),r.a.createElement("span",{className:"flex sm:hidden"},r.a.createElement(o.a,null,"save")),q.loading&&r.a.createElement(c.a,{size:24,className:me.buttonProgress})),"new"===ge&&r.a.createElement(s.a,{className:"ml-8",color:"secondary",variant:"contained",disabled:!G||q.loading||!R.length&&!H.length,onClick:()=>Ce(!0)},r.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder et ajouter nouvelle demande"),r.a.createElement("span",{className:"flex sm:hidden"},r.a.createElement(o.a,null,"repeat")),q.loading&&r.a.createElement(c.a,{size:24,className:me.buttonProgress})))),contentToolbar:q.loading?r.a.createElement("div",{className:me.root},r.a.createElement(d.a,{color:"secondary"})):r.a.createElement(u.a,{value:Ee,onChange:function(e,a){pe(a)},indicatorColor:"secondary",textColor:"secondary",variant:"scrollable",scrollButtons:"auto",classes:{root:"w-full h-64"}},r.a.createElement(m.a,{className:"h-64 normal-case",label:"Infos g\xe9n\xe9rales"}),r.a.createElement(m.a,{className:"h-64 normal-case",label:ce&&ce.attachements.length>0?"Pi\xe8ce(s) jointe(s) ("+ce.attachements.length+")":"Pi\xe8ce(s) jointe(s)"}),q&&q.fournisseurs.length>0&&!q.data.isAnonyme?r.a.createElement(m.a,{className:Object(F.a)("h-64 normal-case text-orange",3===q.data.statut?"text-green":"text-orange"),label:q.data&&q.data&&3===q.data.statut?"Adjug\xe9e":q.fournisseurs.length+" fournisseur(s) participant(s)"}):""),content:q.loading?"":ce&&r.a.createElement("div",{className:"p-10  sm:p-24 max-w-2xl"},0===Ee&&r.a.createElement(L.a,{onValidSubmit:Ce,onValid:function(){V(!0)},onInvalid:Ae,ref:oe,className:"flex flex-col "},ce.statut&&2===ce.statut?r.a.createElement(E.a,{className:Object(F.a)(me.margin,me.error),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:me.message},r.a.createElement(Q.a,{className:Object(F.a)(me.icon,me.iconVariant)}),"Motif du rejet:"," ",ce.motifRejet?ce.motifRejet.name:"")}):"",r.a.createElement(p.a,{container:!0,spacing:3,className:"mb-8"},1===ce.statut&&r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(l.a,{variant:"caption",className:"font-bold flex items-center",color:"secondary"},r.a.createElement(o.a,{className:"mr-2"},"info"),"Toutes modifications sur les champs ( D\xe9signation, Description, Produits, Pi\xe8ce(s) jointe(s) ), la demande sera remis \xe0 l'\xe9tat initial \"En attente\" pour la validation de l'administrateur."))),r.a.createElement(p.a,{container:!0,spacing:3},r.a.createElement(p.a,{item:!0,xs:12,sm:7},r.a.createElement(O.F,{className:"mb-24",label:"Designation",autoFocus:!0,id:"titre",name:"titre",value:ce.titre,onChange:de,variant:"outlined",validations:{minLength:4,maxLength:255},validationErrors:{minLength:"Min character length is 4",maxLength:"Max character length is 255"},required:!0,fullWidth:!0})),r.a.createElement(p.a,{item:!0,xs:12,sm:4},r.a.createElement(O.F,{className:"mb-24",label:"R\xe9f\xe9rence",id:"reference",name:"reference",value:ce.reference?ce.reference:"En attente",variant:"outlined",InputProps:{startAdornment:r.a.createElement(f.a,{position:"start"},"RFQ-")},disabled:!0,fullWidth:!0}))),r.a.createElement(p.a,{container:!0,spacing:3},r.a.createElement(p.a,{item:!0,xs:12,sm:6},r.a.createElement(O.b,{label:"Date d'expiration",id:"dateExpiration",name:"dateExpiration",value:ce.dateExpiration,onChange:e=>(function(e,a){ue(I.a.set({...ce},a,Y()(e).format("YYYY-MM-DDTHH:mm")))})(e,"dateExpiration"),variant:"outlined",required:!0,fullWidth:!0}),K&&ae&&r.a.createElement(l.a,{variant:"caption",className:"uppercase font-bold mb-16 flex items-center",color:"secondary"},r.a.createElement(o.a,null,"info"),"\u2002",ae)),r.a.createElement(p.a,{item:!0,xs:12,sm:6},r.a.createElement(O.F,{className:"mb-24",label:"Budget",id:"budget",type:"number",name:"budget",value:I.a.toString(ce.budget),onChange:de,variant:"outlined",validations:{isNumeric:!0},validationErrors:{isNumeric:"Numeric value required"},step:"any",required:!0,fullWidth:!0}))),r.a.createElement("div",{ref:t},r.a.createElement($.a,Object.assign({},Pe,{getSuggestionValue:e=>C.searchText,onSuggestionSelected:(e,a)=>{let{suggestion:n,method:r}=a;"enter"===r&&e.preventDefault(),!I.a.find(R,["name",n.name])&&T([n,...R]),t.current.focus()},required:!0,inputProps:{classes:me,label:"Produits Services \xe0 Recherchez ",placeholder:"Produit (ex: Projecteur)",value:C.searchText,variant:"outlined",name:"categories",onChange:function(e){z(k.T(e))},onFocus:function(){z(k.V()),document.addEventListener("keydown",xe,!1)},InputLabelProps:{shrink:!0}},theme:{container:me.container,suggestionsContainerOpen:me.suggestionsContainerOpen,suggestionsList:me.suggestionsList,suggestion:me.suggestion},renderSuggestionsContainer:e=>r.a.createElement(g.a,{anchorEl:t.current,open:Boolean(e.children)||C.noSuggestions||C.loading,popperOptions:{positionFixed:!0},className:"z-9999 mb-8"},r.a.createElement("div",{ref:a},r.a.createElement(X.a,Object.assign({elevation:1,square:!0},e.containerProps,{style:{width:t.current?t.current.clientWidth:null}}),e.children,C.noSuggestions&&r.a.createElement(Z.a,{component:"div",className:"z-999",onClick:De,dense:!0},r.a.createElement(i.a,{className:"pl-0 ",primary:C.searchText})),C.loading&&r.a.createElement("div",{className:"px-16 py-12 text-center"},r.a.createElement(c.a,{color:"secondary"})," ",r.a.createElement("br",null)," Chargement ..."))))}))),r.a.createElement(l.a,{variant:"caption",className:"font-bold flex items-center",color:"secondary"},"IMPORTANT : Pour que votre demande soit diffus\xe9e aux fournisseurs d\xe9sign\xe9s, veuillez s\xe9lectionner le bon produit."),r.a.createElement("div",{className:Object(F.a)(me.chips)},R&&R.length>0&&R.map((e,a)=>r.a.createElement(h.a,{key:a,label:e.name,onDelete:()=>(function(e){T(I.a.reject(R,function(a){return a.id===e}))})(e.id),className:"mt-8 mr-8"})),H&&H.length>0&&H.map((e,a)=>r.a.createElement(h.a,{key:a,label:e,onDelete:()=>(function(e){_(I.a.reject(H,function(a){return a===e}))})(e),className:"mt-8 mr-8"}))),r.a.createElement(p.a,{container:!0,spacing:3},r.a.createElement(p.a,{item:!0,xs:12,sm:12},r.a.createElement(O.F,{className:"mb-16 mt-16  w-full",type:"text",name:"description",value:ce.description,onChange:de,label:"Description",autoFocus:!0,validations:{minLength:10},validationErrors:{minLength:"La longueur minimale de caract\xe8re est 10"},required:!0,variant:"outlined",multiline:!0,rows:"4"}))),r.a.createElement(p.a,{container:!0,spacing:3,className:"flex items-center"},r.a.createElement(p.a,{item:!0,xs:12,sm:4},r.a.createElement(O.C,{className:"inline",name:"statut",label:"Diffuser \xe0 l'\xe9chelle",onChange:function(e){ue(I.a.set({...ce},"localisation",parseInt(e.target.value)))}},r.a.createElement(v.a,{value:"2",disabled:1===ce.statut,checked:2===ce.localisation,control:r.a.createElement(b.a,null),label:"Locale"}),r.a.createElement(v.a,{value:"3",disabled:1===ce.statut,checked:3===ce.localisation,control:r.a.createElement(b.a,null),label:"Internationale"}),r.a.createElement(v.a,{value:"1",disabled:1===ce.statut,checked:1===ce.localisation,control:r.a.createElement(b.a,null),label:"Les deux"}))),r.a.createElement(p.a,{item:!0,xs:12,sm:4,className:"flex items-center"},r.a.createElement(O.a,{name:"isPublic",disabled:1===ce.statut,onChange:e=>Ne(e,"isPublic"),value:ce.isPublic,label:"Mettre en ligne apr\xe8s validation"}),r.a.createElement(y.a,{placement:"top",title:"Si vous mettez la demande en ligne apr\xe8s validation, elle sera visibile par les founrisseurs et les visiteurs du site web.","aria-label":"anonyme"},r.a.createElement(o.a,{className:"ml-4 text-20"},"help_outline"))),r.a.createElement(p.a,{item:!0,xs:12,sm:4,className:"flex items-center"},r.a.createElement(O.a,{onChange:e=>Ne(e,"isAnonyme"),name:"isAnonyme",disabled:1===ce.statut,value:ce.isAnonyme,label:"Mettre la demande anonyme"}),r.a.createElement(y.a,{placement:"top",title:"Si vous mettez la demande anonyme, les achats industriels prend en charge la reception des devis d'aupr\xe8s les fournisseurs et elle vous choisi la meiileure offre.","aria-label":"anonyme"},r.a.createElement(o.a,{className:"ml-4 text-20"},"help_outline")))),r.a.createElement(p.a,{container:!0,spacing:3,className:"mb-8"},r.a.createElement(p.a,{item:!0,xs:12,sm:8},r.a.createElement(l.a,{variant:"caption"},"- Soumettez votre demande c'est gratuit et sans engagement.",r.a.createElement("br",null),"- D\xe9taillez la demande, vous recevrez de meilleures offres.",r.a.createElement("br",null),"- Attention seules les demandes s\xe9rieuses (pas de projets \xe9tudiants) seront valid\xe9es.",r.a.createElement("br",null))),r.a.createElement(p.a,{item:!0,xs:12,sm:4,className:"justify-end text-right"},r.a.createElement(l.a,{variant:"caption",className:"font-extrabold"},r.a.createElement("span",{className:"text-red font-600"},"*")," Champs obligatoires."))),r.a.createElement(p.a,{container:!0,spacing:3,className:"mt-4"},r.a.createElement(p.a,{item:!0,xs:12,sm:10},r.a.createElement(s.a,{className:"whitespace-no-wrap",variant:"contained",color:"secondary",disabled:!G||q.loading||!R.length&&!H.length||3===q.data.statut,onClick:()=>ve(!0)},r.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder avant diffuser"),r.a.createElement("span",{className:"flex sm:hidden"},r.a.createElement(o.a,null,"save")),q.loading&&r.a.createElement(c.a,{size:24,className:me.buttonProgress})),r.a.createElement(s.a,{style:{backgroundColor:"orangered",marginLeft:"20px"},className:"whitespace-no-wrap",variant:"contained",color:"secondary",disabled:!G||q.loading||!R.length&&!H.length||3===q.data.statut,onClick:()=>ye(!0)},r.a.createElement("span",{className:"hidden sm:flex"},"Envoyer"),r.a.createElement("span",{className:"flex sm:hidden"},r.a.createElement(o.a,null,"send")),q.loading&&r.a.createElement(c.a,{size:24,className:me.buttonProgress})),r.a.createElement(N.a,{open:he,onClose:()=>ve(!1),"aria-labelledby":"save-dialog-title","aria-describedby":"save-dialog-description"},r.a.createElement(A.a,{id:"save-dialog-title"},"Sauvegarder"),r.a.createElement(x.a,null,r.a.createElement(S.a,{id:"save-dialog-description"},"Voulez-vous vraiment sauvegarder cet enregistrement avant de diffuser ?")),r.a.createElement(P.a,null,r.a.createElement(s.a,{onClick:()=>ve(!1),color:"primary"},"Non"),r.a.createElement(s.a,{onClick:()=>{Ce(!1),ve(!1)},color:"primary",autoFocus:!0},"Oui"))),r.a.createElement(N.a,{open:be,onClose:()=>ye(!1),"aria-labelledby":"send-dialog-title","aria-describedby":"send-dialog-description"},r.a.createElement(A.a,{id:"send-dialog-title"},"Envoyer"),r.a.createElement(x.a,null,r.a.createElement(S.a,{id:"send-dialog-description"},"Voulez-vous vraiment envoyer cet enregistrement ?")),r.a.createElement(P.a,null,r.a.createElement(s.a,{onClick:()=>ye(!1),color:"primary"},"Non"),r.a.createElement(s.a,{onClick:()=>{Ce(!1),ye(!1)},color:"primary",autoFocus:!0},"Oui"))),"new"===ge&&r.a.createElement(s.a,{className:"ml-8",variant:"contained",color:"secondary",disabled:!G||q.loading||!R.length&&!H.length,onClick:()=>Ce(!0)},r.a.createElement("span",{className:"hidden sm:flex"},"Sauvegarder et ajouter nouvelle demande"),r.a.createElement("span",{className:"flex sm:hidden"},r.a.createElement(o.a,null,"save")," et ",r.a.createElement(o.a,null,"repeat")),q.loading&&r.a.createElement(c.a,{size:24,className:me.buttonProgress}))))),1===Ee&&r.a.createElement("div",null,r.a.createElement("input",{accept:"text/plain,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.ms-powerpoint,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,application/pdf,image/jpeg,image/gif,image/png,application/pdf,",className:"hidden",id:"button-file",type:"file",disabled:q.attachementReqInProgress,onChange:function(e){const a=e.target.files[0];a&&z(k.W(a))}}),r.a.createElement("div",{className:"flex justify-center sm:justify-start flex-wrap"},r.a.createElement("label",{htmlFor:"button-file",className:Object(F.a)(me.demandeImageUpload,"flex items-center justify-center relative w-128 h-128 rounded-4 mr-16 mb-16 overflow-hidden cursor-pointer shadow-1 hover:shadow-5",5===ce.attachements.length&&"hidden")},q.attachementReqInProgress?r.a.createElement(c.a,{size:24,className:me.buttonProgress}):r.a.createElement(o.a,{fontSize:"large",color:"action"},"arrow_upward")),ce.attachements.map(e=>r.a.createElement("div",{className:Object(F.a)(me.demandeImageItem,"flex items-center cursor-pointer justify-center relative w-128 h-128 rounded-4 mr-16 mb-16 overflow-hidden  shadow-1 hover:shadow-5"),key:e.id,onClick:()=>window.open(j.d+e.url,"_blank")},r.a.createElement(y.a,{title:"Supprimer"},r.a.createElement(D.a,{className:me.demandeImageFeaturedStar,onClick:a=>{a.stopPropagation(),z(k.H(e))}},r.a.createElement(o.a,null,"delete"))),"image"===I.a.split(e.type,"/",1)[0]?r.a.createElement("img",{className:"max-w-none w-auto h-full",src:j.d+e.url,alt:"demande"}):r.a.createElement(o.a,{color:"secondary",style:{fontSize:80}},"insert_drive_file"))),r.a.createElement(p.a,{container:!0,spacing:3},r.a.createElement(p.a,{item:!0,xs:12,sm:6},r.a.createElement(l.a,{variant:"caption"},"- Taille maximale par fichier : 2 Mo ",r.a.createElement("br",null),"- 5 fichiers \xe0 t\xe9l\xe9charger ",r.a.createElement("br",null),"- Extensions de fichier autoris\xe9es: .jpg, .jpeg, .png, .xls, .xlsx , .bmp , .doc , .docx , .pdf , .txt"))))),2===Ee&&r.a.createElement("div",{className:"w-full flex flex-col"},q.data&&3===q.data.statut&&!q.data.isAnonyme?r.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},r.a.createElement(l.a,{variant:"h6",className:"flex items-center"},r.a.createElement(o.a,{className:"mr-2 text-40",color:"secondary"},"gavel")," ","Cette demande a \xe9t\xe9 adjug\xe9e par :"," ",r.a.createElement("strong",{className:"uppercase ml-2"}," ",q.data.fournisseurGagne?q.data.fournisseurGagne.societe:"Fournisseur hors site"))):r.a.createElement("div",null,r.a.createElement(l.a,{variant:"h6",className:Object(F.a)("mb-8 ml-2",me.titre)},"D\xe9tail de la demande"),r.a.createElement("div",{className:"table-responsive mb-16"},r.a.createElement("table",{className:"simple"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"font-bold"},"R\xe9f\xe9rence"),r.a.createElement("th",{className:"font-bold"},"D\xe9signation"),r.a.createElement("th",{className:"font-bold"},"Description"),r.a.createElement("th",{className:"font-bold"},"Produits"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("div",{className:"flex items-center"},r.a.createElement(l.a,{className:"truncate"},"RFQ-"+q.data.reference))),r.a.createElement("td",null,r.a.createElement(l.a,{className:"truncate"},q.data.titre)),r.a.createElement("td",null,r.a.createElement(l.a,{className:"truncate"},q.data.description)),r.a.createElement("td",null,r.a.createElement("span",{className:"truncate"},I.a.join(I.a.map(q.data.categories,"name"),", "))))))),r.a.createElement("div",{className:"flex flex-1 items-center justify-between mb-10"},r.a.createElement(l.a,{variant:"h6",className:Object(F.a)("mb-8 ml-2",me.titre)},"Fournisseurs participants ("," ",q.fournisseurs.length," )"),r.a.createElement(ne,{color:"secondary",size:"small",variant:"outlined",disabled:q.requestSaveFrs,onClick:e=>{e.stopPropagation(),z(k.O({children:r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{id:"alert-dialog-title"},"Attribution"),r.a.createElement(x.a,null,r.a.createElement(S.a,{id:"alert-dialog-description"},"Voulez vous vraiment attribuer cette demande \xe0 un fournisseur hors site ?")),r.a.createElement(P.a,null,r.a.createElement(s.a,{variant:"outlined",onClick:()=>z(k.G()),color:"primary"},"Non"),r.a.createElement(s.a,{variant:"contained",color:"secondary",onClick:e=>{z(k.S(null,ce.id)),z(k.G())},autoFocus:!0},"Oui")))}))}},"attribu\xe9e \xe0 un fournisseur hors site",q.requestSaveFrs&&r.a.createElement(c.a,{size:24,className:me.buttonProgress}))),r.a.createElement(W.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",data:q.fournisseurs,columns:[{Header:"Nombre de fournisseur",accessor:"id",Cell:e=>r.a.createElement("div",{style:{textAlign:"center"}},e.index+1)},{Header:"Fournisseur",className:"font-bold",id:"fournisseur",accessor:e=>e.fournisseur.societe+" "+e.fournisseur.firstName+" "+e.fournisseur.lastName+" "+e.fournisseur.phone},{Header:"",Cell:e=>r.a.createElement("div",{className:"flex items-center"},r.a.createElement(ne,{color:"secondary",size:"small",variant:"outlined",disabled:q.requestSaveFrs,onClick:a=>{a.stopPropagation(),z(k.O({children:r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{id:"alert-dialog-title"},"Attribution"),r.a.createElement(x.a,null,r.a.createElement(S.a,{id:"alert-dialog-description"},"Voulez vous vraiment attribuer cette demande \xe0"," ",r.a.createElement("strong",null,e.original.fournisseur.societe)," ","?")),r.a.createElement(P.a,null,r.a.createElement(s.a,{variant:"outlined",onClick:()=>z(k.G()),color:"primary"},"Non"),r.a.createElement(s.a,{variant:"contained",color:"secondary",onClick:a=>{z(k.S(e.original.fournisseur.id,ce.id)),z(k.G())},autoFocus:!0},"Oui")))}))}},"Adjug\xe9e",q.requestSaveFrs&&r.a.createElement(c.a,{size:24,className:me.buttonProgress})))}],defaultPageSize:q.fournisseurs.length<10?q.fournisseurs.length:10,ofText:"sur"})))),innerScroll:!0}))})}}]);