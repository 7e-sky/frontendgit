(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{1244:function(e,a,t){"use strict";var r=t(3),l=t.n(r),n=t(4),i=t.n(n),s=t(0),c=t.n(s),o=t(2),m=t(8),d=t(89),u=c.a.forwardRef(function(e,a){var t=e.children,r=e.classes,n=e.className,s=e.disableTypography,m=void 0!==s&&s,u=i()(e,["children","classes","className","disableTypography"]);return c.a.createElement("div",l()({className:Object(o.a)(r.root,n),ref:a},u),m?t:c.a.createElement(d.a,{variant:"h6"},t))});a.a=Object(m.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(u)},1245:function(e,a,t){"use strict";var r=t(3),l=t.n(r),n=t(0),i=t.n(n),s=t(8),c=t(89),o=i.a.forwardRef(function(e,a){return i.a.createElement(c.a,l()({component:"p",variant:"body1",color:"textSecondary",ref:a},e))});a.a=Object(s.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(o)},1543:function(e,a,t){"use strict";t.r(a);var r=t(0),l=t.n(r),n=t(39),i=t(7),s=t(136),c=t(89),o=t(1130),m=t(1227),d=t(1140),u=t(1204),p=t(1244),E=t(1229),h=t(1245),f=t(1230),v=t(1221),g=t(365),b=t(50),C=t(102),N=t(33),y=t(10);const O="[VILLES APP] GET VILLES",A="[COMMERCIALS APP] GET COMMERCIALS",x="[COMMERCIALS APP] SET SEARCH TEXT",P="[COMMERCIALS APP] OPEN_NEW_COMMERCIALS_DIALOG",M="[COMMERCIALS APP] OPEN EDIT COMMERCIALS DIALOG",L="[COMMERCIALS APP] CLOSE EDIT COMMERCIALS DIALOG",I="[COMMERCIALS APP] SAVE ERROR",j="[COMMERCIALS APP] UPDATE COMMERCIAL",S="[COMMERCIALS APP] REMOVE COMMERCIAL",R="[COMMERCIALS APP] STATUT COMMERCIAL",w="[COMMERCIALS APP] UPLOAD IMAGE",T="[COMMERCIALS APP] UPLOAD REQUEST",D="[COMMERCIALS APP] UPLOAD ERROR",k="[COMMERCIALS APP] REQUEST SAVE",F="[COMMERCIALS APP] REQUEST_COMMERCIALS";function W(){const e=b.a.get("/api/commercials");return a=>(a({type:F}),e.then(e=>{a({type:A,payload:e.data["hydra:member"]})}))}function q(){return{type:L}}function H(e){let a={del:!0,username:e.username+"_deleted-"+e.id,email:e.email+"_deleted-"+e.id};return(t,r)=>{return b.a.put(e["@id"],a).then(e=>Promise.all([t({type:S}),t(Object(N.B)({message:"Commercial bien supprim\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>t(W())))}}function z(e,a){let t={isactif:a};return(a,r)=>{return b.a.put(e["@id"],t).then(e=>Promise.all([a({type:R}),a(Object(N.B)({message:"Statut modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>a(W())))}}const V="[DIALOG] OPEN",G="[DIALOG] CLOSE";function U(){return{type:G}}function _(e){return{type:V,options:e}}var B=t(59),Y=t.n(B),Q=t(8);var J=function(e){const a=Object(i.b)(),t=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.entities}),s=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.loadingComl}),b=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.searchText}),[C,N]=Object(r.useState)(null),O=Object(Q.a)(e=>({tooltip:{maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9","& b":{fontWeight:e.typography.fontWeightMedium}}}))(v.a);return Object(r.useEffect)(()=>{t&&N(function(e,a){const t=Object.keys(e).map(a=>e[a]);return 0===a.length?t:n.y.filterArrayByString(t,a)}(t,b))},[t,b]),C?0===C.length?l.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},l.a.createElement(c.a,{color:"textSecondary",variant:"h5"},"Il n'y a pas de commerciaux!")):l.a.createElement(n.d,{animation:"transition.slideUpIn",delay:300},l.a.createElement(g.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:(e,t,r)=>({className:"cursor-pointer",onClick:(e,r)=>{t&&a(function(e){return{type:M,data:e}}(t.original))}}),data:C,columns:[{Header:"",Cell:e=>e.original.avatar?l.a.createElement(o.a,{className:"mr-8",alt:e.original.firstName,src:n.G+e.original.avatar.url}):l.a.createElement(o.a,{className:"mr-8",alt:e.original.firstName,src:"assets/images/avatars/images.png"}),className:"justify-center",width:64,sortable:!1},{Header:"Nom",accessor:"lastName",filterable:!0},{Header:"Pr\xe9nom",accessor:"firstName",filterable:!0},{Header:"Email",accessor:"email",filterable:!0},{Header:"T\xe9l\xe9phone",accessor:"phone",filterable:!0},{Header:"Date de cr\xe9ation",Cell:e=>Y()(e.original.created).format("DD/MM/YYYY HH:mm")},{Header:"Admin",width:140,Cell:e=>e.original.parent1?e.original.parent1.firstName+" "+e.original.parent1.lastName:""},{Header:"Villes",width:64,className:"font-bold",Cell:e=>l.a.createElement("div",{className:"flex items-center"},l.a.createElement(O,{title:l.a.createElement(l.a.Fragment,null,0===Object.keys(e.original.villes).length?"Il n'y aucun villes":l.a.createElement("ul",null,y.a.map(e.original.villes,function(e,a){return l.a.createElement("li",{key:a}," ",e.name," ")})))},l.a.createElement(m.a,{onClick:e=>{e.stopPropagation()}},Object.keys(e.original.villes).length)))},{Header:"Statut",width:64,Cell:e=>e.original.isactif?l.a.createElement(v.a,{title:"Activ\xe9"},l.a.createElement(d.a,{className:"text-green text-20",onClick:t=>{t.stopPropagation(),a(z(e.original,!1))}},l.a.createElement(u.a,null,"check_circle"))):l.a.createElement(v.a,{title:"D\xe9sactiv\xe9"},l.a.createElement(d.a,{className:"text-red text-20",onClick:t=>{t.stopPropagation(),a(z(e.original,!0))}},l.a.createElement(u.a,null,"remove_circle")))},{Header:"",width:64,Cell:e=>l.a.createElement("div",{className:"flex items-center"},l.a.createElement(d.a,{className:"text-red text-20",onClick:t=>{t.stopPropagation(),a(_({children:l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a,{id:"alert-dialog-title"},"Suppression"),l.a.createElement(E.a,null,l.a.createElement(h.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),l.a.createElement(f.a,null,l.a.createElement(m.a,{onClick:()=>a(U()),color:"primary"},"Non"),l.a.createElement(m.a,{onClick:t=>{a(H(e.original)),a(U())},color:"primary",autoFocus:!0},"Oui")))}))}},l.a.createElement(u.a,null,"delete")))}],loading:s,defaultPageSize:10,noDataText:"Aucun commercial trouv\xe9",loadingText:"Chargement...",ofText:"sur"})):null},X=t(135),Z=t(1139),K=t(1205);var $=function(e){const a=Object(i.b)(),t=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.searchText}),r=Object(i.c)(e=>{let{fuse:a}=e;return a.settings.mainTheme});return l.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},l.a.createElement("div",{className:"flex items-center"},l.a.createElement(n.d,{animation:"transition.expandIn",delay:300},l.a.createElement(u.a,{className:"text-32 mr-0 sm:mr-12"},"group")),l.a.createElement(n.d,{animation:"transition.slideLeftIn",delay:300},l.a.createElement(c.a,{className:"hidden sm:flex",variant:"h6"},"Gestion des commerciaux"))),l.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"},l.a.createElement(K.a,{theme:r},l.a.createElement(n.d,{animation:"transition.slideDownIn",delay:300},l.a.createElement(X.a,{className:"flex items-center w-full max-w-512 px-8 py-4 rounded-8",elevation:1},l.a.createElement(u.a,{className:"mr-8",color:"action"},"search"),l.a.createElement(Z.a,{placeholder:"Rechercher...",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:t,inputProps:{"aria-label":"Search"},onChange:e=>a(function(e){return{type:x,searchText:e.target.value}}(e))}))))),l.a.createElement(n.d,{animation:"transition.slideRightIn",delay:300},l.a.createElement(m.a,{onClick:e=>a({type:P}),className:"whitespace-no-wrap",variant:"contained"},l.a.createElement("span",{className:"hidden sm:flex"},"Ajouter nouveau Comm."),l.a.createElement("span",{className:"flex sm:hidden"},"New"))))},ee=t(1223),ae=t(1218),te=t(1228),re=t(1233),le=t(1160),ne=t(1231),ie=t(137),se=t(201),ce=t(51),oe=t.n(ce),me=t(368);const de={firstName:"",lastName:"",adresse1:"",adresse2:"",codepostal:null,phone:"",email:"",villes:null};var ue=function(e){const a=Object(i.b)(),t=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.commercialsDialog}),s=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials}),v=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.villes}),g=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.imageReqInProgress}),O=Object(i.c)(e=>{let{commercialsApp:a}=e;return a.commercials.avatar}),{form:A,handleChange:x,setForm:P}=Object(ie.b)(de),[M,L]=Object(r.useState)(!1),S=Object(r.useRef)(null),R=Object(r.useCallback)(()=>{if("edit"===t.type&&t.data){let e=t.data.villes.map(e=>({value:e["@id"],label:e.name}));P({...t.data}),P(y.a.set({...t.data},"villes",e))}},[t.data,t.type,P]);function F(){a(q())}function z(){a(H(A)),a(U()),F()}function V(){L(!1)}return Object(r.useEffect)(()=>{s.error&&(s.error.firstName||s.error.lastName||s.error.adresse1||s.error.adresse2||s.error.codepostal||s.error.phone||s.error.email||s.error.villes)&&(S.current.updateInputsWithError({...s.error}),V(),s.error=null)},[s.error]),Object(r.useEffect)(()=>{t.props.open&&R()},[t.props.open,R]),Object(r.useEffect)(()=>{P(O?y.a.set({...A},"avatar",O):y.a.set({...A},"avatar",null))},[O]),l.a.createElement(ee.a,Object.assign({classes:{paper:"m-24"}},t.props,{onClose:F,fullWidth:!0,maxWidth:"xs"}),l.a.createElement(ae.a,{position:"static",elevation:1},l.a.createElement(te.a,{className:"flex w-full"},l.a.createElement(c.a,{variant:"subtitle1",color:"inherit"},"new"===t.type?"Nouvelle Commercial":"Editer Commercial")),l.a.createElement("div",{className:"flex flex-col items-center justify-center pb-24"},g?l.a.createElement(o.a,{className:""},l.a.createElement(re.a,{size:24})):l.a.createElement(o.a,{className:"w-96 h-96",alt:"contact avatar",src:A.avatar?se.d+A.avatar.url:"assets/images/avatars/images.png"}),"edit"===t.type&&l.a.createElement(c.a,{variant:"h6",color:"inherit",className:"pt-8"},A.firstName,"\u2002",A.lastName),A.parent1&&l.a.createElement(le.a,{avatar:l.a.createElement(o.a,{alt:"Natacha",src:A.parent1.avatar?se.d+A.parent1.avatar.url:"assets/images/avatars/images.png"}),label:"Admin: "+A.parent1.firstName+" "+A.parent1.lastName,variant:"outlined",color:"secondary"}))),l.a.createElement(oe.a,{onValidSubmit:function(e){A.codepostal=y.a.parseInt(A.codepostal),"edit"===t.type&&a(function(e){let a=null,t=null;e.villes&&(a=e.villes.map(e=>e.value)),e.avatar&&e.avatar.url&&(t=e.avatar["@id"]);const r={...e,villes:a,avatar:t};return a=>(a({type:k}),b.a.put(e["@id"],r).then(e=>Promise.all([a({type:j}),a(Object(N.B)({message:"Commercial bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"})),a(q())]).then(()=>a(W()))).catch(e=>{a({type:I,payload:C.a.parseApiErrors(e)})}))}(A))},onValid:function(){L(!0)},onInvalid:V,ref:S,className:"flex flex-col overflow-hidden"},l.a.createElement(E.a,{classes:{root:"p-24"}},l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",label:"Nom",autoFocus:!0,id:"lastName",name:"lastName",value:A.lastName,onChange:x,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},required:!0,fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",label:"Pr\xe9nom",id:"firstName",name:"firstName",value:A.firstName,onChange:x,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},required:!0,fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",label:"Adresse 1",id:"adresse1",name:"adresse1",value:A.adresse1,onChange:x,variant:"outlined",validations:{minLength:6},validationErrors:{minLength:"La longueur minimale des caract\xe8res est de 6"},required:!0,fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",label:"Adresse 2",id:"adresse2",name:"adresse2",value:A.adresse2,onChange:x,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"La longueur minimale des caract\xe8res est de 6"},fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",label:"Code postal",id:"codepostal",type:"number",name:"codepostal",value:y.a.toString(A.codepostal),onChange:x,variant:"outlined",validations:{minLength:4,isNumeric:!0},validationErrors:{minLength:"Min character length is 4",isNumeric:"Numeric value required"},required:!0,fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",label:"T\xe9l\xe9phone",id:"phone",name:"phone",value:A.phone,onChange:x,variant:"outlined",validations:{minLength:10,isNumeric:!0},validationErrors:{minLength:"Min character length is 10",isNumeric:"Numeric value required"},required:!0,fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",label:"E-mail",id:"email",name:"email",value:A.email,onChange:x,variant:"outlined",validations:"isEmail",validationErrors:{isEmail:"This is not a valid email"},required:!0,fullWidth:!0})),"new"===t.type?l.a.createElement("div",null,l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",type:"password",name:"password",label:"Mot de passe",onChange:x,validations:{minLength:6},validationErrors:{minLength:"La longueur minimale des caract\xe8res est de 6"},InputProps:{endAdornment:l.a.createElement(ne.a,{position:"end"},l.a.createElement(u.a,{className:"text-20",color:"action"},"vpn_key"))},variant:"outlined",required:!0,fullWidth:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement(n.F,{className:"mb-24",id:"confirmpassword",type:"password",name:"confirmpassword",label:"Confirmer mot de passe",validations:"equalsField:password",onChange:x,validationErrors:{equalsField:"Passwords not identique"},InputProps:{endAdornment:l.a.createElement(ne.a,{position:"end"},l.a.createElement(u.a,{className:"text-20",color:"action"},"vpn_key"))},variant:"outlined",fullWidth:!0}))):"",l.a.createElement("div",{className:"flex"},l.a.createElement(me.a,{id:"villes",name:"villes",className:"MuiFormControl-fullWidth MuiTextField-root mb-24",value:A.villes,onChange:e=>(function(e,a){P(y.a.set({...A},a,e))})(e,"villes"),placeholder:"S\xe9lectionner multiple villes",textFieldProps:{label:"Villes",InputLabelProps:{shrink:!0},variant:"outlined"},options:v,fullWidth:!0,isMulti:!0,required:!0})),l.a.createElement("div",{className:"flex"},l.a.createElement("input",{accept:"image/*",id:"button-file",type:"file",onChange:function(e){const t=e.target.files[0];t&&a(function(e){return(a,t)=>{const r=new FormData;r.append("file",e);const l=b.a.post("/api/avatars",r,{headers:{"Content-Type":"multipart/form-data"}});return a({type:T}),l.then(e=>Promise.all([e,a({type:w,payload:e.data}),a(Object(N.B)({message:"Image uploaded!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))])).catch(e=>{a({type:D}),a(Object(N.B)({message:y.a.map(C.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(t))}}))),"new"===t.type?l.a.createElement(f.a,{className:"justify-between pl-16"},l.a.createElement(m.a,{variant:"contained",color:"primary",type:"submit",disabled:!M||s.loading||g},"Ajouter",s.loading&&l.a.createElement(re.a,{size:24}))):l.a.createElement(f.a,{className:"justify-between pl-16"},l.a.createElement(m.a,{variant:"contained",color:"primary",type:"submit",disabled:!M||s.loading||g},"Modifier",s.loading&&l.a.createElement(re.a,{size:24})),l.a.createElement(d.a,{onClick:()=>a(_({children:l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a,{id:"alert-dialog-title"},"Suppression"),l.a.createElement(E.a,null,l.a.createElement(h.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),l.a.createElement(f.a,null,l.a.createElement(m.a,{onClick:()=>a(U()),color:"primary"},"Non"),l.a.createElement(m.a,{onClick:z,color:"primary",autoFocus:!0},"Oui")))}))},l.a.createElement(u.a,null,"delete")))))},pe=t(43);const Ee={entities:null,loadingComl:!1,loading:!1,error:null,searchText:"",selectedZonesIds:[],routeParams:{},commercialsDialog:{type:"new",props:{open:!1},data:null},avatar:null,villes:null,imageReqInProgress:!1};var he=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case F:return{...e,loadingComl:!0};case k:return{...e,loading:!0};case j:return{...e,loading:!1,error:null};case O:return{...e,executed:!1,message:null,villes:y.a.keyBy(a.payload,"id")};case A:return{...e,loadingComl:!1,entities:a.payload};case x:return{...e,searchText:a.searchText};case M:return{...e,commercialsDialog:{type:"edit",props:{open:!0},data:a.data}};case L:return{...e,commercialsDialog:{type:"edit",props:{open:!1},data:null}};case T:return{...e,imageReqInProgress:!0};case w:return{...e,avatar:a.payload,imageReqInProgress:!1};case D:return{...e,imageReqInProgress:!1};case I:return{...e,error:a.payload,loading:!1};default:return e}};const fe={state:!1,options:{children:"Hi"}};var ve=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case N.f:return{...e,state:!0,options:{...e.options,...a.options}};case N.a:return{...e,state:!1};default:return e}};var ge=Object(pe.d)({commercials:he,dialog:ve});a.default=Object(s.a)("commercialsApp",ge)(function(e){const a=Object(i.b)(),t=Object(r.useRef)(null);return Object(r.useEffect)(()=>{a(W()),a(function(){const e=b.a.get("/api/villes");return a=>e.then(e=>{a({type:O,payload:e.data["hydra:member"]})})}())},[a]),l.a.createElement(l.a.Fragment,null,l.a.createElement(n.p,{classes:{contentWrapper:"p-0 sm:p-24 pb-80 sm:pb-80 h-full",content:"flex flex-col h-full",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:l.a.createElement($,{pageLayout:t}),content:l.a.createElement(J,null),sidebarInner:!0,ref:t,innerScroll:!0}),l.a.createElement(ue,null))})}}]);