(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{1051:function(e,t,a){"use strict";var n=a(3),r=a.n(n),i=a(4),c=a.n(i),o=a(0),s=a.n(o),l=(a(1),a(2)),u=a(7),p=a(98),d=s.a.forwardRef(function(e,t){var a=e.children,n=e.classes,i=e.className,o=e.disableTypography,u=void 0!==o&&o,d=c()(e,["children","classes","className","disableTypography"]);return s.a.createElement("div",r()({className:Object(l.a)(n.root,i),ref:t},d),u?a:s.a.createElement(p.a,{variant:"h6"},a))});t.a=Object(u.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(d)},1052:function(e,t,a){"use strict";var n=a(3),r=a.n(n),i=a(0),c=a.n(i),o=(a(1),a(7)),s=a(98),l=c.a.forwardRef(function(e,t){return c.a.createElement(s.a,r()({component:"p",variant:"body1",color:"textSecondary",ref:t},e))});t.a=Object(o.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(l)},1357:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(40),c=a(6),o=a(140),s=a(23),l=a(1029),u=a(1035),p=a(958),d=a(1051),m=a(1037),f=a(1052),g=a(1038),E=a(1013),h=a(347),b=a(8),O=a(54),v=a(107),y=a(36),A=a(10),S="[CATEGORIES APP] GET CATEGORIES",j="[CATEGORIES APP] GET SOUS_SECTEURS",C="[CATEGORIES APP] REQUEST CATEGORIES",T="[CATEGORIES APP] SET SEARCH TEXT",P="[CATEGORIES APP] OPEN NEW CATEGORIES DIALOG",x="[CATEGORIES APP] CLOSE NEW CATEGORIES DIALOG",I="[CATEGORIES APP] OPEN EDIT CATEGORIES DIALOG",N="[CATEGORIES APP] CLOSE EDIT CATEGORIES DIALOG",R="[CATEGORIES APP] ADD CATEGORIE",w="[CATEGORIES APP] SAVE ERROR",G="[CATEGORIES APP] UPDATE CATEGORIE",D="[CATEGORIES APP] REMOVE CATEGORIE",k="[CATEGORIES APP] SET PARAMETRES DATA";function L(e){var t="";e.search.length>0&&e.search.map(function(e,a){t+="&"+e.id+"="+e.value});var a=O.a.get("/api/categories?page=".concat(e.page).concat(t,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction,"&props[]=id&props[]=name&props[]=sousSecteurs"));return function(e){return e({type:C}),a.then(function(t){e({type:S,payload:t.data})})}}function F(e){return{type:k,parametres:e}}var W="[DIALOG] OPEN",z="[DIALOG] CLOSE";function M(){return{type:z}}var B=a(7);var H=function(e){var t=Object(c.b)(),a=Object(c.c)(function(e){return e.categoriesApp.categories.entities}),o=Object(c.c)(function(e){return e.categoriesApp.categories.pageCount}),b=Object(c.c)(function(e){return e.categoriesApp.categories.loading}),v=Object(c.c)(function(e){return e.categoriesApp.categories.parametres}),S=Object(c.c)(function(e){return e.categoriesApp.categories.searchText}),j=Object(n.useState)(null),T=Object(s.a)(j,2),P=T[0],x=T[1],N=Object(B.a)(function(e){return{tooltip:{maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9","& b":{fontWeight:e.typography.fontWeightMedium}}}})(l.a);if(Object(n.useEffect)(function(){a&&x(function(e,t){var a=Object.keys(e).map(function(t){return e[t]});return 0===t.length?a:i.y.filterArrayByString(a,t)}(a,S))},[a,S]),!P)return null;var R=A.a.debounce(function(e){return t(F(e))},700);return r.a.createElement(i.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(h.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:function(e,a,n){return{className:"cursor-pointer",onClick:function(e,n){var r;a&&t((r=a.original,{type:I,data:r}))}}},data:P,columns:[{Header:"Nom du produit",accessor:"name",filterable:!0},{Header:"Activit\xe9s",className:"font-bold",accessor:"sousSecteurs.name",filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},r.a.createElement(N,{title:r.a.createElement(r.a.Fragment,null,0===Object.keys(e.original.sousSecteurs).length?"Il n'y aucune activit\xe9":r.a.createElement("ul",null,A.a.map(e.original.sousSecteurs,function(e,t){return r.a.createElement("li",{key:t}," ",e.name," ")})))},r.a.createElement(u.a,{onClick:function(e){e.stopPropagation()}},Object.keys(e.original.sousSecteurs).length)))}},{Header:"",sortable:!1,width:64,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},r.a.createElement(p.a,{className:"text-red text-20",onClick:function(a){var n;a.stopPropagation(),t((n={children:r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{id:"alert-dialog-title"},"Suppression"),r.a.createElement(m.a,null,r.a.createElement(f.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),r.a.createElement(g.a,null,r.a.createElement(u.a,{onClick:function(){return t(M())},color:"primary"},"Non"),r.a.createElement(u.a,{onClick:function(a){t(function(e,t){var a={del:!0,name:e.name+"_deleted-"+e.id};return function(n){return n({type:C}),O.a.put("/api/categories/".concat(e.id),a).then(function(e){return Promise.all([n(Object(y.B)({message:"Cat\xe9gorie bien supprim\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return n(L(t))})}).catch(function(e){n({type:D}),e.response.data&&e.response.data["hydra:description"]&&n(Object(y.B)({message:e.response.data["hydra:description"],anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(e.original,v)),t(M())},color:"primary",autoFocus:!0},"Oui")))},{type:W,options:n}))}},r.a.createElement(E.a,null,"delete")))}}],manual:!0,pages:o,page:v.page-1,defaultPageSize:10,loading:b,showPageSizeOptions:!1,onPageChange:function(e){v.page=e+1,t(F(v))},onSortedChange:function(e,a,n){v.page=1,v.filter.id="sousSecteur"===e[0].id?"sousSecteur.id":e[0].id,v.filter.direction=e[0].desc?"desc":"asc",t(F(v))},onFilteredChange:function(e){v.page=1,v.search=e,R(v)},noDataText:"Aucun cat\xe9gorie trouv\xe9",loadingText:"Chargement...",ofText:"sur"}))},U=a(98);var V=function(e){var t=Object(c.b)();return r.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(i.d,{animation:"transition.expandIn",delay:300},r.a.createElement(E.a,{className:"text-32 mr-0 sm:mr-12"},"ballot")),r.a.createElement(i.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(U.a,{className:"hidden sm:flex",variant:"h6"},"Gestion des produits"))),r.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"}),r.a.createElement(i.d,{animation:"transition.slideRightIn",delay:300},r.a.createElement(u.a,{onClick:function(e){return t({type:P})},className:"whitespace-no-wrap",variant:"contained"},r.a.createElement("span",{className:"hidden sm:flex"},"Ajouter nouveau produit"),r.a.createElement("span",{className:"flex sm:hidden"},"New"))))},_=a(1031),q=a(1026),J=a(1036),Q=a(141),X=a(55),K=a.n(X),Y=a(350),Z={name:""};var $=function(e){var t=Object(c.b)(),a=Object(c.c)(function(e){return e.categoriesApp.categories.categorieDialog}),o=Object(c.c)(function(e){return e.categoriesApp.categories.sousSecteurs}),l=Object(c.c)(function(e){return e.categoriesApp.categories.parametres}),p=Object(Q.b)(Z),d=p.form,f=p.handleChange,h=p.setForm,S=Object(n.useState)(!1),j=Object(s.a)(S,2),C=j[0],T=j[1],P=Object(n.useRef)(null),I=Object(n.useCallback)(function(){if("edit"===a.type&&a.data&&(h(Object(b.a)({},a.data)),a.data.sousSecteurs)){var e=a.data.sousSecteurs.map(function(e){return{value:e["@id"],label:e.name}});h(A.a.set(Object(b.a)({},a.data),"sousSecteurs",e))}"new"===a.type&&h(Object(b.a)({},Z,a.data))},[a.data,a.type,h]);function D(){"edit"===a.type?t({type:N}):t({type:x})}return Object(n.useEffect)(function(){a.props.open&&I()},[a.props.open,I]),r.a.createElement(_.a,Object.assign({classes:{paper:"m-24"}},a.props,{onClose:D,fullWidth:!0,maxWidth:"xs"}),r.a.createElement(q.a,{position:"static",elevation:1},r.a.createElement(J.a,{className:"flex w-full"},r.a.createElement(U.a,{variant:"subtitle1",color:"inherit"},"new"===a.type?"Nouveau produit":"Editer produit"))),r.a.createElement(K.a,{onValidSubmit:function(e){"new"===a.type?t(function(e,t){var a=null;e.sousSecteurs&&(a=e.sousSecteurs.map(function(e){return e.value}));var n=Object(b.a)({},e,{sousSecteurs:a});return function(e){return O.a.post("/api/categories",n).then(function(a){return Promise.all([e({type:R}),e(Object(y.B)({message:"Cat\xe9gorie bien ajout\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return e(L(t))})}).catch(function(t){e({type:w}),e(Object(y.B)({message:A.a.map(v.a.parseApiErrors(t),function(e,t){return t+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(d,l)):t(function(e,t){var a=null;e.sousSecteurs&&(a=e.sousSecteurs.map(function(e){return e.value}));var n=Object(b.a)({},e,{sousSecteurs:a});return function(a){return O.a.put("/api/categories/".concat(e.id),n).then(function(e){return Promise.all([a({type:G}),a(Object(y.B)({message:"Cat\xe9gorie bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return a(L(t))})}).catch(function(e){a({type:w}),a(Object(y.B)({message:A.a.map(v.a.parseApiErrors(e),function(e,t){return t+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(d,l)),D()},onValid:function(){T(!0)},onInvalid:function(){T(!1)},ref:P,className:"flex flex-col overflow-hidden"},r.a.createElement(m.a,{classes:{root:"p-24"}},r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"min-w-48 pt-20"},r.a.createElement(E.a,{color:"action"},"work")),r.a.createElement(Y.a,{id:"sousSecteurs",name:"sousSecteurs",className:"MuiFormControl-fullWidth MuiTextField-root mb-24",value:d.sousSecteurs,onChange:function(e){return function(e,t){h(A.a.set(Object(b.a)({},d),t,e))}(e,"sousSecteurs")},placeholder:"S\xe9lectionner...",textFieldProps:{label:"Activit\xe9s",InputLabelProps:{shrink:!0},variant:"outlined"},options:o,fullWidth:!0,isMulti:!0,required:!0})),r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"min-w-48 pt-20"},r.a.createElement(E.a,{color:"action"},"ballot")),r.a.createElement(i.F,{className:"mb-24",label:"Nom",autoFocus:!0,id:"name",name:"name",value:d.name,onChange:f,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},required:!0,fullWidth:!0}))),"new"===a.type?r.a.createElement(g.a,{className:"justify-between pl-16"},r.a.createElement(u.a,{variant:"contained",color:"primary",type:"submit",disabled:!C},"Ajouter")):r.a.createElement(g.a,{className:"justify-between pl-16"},r.a.createElement(u.a,{variant:"contained",color:"primary",type:"submit",disabled:!C},"Modifier"))))},ee=a(46),te={entities:null,pageCount:null,searchText:"",parametres:{page:1,search:[],filter:{id:"id",direction:"desc"}},routeParams:{},categorieDialog:{type:"new",props:{open:!1},data:null},sousSecteurs:null,loading:!1,parents:null},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(b.a)({},e,{sousSecteurs:t.payload});case C:return Object(b.a)({},e,{loading:!0});case S:return Object(b.a)({},e,{entities:t.payload["hydra:member"],pageCount:v.a.hydraPageCount(t.payload),loading:!1});case D:return Object(b.a)({},e,{loading:!1});case T:return Object(b.a)({},e,{searchText:t.searchText});case k:return Object(b.a)({},e,{parametres:{page:t.parametres.page,search:t.parametres.search,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}});case P:return Object(b.a)({},e,{categorieDialog:{type:"new",props:{open:!0},data:null}});case x:return Object(b.a)({},e,{categorieDialog:{type:"new",props:{open:!1},data:null}});case I:return Object(b.a)({},e,{categorieDialog:{type:"edit",props:{open:!0},data:t.data}});case N:return Object(b.a)({},e,{categorieDialog:{type:"edit",props:{open:!1},data:null}});default:return e}},ne={state:!1,options:{children:"Hi"}},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.f:return Object(b.a)({},e,{state:!0,options:Object(b.a)({},e.options,t.options)});case y.a:return Object(b.a)({},e,{state:!1});default:return e}},ie=Object(ee.d)({categories:ae,dialog:re}),ce=a(346);t.default=Object(o.a)("categoriesApp",ie)(function(e){var t=Object(c.b)(),a=Object(n.useRef)(null),o=Object(c.c)(function(e){return e.categoriesApp.categories.parametres}),s=Object(c.c)(function(e){return e.categoriesApp.categories.sousSecteurs});return Object(n.useEffect)(function(){t(L(o))},[t,o]),Object(n.useEffect)(function(){s||t(function(){var e=O.a.get("/api/sous_secteurs?pagination=false&props[]=id&props[]=name");return function(t){return e.then(function(e){t({type:j,payload:e.data["hydra:member"]})})}}())},[t,s]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ce.Helmet,null,r.a.createElement("title",null,"Produits | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(i.p,{classes:{contentWrapper:"p-0 sm:p-24 pb-80 sm:pb-80 h-full",content:"flex flex-col h-full",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(V,{pageLayout:a}),content:r.a.createElement(H,null),sidebarInner:!0,ref:a,innerScroll:!0}),r.a.createElement($,null))})}}]);