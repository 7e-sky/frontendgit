(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{1280:function(e,t,a){"use strict";var n=a(50),r=a(59),i=a.n(r);const l="[DEMANDES FOURNISSEUR APP] REQUEST DEMANDES",o="[DEMANDES FOURNISSEUR APP] SET PARAMETRES DATA",c="[DEMANDES FOURNISSEUR APP] GET DEMANDES",s="[DEMANDES FOURNISSEUR APP] ERRORS",d="[DEMANDES FOURNISSEUR APP] ERROR_404",u="[DEMANDES FOURNISSEUR APP] SET DEMANDES SEARCH TEXT";function m(e,t){var a="";e.search.length>0&&e.search.map(function(e,n){e.value&&("created"===e.id||"dateExpiration"===e.id?a+="&"+e.id+"[after]="+e.value:"statut"===e.id?"1"===e.value?a+="&statut=1&dateExpiration[strictly_after]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss")):"3"===e.value?a+="&statut=3}":"4"===e.value&&(a+="&dateExpiration[strictly_before]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss"))):"historiques"===e.id?"1"===e.value?a+="&historiques.fournisseur.id=".concat(t):"2"===e.value&&(a+="&historiques.fournisseur=".concat(t)):a+="&"+e.id+"="+e.value)});const r=n.a.get("/api/demande_achats/fournisseur?page=".concat(e.page).concat(a,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction));return e=>(e({type:l}),r.then(t=>e({type:c,payload:t.data})).catch(t=>{404===t.response.status&&e({type:d}),e({type:s})}))}function p(e){return{type:o,parametres:e}}var f=a(33),E=a(98),g=a(200),h=a(10);const v="[DEMANDE FOURNISSEUR APP] REQUEST_VISITE_DEMANDE",b="[DEMANDE FOURNISSEUR APP] REQUEST_ADD_PRODUIT",D="[DEMANDE FOURNISSEUR APP] PRODUITS_ADDED",y="[DEMANDE FOURNISSEUR APP] GET_VISITE_DEMANDE",S="[DEMANDE FOURNISSEUR APP] REQUEST DEMANDE",A="[DEMANDE FOURNISSEUR APP] GET DEMANDE",N="[DEMANDE FOURNISSEUR APP] GET PRODUITS FRS",R="[DEMANDE FOURNISSEUR APP] SAVE ERROR",x="[DEMANDE FOURNISSEUR APP] CLEAN_UP";function O(){return e=>e({type:x})}function P(e){const t=n.a.get("/api/demande_achats/".concat(e,"/fournisseur"));return e=>(e({type:S}),t.then(t=>(e(g.b("demandes_prix")),e({type:A,payload:t.data}))))}function U(e,t,a){let r={categories:[...h.a.map(t,function(e,t){return e["@id"]}),e]};const i=n.a.put("/api/fournisseurs/".concat(a),r);return e=>(e({type:b}),i.then(t=>(e(M(a)),e(Object(f.B)({message:"Bien ajout\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"})))))}function M(e){const t=n.a.get("/api/fournisseurs/".concat(e,"/categories"));return e=>t.then(t=>{e({type:N,payload:t.data["hydra:member"]})})}function T(e,t){const a=n.a.get("/api/detail_visites?fournisseur=".concat(e,"&demande=").concat(t));return e=>(e({type:v}),a.then(t=>{e({type:y,payload:t.data["hydra:member"][0]})}))}function j(e,t){let a={budget:parseFloat(0),demande:"/api/demande_achats/"+t.id};const r=n.a.post("/api/detail_visites",a);return e=>(e({type:v}),r.then(t=>{e({type:y,payload:t.data}),e(Object(E.i)())}).catch(t=>{e({type:R}),e(Object(f.B)({message:"Cette soci\xe9t\xe9 vous a blacklist\xe9, merci de nous contacter sur cette adresse mediateur@lesachatsindustriels.com pour plus de d\xe9tails",autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))}))}const I="[DIALOG] OPEN",C="[DIALOG] CLOSE";function F(){return{type:C}}function w(e){return{type:I,options:e}}a.d(t,"k",function(){return l}),a.d(t,"o",function(){return o}),a.d(t,"e",function(){return c}),a.d(t,"b",function(){return s}),a.d(t,"c",function(){return d}),a.d(t,"n",function(){return u}),a.d(t,"u",function(){return m}),a.d(t,"y",function(){return p}),a.d(t,"l",function(){return v}),a.d(t,"i",function(){return b}),a.d(t,"h",function(){return D}),a.d(t,"g",function(){return y}),a.d(t,"j",function(){return S}),a.d(t,"d",function(){return A}),a.d(t,"f",function(){return N}),a.d(t,"m",function(){return R}),a.d(t,"a",function(){return x}),a.d(t,"r",function(){return O}),a.d(t,"t",function(){return P}),a.d(t,"p",function(){return U}),a.d(t,"v",function(){return M}),a.d(t,"w",function(){return T}),a.d(t,"q",function(){return j}),a.d(t,"s",function(){return F}),a.d(t,"x",function(){return w})},1344:function(e,t,a){"use strict";var n=a(43),r=a(1280),i=a(102);const l={data:[],pageCount:null,loading:!1,error:!0,searchText:"",parametres:{page:1,search:[],description:"",filter:{id:"created",direction:"desc"}}};var o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.k:return{...e,loading:!0,error:!1};case r.c:return{...e,loading:!1,error:!0};case r.b:return{...e,loading:!1};case r.e:return{...e,data:t.payload["hydra:member"],pageCount:i.a.hydraPageCount(t.payload),loading:!1};case r.n:return{...e,searchText:t.searchText};case r.o:return{...e,parametres:{page:t.parametres.page,search:t.parametres.search,description:t.parametres.description,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}};default:return e}};const c={data:null,error:null,loading:!1,attachement:null,visit:null,produits:null,requestAddProduit:!1};var s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.j:case r.l:return{...e,loading:!0};case r.i:case r.h:return{...e,requestAddProduit:!0};case r.a:return{...e,data:null,visit:null,loading:!1,attachement:null,error:null,produits:null};case r.f:return{...e,produits:t.payload};case r.d:return{...e,data:t.payload,loading:!1};case r.g:return{...e,visit:t.payload,loading:!1};case r.m:return{...e,error:t.payload,loading:!1};default:return e}},d=a(33);const u={state:!1,options:{children:"Hi"}};var m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.f:return{...e,state:!0,options:{...e.options,...t.options}};case d.a:return{...e,state:!1};default:return e}};const p=Object(n.d)({demandes:o,demande:s,dialog:m});t.a=p},1577:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(39),l=a(136),o=a(89),c=a(1227),s=a(1151),d=a(1231),u=a(1221),m=a(1204),p=a(1160),f=a(1140),E=a(71),g=a(1280),h=a(7),v=a(59),b=a.n(v),D=a(102),y=a(365),S=a(1226),A=a(10),N=a(16);const R=Object(S.a)(e=>({root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chip:{marginLeft:e.spacing(1),padding:2,background:"#ef5350",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chip2:{marginLeft:e.spacing(1),padding:2,background:"#4caf50",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chipOrange:{marginLeft:e.spacing(1),padding:2,background:"#ff9800",color:"white",fontWeight:"bold",fontSize:"11px",height:20}}));var x=Object(E.g)(function(e){const t=R(),a=Object(h.b)(),l=Object(h.c)(e=>{let{demandesApp:t}=e;return t.demandes.data}),E=Object(h.c)(e=>{let{demandesApp:t}=e;return t.demandes.error}),v=Object(h.c)(e=>{let{demandesApp:t}=e;return t.demandes.loading}),S=Object(h.c)(e=>{let{demandesApp:t}=e;return t.demandes.pageCount}),x=Object(h.c)(e=>{let{demandesApp:t}=e;return t.demandes.parametres}),O=Object(h.c)(e=>{let{auth:t}=e;return t.user}),P=Object(h.c)(e=>{let{demandesApp:t}=e;return t.demandes.searchText}),[U,M]=Object(n.useState)(null);if(Object(n.useEffect)(()=>{l&&M(function(e,t){const a=Object.keys(e).map(t=>e[t]);return 0===t.length?a:D.a.filterArrayByString(a,t)}(l,P))},[l,P]),!U)return null;if(E)return r.a.createElement("div",{className:"flex flex-col items-center justify-center h-full"},r.a.createElement(o.a,{color:"textSecondary",className:"mb-16",variant:"h6"},"Pour recever et consulter les demandes de devis qui vous int\xe9resse, vous devez choisir les produits dans lesquelles vous \xeates actif."),r.a.createElement(c.a,{component:N.a,to:"/user/profile/1",color:"secondary",variant:"contained"},"Modifier votre profile"));const T=A.a.debounce(e=>a(g.y(e)),1e3);return r.a.createElement(i.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(y.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTheadProps:(e,t,a)=>({className:"h-64 font-bold"}),data:U,columns:[{Header:"R\xe9f\xe9rence",className:"font-bold",filterable:!0,accessor:"reference",Cell:e=>e.original.reference?"RFQ-"+e.original.reference:"En attente",Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement(s.a,{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:"",InputProps:{startAdornment:r.a.createElement(d.a,{position:"start"},"RFQ-")}})}},{Header:"Visibilit\xe9",accessor:"historiques",width:64,filterable:!1,Cell:e=>e.original.historiques.length>0&&A.a.findKey(e.original.historiques,function(e){return e.fournisseur.id===O.id})?r.a.createElement(u.a,{title:"Lu"},r.a.createElement(m.a,{className:"text-green text-20"},"remove_red_eye")):r.a.createElement(u.a,{title:"Non lu"},r.a.createElement(m.a,{className:"text-orange text-20"},"remove_red_eye"))},{Header:"Titre",accessor:"titre",filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},A.a.capitalize(A.a.truncate(e.original.titre,{length:25,separator:" "})))},{Header:"Budget",accessor:"budget",filterable:!0,Cell:e=>r.a.createElement(r.a.Fragment,null,parseFloat(e.original.budget).toLocaleString("fr",{minimumFractionDigits:2}),"\u2002",e.original.currency?e.original.currency.name:"")},{Header:"Produits",accessor:"categories.name",filterable:!0,Cell:e=>A.a.truncate(A.a.join(A.a.map(e.original.categories,"name"),", "),{length:25,separator:" "})},{Header:"Date de cr\xe9ation",accessor:"created",filterable:!0,Cell:e=>b()(e.original.created).format("DD/MM/YYYY"),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement(s.a,{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"\xc9ch\xe9ance",minWidth:125,accessor:"dateExpiration",filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},b()(e.original.dateExpiration).format("DD/MM/YYYY"),b()(e.original.dateExpiration)>=b()()?r.a.createElement(p.a,{className:t.chip2,label:0===b()(e.original.dateExpiration).diff(b()(),"days")?b()(e.original.dateExpiration).diff(b()(),"hours")+" h":b()(e.original.dateExpiration).diff(b()(),"days")+" j"}):r.a.createElement(p.a,{className:t.chip,label:0===b()(e.original.dateExpiration).diff(b()(),"days")?b()(e.original.dateExpiration).diff(b()(),"hours")+" h":b()(e.original.dateExpiration).diff(b()(),"days")+" j"})),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement(s.a,{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"Statut",accessor:"statut",sortable:!1,filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},3===e.original.statut?r.a.createElement(p.a,{className:t.chip2,label:"Adjug\xe9e"}):b()(e.original.dateExpiration)>=b()()?0===e.original.statut?r.a.createElement(p.a,{className:t.chipOrange,label:"En attente"}):1===e.original.statut?r.a.createElement(p.a,{className:t.chip2,label:"En cours"}):r.a.createElement(p.a,{className:t.chip,label:"Refus\xe9e"}):r.a.createElement(p.a,{className:t.chip,label:"Expir\xe9e"})),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement("select",{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"1"},"En cours"),r.a.createElement("option",{value:"3"},"Adug\xe9e"),r.a.createElement("option",{value:"4"},"Expir\xe9e"))}},{Header:"",Cell:t=>r.a.createElement("div",{className:"flex items-center"},r.a.createElement(u.a,{title:"D\xe9tails"},r.a.createElement(f.a,{className:"text-teal text-20",onClick:()=>e.history.push("/demandes_prix/"+t.original.id)},r.a.createElement(m.a,null,"remove_red_eye"))))}],manual:!0,defaultSortDesc:!0,pages:S,page:x.page-1,defaultPageSize:10,loading:v,showPageSizeOptions:!1,onPageChange:e=>{x.page=e+1,a(g.y(x))},onSortedChange:(e,t,n)=>{x.page=1,x.filter.id=e[0].id,x.filter.direction=e[0].desc?"desc":"asc",a(g.y(x))},onFilteredChange:e=>{x.page=1,x.search=e,T(x)},noDataText:"Aucune demande d'achat trouv\xe9e",loadingText:"Chargement...",ofText:"sur"}))});var O=function(e){return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(i.d,{animation:"transition.expandIn",delay:300},r.a.createElement(m.a,{className:"text-32 mr-0 sm:mr-12"},"inbox")),r.a.createElement(i.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(o.a,{className:"hidden sm:flex",variant:"h6"},"Les demandes de prix"))))},P=a(1344),U=a(364);t.default=Object(l.a)("demandesApp",P.a)(function(){const e=Object(h.b)(),t=Object(h.c)(e=>{let{demandesApp:t}=e;return t.demandes.parametres}),a=Object(h.c)(e=>{let{auth:t}=e;return t.user});return Object(n.useEffect)(()=>{e(g.u(t,a.id))},[e,t,a.id]),r.a.createElement(r.a.Fragment,null,r.a.createElement(U.Helmet,null,r.a.createElement("title",null,"RFQs | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(i.o,{classes:{content:"flex flex-col h-full",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(O,null),content:r.a.createElement(x,null),innerScroll:!0}))})}}]);