(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{1087:function(e,t,n){"use strict";var a=n(54),r="[COMMANDES APP] REQUEST COMMANDESAB",c="[COMMANDES APP] SET PARAMETRES DATA",o="[COMMANDES APP] GET COMMANDESAB",i="[COMMANDES APP] SET COMMANDES SEARCH TEXT",u="[COMMANDES APP] CLEAN_UP";function l(){return function(e){return e({type:u})}}function s(e){var t="";e.search.length>0&&e.search.map(function(e){return e.value&&("created"===e.id?t+="&"+e.id+"[after]="+e.value:t+="&"+e.id+"="+e.value)});var n=a.a.get("/api/demande_abonnements?page=".concat(e.page).concat(t,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction));return function(e){return e({type:r}),n.then(function(t){return e({type:o,payload:t.data})})}}function d(e){return{type:c,parametres:e}}var f=n(36),m=n(10),p=n(196),g="[COMMANDE APP] REQUEST COMMANDE",E="[COMMANDE APP] GET COMMANDE",h="[COMMANDE APP] REQUEST_SOUS_SECTEURS",b="[COMMANDE APP] GET SOUS_SECTEURS",O="[COMMANDE APP] REQUEST SECTEURS",A="[COMMANDE APP] GET SECTEURS",v="[COMMANDE APP] REQUEST OFFRES",S="[COMMANDE APP] GET OFFRES",y="[COMMANDE APP] REQUEST SAVE",C="[COMMANDE APP] SAVE COMMANDE",M="[COMMANDE APP] GET_PAIEMENT",N="[COMMANDE APP] GET_DUREE";function P(){var e=a.a.get("/api/durees");return function(t){return e.then(function(e){t({type:N,payload:e.data["hydra:member"]})})}}function j(e,t,n,r,c,o,i){e.offre=n["@id"],e.sousSecteurs=m.a.map(t,function(e,t){return e.value}),e.mode=r,e.duree=c["@id"],e.paiement=i,e.remise=o;var u=a.a.put(e["@id"],e);return function(e){return e({type:y}),u.then(function(t){return e(Object(f.B)({message:"Commande modifi\xe9e avec succ\xe8s"})),e(p.b("commandes-abonnements")),e(p.b("abonnement-fournisseur")),e({type:C,payload:t.data})})}}function T(e){var t=a.a.get("".concat(e,"/sous_secteurs?pagination=false&props[]=id&props[]=name"));return function(e){return e({type:h}),t.then(function(t){e({type:b,payload:t.data["hydra:member"]})})}}function D(){var e=a.a.get("/api/secteurs?pagination=false&props[]=id&props[]=name&order[name]=asc");return function(t){return t({type:O}),e.then(function(e){t({type:A,payload:e.data["hydra:member"]})})}}function x(){var e=a.a.get("/api/paiements");return function(t){return e.then(function(e){t({type:M,payload:e.data["hydra:member"]})})}}function w(){var e=a.a.get("/api/offres");return function(t){return t({type:v}),e.then(function(e){return t({type:S,payload:e.data["hydra:member"]})})}}function R(e){var t=a.a.get("/api/demande_abonnements/".concat(e));return function(e){return e({type:g}),t.then(function(t){return e({type:E,payload:t.data})})}}n.d(t,"j",function(){return r}),n.d(t,"r",function(){return c}),n.d(t,"c",function(){return o}),n.d(t,"q",function(){return i}),n.d(t,"a",function(){return u}),n.d(t,"s",function(){return l}),n.d(t,"u",function(){return s}),n.d(t,"A",function(){return d}),n.d(t,"i",function(){return g}),n.d(t,"b",function(){return E}),n.d(t,"n",function(){return h}),n.d(t,"h",function(){return b}),n.d(t,"m",function(){return O}),n.d(t,"g",function(){return A}),n.d(t,"k",function(){return v}),n.d(t,"e",function(){return S}),n.d(t,"l",function(){return y}),n.d(t,"o",function(){return C}),n.d(t,"p",function(){return"[COMMANDE APP] SAVE ERROR"}),n.d(t,"f",function(){return M}),n.d(t,"a",function(){}),n.d(t,"d",function(){return N}),n.d(t,"s",function(){}),n.d(t,"v",function(){return P}),n.d(t,"B",function(){return j}),n.d(t,"z",function(){return T}),n.d(t,"y",function(){return D}),n.d(t,"x",function(){return x}),n.d(t,"w",function(){return w}),n.d(t,"t",function(){return R})},1159:function(e,t,n){"use strict";var a=n(46),r=n(8),c=n(1087),o=n(107),i={data:[],pageCount:null,loading:!1,searchText:"",parametres:{page:1,search:[],filter:{id:"created",direction:"desc"}}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.a:return Object(r.a)({},i);case c.j:return Object(r.a)({},e,{loading:!0});case c.c:return Object(r.a)({},e,{data:t.payload["hydra:member"],pageCount:o.a.hydraPageCount(t.payload),loading:!1});case c.q:return Object(r.a)({},e,{searchText:t.searchText});case c.r:return Object(r.a)({},e,{parametres:{page:t.parametres.page,search:t.parametres.search,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}});default:return e}},l={data:null,offres:null,loadingSecteurs:!1,secteurs:null,sousSecteurs:null,error:null,loading:!1,loadingSS:!1,success:!1,paiements:null,durees:null},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case c.i:case c.k:case c.l:return Object(r.a)({},e,{loading:!0});case c.m:return Object(r.a)({},e,{loadingSecteurs:!0});case c.g:return Object(r.a)({},e,{secteurs:t.payload,loadingSecteurs:!1});case c.n:return Object(r.a)({},e,{loadingSS:!0});case c.h:return Object(r.a)({},e,{sousSecteurs:t.payload,loadingSS:!1});case c.f:return Object(r.a)({},e,{paiements:t.payload});case c.d:return Object(r.a)({},e,{durees:t.payload});case c.o:return Object(r.a)({},e,{loading:!1,success:!0});case c.a:return Object(r.a)({},e,{data:null,loading:!1,success:!1,error:null,offres:null,sousSecteurs:null});case c.b:return Object(r.a)({},e,{data:t.payload,loading:!1});case c.e:return Object(r.a)({},e,{offres:t.payload,loading:!1});case c.p:return Object(r.a)({},e,{error:t.payload,loading:!1});default:return e}},d=n(36),f={state:!1,options:{children:"Hi"}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.f:return Object(r.a)({},e,{state:!0,options:Object(r.a)({},e.options,t.options)});case d.a:return Object(r.a)({},e,{state:!1});default:return e}},p=Object(a.d)({commandes:u,commande:s,dialog:m});t.a=p},1405:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(40),o=n(140),i=n(23),u=n(967),l=n(974),s=n(1029),d=n(958),f=n(1013),m=n(78),p=n(1087),g=n(6),E=n(64),h=n.n(E),b=n(107),O=n(347),A=n(1034),v=n(10),S=Object(A.a)(function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chip:{marginLeft:e.spacing(1),padding:2,background:"#ef5350",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chip2:{marginLeft:e.spacing(1),padding:2,background:"#4caf50",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chipOrange:{marginLeft:e.spacing(1),padding:2,background:"#ff9800",color:"white",fontWeight:"bold",fontSize:"11px",height:20},blue:{marginLeft:e.spacing(1),padding:2,background:"#3490dc",color:"white",fontWeight:"bold",fontSize:"11px",height:20}}});var y=Object(m.g)(function(e){var t=S(),n=Object(g.b)(),o=Object(g.c)(function(e){return e.commandeOffreAdminApp.commandes.data}),m=Object(g.c)(function(e){return e.commandeOffreAdminApp.commandes.loading}),E=Object(g.c)(function(e){return e.commandeOffreAdminApp.commandes.pageCount}),A=Object(g.c)(function(e){return e.commandeOffreAdminApp.commandes.parametres}),y=Object(g.c)(function(e){return e.commandeOffreAdminApp.commandes.searchText}),C=Object(a.useState)(null),M=Object(i.a)(C,2),N=M[0],P=M[1];if(Object(a.useEffect)(function(){o&&P(function(e,t){var n=Object.keys(e).map(function(t){return e[t]});return 0===t.length?n:b.a.filterArrayByString(n,t)}(o,y))},[o,y]),!N)return null;var j=v.a.debounce(function(e){return n(p.A(e))},1e3);return r.a.createElement(c.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(O.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:function(e,t,n){return{className:"h-64"}},getTheadProps:function(e,t,n){return{className:"h-64 font-bold"}},data:N,columns:[{Header:"R\xe9f\xe9rence",className:"font-bold",accessor:"reference",filterable:!0,Cell:function(e){return e.original.reference}},{Header:"Offre",className:"font-bold",accessor:"offre.name",filterable:!0,Cell:function(e){return e.original.offre?e.original.offre.name:""}},{Header:"Fournisseur",className:"font-bold",accessor:"fournisseur.societe",filterable:!0,Cell:function(e){return e.original.fournisseur?e.original.fournisseur.societe:""}},{Header:"Mode de paiement",accessor:"mode.name",filterable:!0,Cell:function(e){return e.original.mode?e.original.mode.name:""}},{Header:"Activit\xe9s",accessor:"sousSecteurs.name",filterable:!0,Cell:function(e){return v.a.truncate(v.a.join(v.a.map(e.original.sousSecteurs,"name"),", "),{length:25,separator:" "})}},{Header:"Date de cr\xe9ation",accessor:"created",filterable:!0,Cell:function(e){return h()(e.original.created).format("DD/MM/YYYY HH:mm")},Filter:function(e){var t=e.filter,n=e.onChange;return r.a.createElement(u.a,{onChange:function(e){return n(e.target.value)},style:{width:"100%"},value:t?t.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"Statut",accessor:"statut",sortable:!1,filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},!1===e.original.statut?r.a.createElement(l.a,{className:t.chipOrange,label:"En attente"}):r.a.createElement(l.a,{className:t.chip2,label:"Trait\xe9e"}))},Filter:function(e){var t=e.filter,n=e.onChange;return r.a.createElement("select",{onChange:function(e){return n(e.target.value)},style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"true"},"Trait\xe9e"),r.a.createElement("option",{value:"false"},"En attente"))}},{Header:"",sortable:!1,accessor:"type",filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},!1===e.original.type?r.a.createElement(l.a,{className:t.blue,label:"Nouvelle"}):r.a.createElement(l.a,{className:t.chip2,label:"Renouvellement"}))},Filter:function(e){var t=e.filter,n=e.onChange;return r.a.createElement("select",{onChange:function(e){return n(e.target.value)},style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"false"},"Nouvelle"),r.a.createElement("option",{value:"true"},"Renouvellement"))}},{Header:"",Cell:function(t){return r.a.createElement("div",{className:"flex items-center"},!1===t.original.statut?r.a.createElement(s.a,{title:"Traiter"},r.a.createElement(d.a,{className:"text-blue text-20",onClick:function(){return e.history.push("/admin/offres/commande/"+t.original.id)}},r.a.createElement(f.a,null,"send"))):r.a.createElement(s.a,{title:"D\xe9j\xe0 trait\xe9e"},r.a.createElement(d.a,{className:"text-grey text-20"},r.a.createElement(f.a,null,"send"))))}}],manual:!0,pages:E,page:A.page-1,defaultPageSize:10,loading:m,showPageSizeOptions:!1,onPageChange:function(e){A.page=e+1,n(p.A(A))},onSortedChange:function(e,t,a){A.page=1,A.filter.id=e[0].id,A.filter.direction=e[0].desc?"desc":"asc",n(p.A(A))},onFilteredChange:function(e){A.page=1,A.search=e,j(A)},noDataText:"Aucune commande trouv\xe9e",loadingText:"Chargement...",ofText:"sur"}))}),C=n(98);var M=function(e){return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(c.d,{animation:"transition.expandIn",delay:300},r.a.createElement(f.a,{className:"text-32 mr-0 sm:mr-12"},"inbox")),r.a.createElement(c.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(C.a,{className:"hidden sm:flex",variant:"h6"},"Commandes d'abonnement"))))},N=n(1159),P=n(346);t.default=Object(o.a)("commandeOffreAdminApp",N.a)(function(){var e=Object(g.b)(),t=Object(g.c)(function(e){return e.commandeOffreAdminApp.commandes.parametres});return Object(a.useEffect)(function(){e(p.u(t))},[e,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(P.Helmet,null,r.a.createElement("title",null,"Commande abonnement | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(c.o,{classes:{content:"flex flex-col h-full",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(M,null),content:r.a.createElement(y,null),innerScroll:!0}))})}}]);