(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{1283:function(e,t,a){"use strict";var n=a(50);const r="[COMMANDES APP] REQUEST COMMANDESAB",o="[COMMANDES APP] SET PARAMETRES DATA",l="[COMMANDES APP] GET COMMANDESAB",c="[COMMANDES APP] SET COMMANDES SEARCH TEXT",i="[COMMANDES APP] CLEAN_UP";function s(){return e=>e({type:i})}function u(e){var t="";e.search.length>0&&e.search.map(e=>e.value&&("created"===e.id?t+="&"+e.id+"[after]="+e.value:t+="&"+e.id+"="+e.value));const a=n.a.get("/api/demande_abonnements?page=".concat(e.page).concat(t,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction));return e=>(e({type:r}),a.then(t=>e({type:l,payload:t.data})))}function d(e){return{type:o,parametres:e}}var m=a(33),f=a(10),p=a(200);const g="[COMMANDE APP] REQUEST COMMANDE",E="[COMMANDE APP] GET COMMANDE",h="[COMMANDE APP] REQUEST_SOUS_SECTEURS",A="[COMMANDE APP] GET SOUS_SECTEURS",b="[COMMANDE APP] REQUEST SECTEURS",S="[COMMANDE APP] GET SECTEURS",y="[COMMANDE APP] REQUEST OFFRES",C="[COMMANDE APP] GET OFFRES",O="[COMMANDE APP] REQUEST SAVE",M="[COMMANDE APP] SAVE COMMANDE",v="[COMMANDE APP] GET_PAIEMENT",N="[COMMANDE APP] GET_DUREE";function P(){const e=n.a.get("/api/durees");return t=>e.then(e=>{t({type:N,payload:e.data["hydra:member"]})})}function T(e,t,a,r,o,l,c){e.offre=a["@id"],e.sousSecteurs=f.a.map(t,function(e,t){return e.value}),e.mode=r,e.duree=o["@id"],e.paiement=c,e.remise=l;const i=n.a.put(e["@id"],e);return e=>(e({type:O}),i.then(t=>(e(Object(m.B)({message:"Commande modifi\xe9e avec succ\xe8s"})),e(p.b("commandes-abonnements")),e(p.b("abonnement-fournisseur")),e({type:M,payload:t.data}))))}function D(e){const t=n.a.get("".concat(e,"/sous_secteurs?pagination=false&props[]=id&props[]=name"));return e=>(e({type:h}),t.then(t=>{e({type:A,payload:t.data["hydra:member"]})}))}function x(){const e=n.a.get("/api/secteurs?pagination=false&props[]=id&props[]=name&order[name]=asc");return t=>(t({type:b}),e.then(e=>{t({type:S,payload:e.data["hydra:member"]})}))}function w(){const e=n.a.get("/api/paiements");return t=>e.then(e=>{t({type:v,payload:e.data["hydra:member"]})})}function j(){const e=n.a.get("/api/offres");return t=>(t({type:y}),e.then(e=>t({type:C,payload:e.data["hydra:member"]})))}function R(e){const t=n.a.get("/api/demande_abonnements/".concat(e));return e=>(e({type:g}),t.then(t=>e({type:E,payload:t.data})))}a.d(t,"j",function(){return r}),a.d(t,"r",function(){return o}),a.d(t,"c",function(){return l}),a.d(t,"q",function(){return c}),a.d(t,"a",function(){return i}),a.d(t,"s",function(){return s}),a.d(t,"u",function(){return u}),a.d(t,"A",function(){return d}),a.d(t,"i",function(){return g}),a.d(t,"b",function(){return E}),a.d(t,"n",function(){return h}),a.d(t,"h",function(){return A}),a.d(t,"m",function(){return b}),a.d(t,"g",function(){return S}),a.d(t,"k",function(){return y}),a.d(t,"e",function(){return C}),a.d(t,"l",function(){return O}),a.d(t,"o",function(){return M}),a.d(t,"p",function(){return"[COMMANDE APP] SAVE ERROR"}),a.d(t,"f",function(){return v}),a.d(t,"a",function(){}),a.d(t,"d",function(){return N}),a.d(t,"s",function(){}),a.d(t,"v",function(){return P}),a.d(t,"B",function(){return T}),a.d(t,"z",function(){return D}),a.d(t,"y",function(){return x}),a.d(t,"x",function(){return w}),a.d(t,"w",function(){return j}),a.d(t,"t",function(){return R})},1348:function(e,t,a){"use strict";var n=a(43),r=a(1283),o=a(102);const l={data:[],pageCount:null,loading:!1,searchText:"",parametres:{page:1,search:[],filter:{id:"created",direction:"desc"}}};var c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.a:return{...l};case r.j:return{...e,loading:!0};case r.c:return{...e,data:t.payload["hydra:member"],pageCount:o.a.hydraPageCount(t.payload),loading:!1};case r.q:return{...e,searchText:t.searchText};case r.r:return{...e,parametres:{page:t.parametres.page,search:t.parametres.search,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}};default:return e}};const i={data:null,offres:null,loadingSecteurs:!1,secteurs:null,sousSecteurs:null,error:null,loading:!1,loadingSS:!1,success:!1,paiements:null,durees:null};var s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.i:case r.k:case r.l:return{...e,loading:!0};case r.m:return{...e,loadingSecteurs:!0};case r.g:return{...e,secteurs:t.payload,loadingSecteurs:!1};case r.n:return{...e,loadingSS:!0};case r.h:return{...e,sousSecteurs:t.payload,loadingSS:!1};case r.f:return{...e,paiements:t.payload};case r.d:return{...e,durees:t.payload};case r.o:return{...e,loading:!1,success:!0};case r.a:return{...e,data:null,loading:!1,success:!1,error:null,offres:null,sousSecteurs:null};case r.b:return{...e,data:t.payload,loading:!1};case r.e:return{...e,offres:t.payload,loading:!1};case r.p:return{...e,error:t.payload,loading:!1};default:return e}},u=a(33);const d={state:!1,options:{children:"Hi"}};var m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.f:return{...e,state:!0,options:{...e.options,...t.options}};case u.a:return{...e,state:!1};default:return e}};const f=Object(n.d)({commandes:c,commande:s,dialog:m});t.a=f},1589:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(39),l=a(136),c=a(1151),i=a(1160),s=a(1221),u=a(1140),d=a(1204),m=a(71),f=a(1283),p=a(7),g=a(59),E=a.n(g),h=a(102),A=a(365),b=a(1226),S=a(10);const y=Object(b.a)(e=>({root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chip:{marginLeft:e.spacing(1),padding:2,background:"#ef5350",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chip2:{marginLeft:e.spacing(1),padding:2,background:"#4caf50",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chipOrange:{marginLeft:e.spacing(1),padding:2,background:"#ff9800",color:"white",fontWeight:"bold",fontSize:"11px",height:20},blue:{marginLeft:e.spacing(1),padding:2,background:"#3490dc",color:"white",fontWeight:"bold",fontSize:"11px",height:20}}));var C=Object(m.g)(function(e){const t=y(),a=Object(p.b)(),l=Object(p.c)(e=>{let{commandeOffreAdminApp:t}=e;return t.commandes.data}),m=Object(p.c)(e=>{let{commandeOffreAdminApp:t}=e;return t.commandes.loading}),g=Object(p.c)(e=>{let{commandeOffreAdminApp:t}=e;return t.commandes.pageCount}),b=Object(p.c)(e=>{let{commandeOffreAdminApp:t}=e;return t.commandes.parametres}),C=Object(p.c)(e=>{let{commandeOffreAdminApp:t}=e;return t.commandes.searchText}),[O,M]=Object(n.useState)(null);if(Object(n.useEffect)(()=>{l&&M(function(e,t){const a=Object.keys(e).map(t=>e[t]);return 0===t.length?a:h.a.filterArrayByString(a,t)}(l,C))},[l,C]),!O)return null;const v=S.a.debounce(e=>a(f.A(e)),1e3);return r.a.createElement(o.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(A.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:(e,t,a)=>({className:"h-64"}),getTheadProps:(e,t,a)=>({className:"h-64 font-bold"}),data:O,columns:[{Header:"R\xe9f\xe9rence",className:"font-bold",accessor:"reference",filterable:!0,Cell:e=>e.original.reference},{Header:"Offre",className:"font-bold",accessor:"offre.name",filterable:!0,Cell:e=>e.original.offre?e.original.offre.name:""},{Header:"Fournisseur",className:"font-bold",accessor:"fournisseur.societe",filterable:!0,Cell:e=>e.original.fournisseur?e.original.fournisseur.societe:""},{Header:"Mode de paiement",accessor:"mode.name",filterable:!0,Cell:e=>e.original.mode?e.original.mode.name:""},{Header:"Activit\xe9s",accessor:"sousSecteurs.name",filterable:!0,Cell:e=>S.a.truncate(S.a.join(S.a.map(e.original.sousSecteurs,"name"),", "),{length:25,separator:" "})},{Header:"Date de cr\xe9ation",accessor:"created",filterable:!0,Cell:e=>E()(e.original.created).format("DD/MM/YYYY HH:mm"),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement(c.a,{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"Statut",accessor:"statut",sortable:!1,filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},!1===e.original.statut?r.a.createElement(i.a,{className:t.chipOrange,label:"En attente"}):r.a.createElement(i.a,{className:t.chip2,label:"Trait\xe9e"})),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement("select",{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"true"},"Trait\xe9e"),r.a.createElement("option",{value:"false"},"En attente"))}},{Header:"",sortable:!1,accessor:"type",filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},!1===e.original.type?r.a.createElement(i.a,{className:t.blue,label:"Nouvelle"}):r.a.createElement(i.a,{className:t.chip2,label:"Renouvellement"})),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement("select",{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"false"},"Nouvelle"),r.a.createElement("option",{value:"true"},"Renouvellement"))}},{Header:"",Cell:t=>r.a.createElement("div",{className:"flex items-center"},!1===t.original.statut?r.a.createElement(s.a,{title:"Traiter"},r.a.createElement(u.a,{className:"text-blue text-20",onClick:()=>e.history.push("/admin/offres/commande/"+t.original.id)},r.a.createElement(d.a,null,"send"))):r.a.createElement(s.a,{title:"D\xe9j\xe0 trait\xe9e"},r.a.createElement(u.a,{className:"text-grey text-20"},r.a.createElement(d.a,null,"send"))))}],manual:!0,pages:g,page:b.page-1,defaultPageSize:10,loading:m,showPageSizeOptions:!1,onPageChange:e=>{b.page=e+1,a(f.A(b))},onSortedChange:(e,t,n)=>{b.page=1,b.filter.id=e[0].id,b.filter.direction=e[0].desc?"desc":"asc",a(f.A(b))},onFilteredChange:e=>{b.page=1,b.search=e,v(b)},noDataText:"Aucune commande trouv\xe9e",loadingText:"Chargement...",ofText:"sur"}))}),O=a(89);var M=function(e){return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(o.d,{animation:"transition.expandIn",delay:300},r.a.createElement(d.a,{className:"text-32 mr-0 sm:mr-12"},"inbox")),r.a.createElement(o.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(O.a,{className:"hidden sm:flex",variant:"h6"},"Commandes d'abonnement"))))},v=a(1348),N=a(364);t.default=Object(l.a)("commandeOffreAdminApp",v.a)(function(){const e=Object(p.b)(),t=Object(p.c)(e=>{let{commandeOffreAdminApp:t}=e;return t.commandes.parametres});return Object(n.useEffect)(()=>{e(f.u(t))},[e,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(N.Helmet,null,r.a.createElement("title",null,"Commande abonnement | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(o.o,{classes:{content:"flex flex-col h-full",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(M,null),content:r.a.createElement(C,null),innerScroll:!0}))})}}]);