(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{1065:function(e,n,t){"use strict";var a=t(54),r=t(64),i=t.n(r),o="[ABONNEMENTS APP] REQUEST ABONNEMENTS",u="[ABONNEMENTS APP] SET PARAMETRES DATA",c="[ABONNEMENTS APP] GET ABONNEMENTS",l="[ABONNEMENTS APP] SET ABONNEMENTS SEARCH TEXT",s="[ABONNEMENTS APP] CLEAN_UP";function d(){return function(e){return e({type:s})}}function f(e){var n="";e.search.length>0&&e.search.map(function(e,t){e.value&&("created"===e.id||"expired"===e.id?n+="&"+e.id+"[after]="+e.value:"statut"===e.id?"0"===e.value?n+="&statut=false&expired[exists]=false":"1"===e.value?n+="&statut=true&expired[strictly_after]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss")):"2"===e.value?n+="&statut=false&expired[strictly_after]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss")):"3"===e.value&&(n+="&expired[strictly_before]=".concat(i()().format("YYYY-MM-DDTHH:mm:ss"))):n+="&"+e.id+"="+e.value)});var t=a.a.get("/api/abonnements?page=".concat(e.page).concat(n,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction));return function(e){return e({type:o}),t.then(function(n){return e({type:c,payload:n.data})})}}function m(e){return{type:u,parametres:e}}var p=t(8),E=t(36),g=t(10),N="[ABONNEMENT APP] REQUEST ABONNEMENT",b="[ABONNEMENT APP] GET ABONNEMENT",h="[ABONNEMENT APP] REQUEST_SOUS_SECTEURS",O="[ABONNEMENT APP] GET SOUS_SECTEURS",y="[ABONNEMENT APP] REQUEST SECTEURS",A="[ABONNEMENT APP] GET SECTEURS",v="[ABONNEMENT APP] REQUEST OFFRES",S="[ABONNEMENT APP] GET OFFRES",T="[ABONNEMENT APP] REQUEST SAVE",P="[ABONNEMENT APP] SAVE ABONNEMENT",x="[ABONNEMENT APP] GET_PAIEMENT",j="[ABONNEMENT APP] CLEAN_UP_FRS",M="[ABONNEMENT APP] GET_DUREE",B="[ABONNEMENT APP] REQUEST_FOURNISSEURS",C="[ABONNEMENT APP] GET_FOURNISSEURS",R="[ABONNEMENT APP] REQUEST_FOURNISSEUR",w="[ABONNEMENT APP] GET_FOURNISSEUR";function U(){return function(e){return e({type:j})}}function F(){var e=a.a.get("/api/durees");return function(n){return e.then(function(e){n({type:M,payload:e.data["hydra:member"]})})}}function H(){var e=a.a.get("/api/fournisseurs?pagination=false&del=false&isactif=true&props[]=id&props[]=societe");return function(n){return n({type:B}),e.then(function(e){n({type:C,payload:e.data["hydra:member"]})})}}function Y(e){var n=a.a.get(e);return function(e){return e({type:R}),n.then(function(n){e({type:w,payload:n.data})})}}function D(e,n,t,r,i,o,u){var c={offre:t["@id"],sousSecteurs:g.a.map(n,function(e,n){return e.value}),mode:r,duree:i["@id"],fournisseur:e.fournisseur.value,commentaire:e.commentaire,statut:u,remise:o?parseFloat(o):0},l=a.a.post("/api/abonnements",c);return function(e){return e({type:T}),l.then(function(n){return e(Object(E.B)({message:"Abonnement sauvegarder"})),e({type:P,payload:n.data})})}}function _(e,n,t,r,i,o,u){var c=Object(p.a)({},e,{offre:t["@id"],sousSecteurs:g.a.map(n,function(e,n){return e.value}),mode:r,duree:i["@id"],commentaire:e.commentaire,statut:u,remise:o?parseFloat(o):0}),l=a.a.put(e["@id"],c);return function(e){return e({type:T}),l.then(function(n){return e(Object(E.B)({message:"Abonnement modifi\xe9e avec succ\xe8s"})),e({type:P,payload:n.data})})}}function k(e,n,t,r,i,o,u,c){var l={offre:t["@id"],sousSecteurs:g.a.map(n,function(e,n){return e.value}),mode:r,duree:i["@id"],fournisseur:e.fournisseur.value,statut:u,commentaire:e.commentaire,remise:o?parseFloat(o):0,type:"1"==c},s=a.a.post("/api/abonnements",l);return function(e){return e({type:T}),s.then(function(n){return e(Object(E.B)({message:"Abonnement sauvegarder"})),e({type:P,payload:n.data})})}}function I(e){var n=a.a.get("".concat(e,"/sous_secteurs?pagination=false&props[]=id&props[]=name"));return function(e){return e({type:h}),n.then(function(n){e({type:O,payload:n.data["hydra:member"]})})}}function L(){var e=a.a.get("/api/secteurs?pagination=false&props[]=id&props[]=name&order[name]=asc");return function(n){return n({type:y}),e.then(function(e){n({type:A,payload:e.data["hydra:member"]})})}}function G(){var e=a.a.get("/api/paiements");return function(n){return e.then(function(e){n({type:x,payload:e.data["hydra:member"]})})}}function Q(){var e=a.a.get("/api/offres");return function(n){return n({type:v}),e.then(function(e){return n({type:S,payload:e.data["hydra:member"]})})}}function z(e){var n=a.a.get("/api/abonnements/".concat(e));return function(e){return e({type:N}),n.then(function(n){return e({type:b,payload:n.data})})}}function q(){return{type:b,payload:{offre:null,commentaire:"",sousSecteurs:[]}}}t.d(n,"m",function(){return o}),t.d(n,"w",function(){return u}),t.d(n,"d",function(){return c}),t.d(n,"v",function(){return l}),t.d(n,"a",function(){return s}),t.d(n,"x",function(){return d}),t.d(n,"A",function(){return f}),t.d(n,"L",function(){return m}),t.d(n,"l",function(){return N}),t.d(n,"c",function(){return b}),t.d(n,"s",function(){return h}),t.d(n,"k",function(){return O}),t.d(n,"r",function(){return y}),t.d(n,"j",function(){return A}),t.d(n,"p",function(){return v}),t.d(n,"h",function(){return S}),t.d(n,"q",function(){return T}),t.d(n,"t",function(){return P}),t.d(n,"u",function(){return"[ABONNEMENT APP] SAVE ERROR"}),t.d(n,"i",function(){return x}),t.d(n,"a",function(){}),t.d(n,"b",function(){return j}),t.d(n,"e",function(){return M}),t.d(n,"o",function(){return B}),t.d(n,"g",function(){return C}),t.d(n,"n",function(){return R}),t.d(n,"f",function(){return w}),t.d(n,"y",function(){return U}),t.d(n,"B",function(){return F}),t.d(n,"D",function(){return H}),t.d(n,"C",function(){return Y}),t.d(n,"J",function(){return D}),t.d(n,"M",function(){return _}),t.d(n,"K",function(){return k}),t.d(n,"H",function(){return I}),t.d(n,"G",function(){return L}),t.d(n,"F",function(){return G}),t.d(n,"E",function(){return Q}),t.d(n,"z",function(){return z}),t.d(n,"I",function(){return q})},1108:function(e,n,t){"use strict";var a=t(46),r=t(8),i=t(1065),o=t(107),u={data:[],pageCount:null,loading:!1,searchText:"",parametres:{page:1,search:[],filter:{id:"created",direction:"desc"}}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case i.a:return Object(r.a)({},u);case i.m:return Object(r.a)({},e,{loading:!0});case i.d:return Object(r.a)({},e,{data:n.payload["hydra:member"],pageCount:o.a.hydraPageCount(n.payload),loading:!1});case i.v:return Object(r.a)({},e,{searchText:n.searchText});case i.w:return Object(r.a)({},e,{parametres:{page:n.parametres.page,search:n.parametres.search,filter:{id:n.parametres.filter.id,direction:n.parametres.filter.direction}}});default:return e}},l={data:null,offres:null,sousSecteurs:null,loadingSecteurs:!1,secteurs:null,error:null,loading:!1,loadingSS:!1,success:!1,paiements:null,durees:null,loadingFournisseurs:!1,fournisseurs:null,fournisseur:null},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case i.l:case i.p:case i.q:return Object(r.a)({},e,{loading:!0});case i.o:case i.n:return Object(r.a)({},e,{loadingFournisseurs:!0});case i.g:return Object(r.a)({},e,{fournisseurs:n.payload,loadingFournisseurs:!1});case i.f:return Object(r.a)({},e,{fournisseur:n.payload,loadingFournisseurs:!1});case i.i:return Object(r.a)({},e,{paiements:n.payload});case i.e:return Object(r.a)({},e,{durees:n.payload});case i.t:return Object(r.a)({},e,{loading:!1,success:!0});case i.a:return Object(r.a)({},l);case i.b:return Object(r.a)({},e,{fournisseur:null});case i.c:return Object(r.a)({},e,{data:n.payload,loading:!1});case i.r:return Object(r.a)({},e,{loadingSecteurs:!0});case i.j:return Object(r.a)({},e,{secteurs:n.payload,loadingSecteurs:!1});case i.s:return Object(r.a)({},e,{loadingSS:!0});case i.k:return Object(r.a)({},e,{sousSecteurs:n.payload,loadingSS:!1});case i.h:return Object(r.a)({},e,{offres:n.payload,loading:!1});case i.u:return Object(r.a)({},e,{error:n.payload,loading:!1});default:return e}},d=t(36),f={state:!1,options:{children:"Hi"}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d.f:return Object(r.a)({},e,{state:!0,options:Object(r.a)({},e.options,n.options)});case d.a:return Object(r.a)({},e,{state:!1});default:return e}},p=Object(a.d)({abonnements:c,abonnement:s,dialog:m});n.a=p},1406:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),i=t(40),o=t(140),u=t(23),c=t(967),l=t(974),s=t(1029),d=t(958),f=t(1013),m=t(78),p=t(1065),E=t(6),g=t(64),N=t.n(g),b=t(107),h=t(347),O=t(1034),y=t(10),A=Object(O.a)(function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chip:{marginLeft:e.spacing(1),padding:2,background:"#ef5350",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chip2:{marginLeft:e.spacing(1),padding:2,background:"#4caf50",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chipOrange:{marginLeft:e.spacing(1),padding:2,background:"#ff9800",color:"white",fontWeight:"bold",fontSize:"11px",height:20}}});var v=Object(m.g)(function(e){var n=A(),t=Object(E.b)(),o=Object(E.c)(function(e){return e.abonnementOffreApp.abonnements.data}),m=Object(E.c)(function(e){return e.abonnementOffreApp.abonnements.loading}),g=Object(E.c)(function(e){return e.abonnementOffreApp.abonnements.pageCount}),O=Object(E.c)(function(e){return e.abonnementOffreApp.abonnements.parametres}),v=Object(E.c)(function(e){return e.abonnementOffreApp.abonnements.searchText}),S=Object(a.useState)(null),T=Object(u.a)(S,2),P=T[0],x=T[1];if(Object(a.useEffect)(function(){o&&x(function(e,n){var t=Object.keys(e).map(function(n){return e[n]});return 0===n.length?t:b.a.filterArrayByString(t,n)}(o,v))},[o,v]),!P)return null;var j=y.a.debounce(function(e){return t(p.L(e))},1e3);return r.a.createElement(i.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(h.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:function(e,n,t){return{className:"h-64"}},getTheadProps:function(e,n,t){return{className:"h-64 font-bold"}},data:P,columns:[{Header:"R\xe9f\xe9rence",className:"font-bold",accessor:"reference",filterable:!0,Cell:function(e){return e.original.reference}},{Header:"Offre",className:"font-bold",accessor:"offre.name",filterable:!0,Cell:function(e){return e.original.offre?e.original.offre.name:""}},{Header:"Fournisseur",className:"font-bold",accessor:"fournisseur.societe",filterable:!0,Cell:function(e){return e.original.fournisseur?e.original.fournisseur.societe:""}},{Header:"Mode de paiement",accessor:"mode.name",filterable:!0,Cell:function(e){return e.original.mode?e.original.mode.name:""}},{Header:"Activit\xe9s",accessor:"sousSecteurs.name",filterable:!0,Cell:function(e){return y.a.truncate(y.a.join(y.a.map(e.original.sousSecteurs,"name"),", "),{length:25,separator:" "})}},{Header:"Date de cr\xe9ation",accessor:"created",filterable:!0,Cell:function(e){return N()(e.original.created).format("DD/MM/YYYY HH:mm")},Filter:function(e){var n=e.filter,t=e.onChange;return r.a.createElement(c.a,{onChange:function(e){return t(e.target.value)},style:{width:"100%"},value:n?n.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"Date d'expiration",accessor:"expired",filterable:!0,Cell:function(e){return e.original.expired&&N()(e.original.expired).format("DD/MM/YYYY HH:mm")+" ( "+N()(e.original.expired).diff(N()(),"days")+" j )"},Filter:function(e){var n=e.filter,t=e.onChange;return r.a.createElement(c.a,{onChange:function(e){return t(e.target.value)},style:{width:"100%"},value:n?n.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"Statut",accessor:"statut",sortable:!1,filterable:!0,Cell:function(e){return r.a.createElement("div",{className:"flex items-center"},!1===e.original.statut?e.original.expired&&void 0!==e.original.expired?N()(e.original.expired)>=N()()?r.a.createElement(l.a,{className:n.chip,label:"Annul\xe9"}):r.a.createElement(l.a,{className:n.chip,label:"Expir\xe9"}):r.a.createElement(l.a,{className:n.chipOrange,label:"En attente"}):N()(e.original.expired)>=N()()?r.a.createElement(l.a,{className:n.chip2,label:"En cours"}):r.a.createElement(l.a,{className:n.chip,label:"Expir\xe9"}))},Filter:function(e){var n=e.filter,t=e.onChange;return r.a.createElement("select",{onChange:function(e){return t(e.target.value)},style:{width:"100%"},value:n?n.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"0"},"En attente"),r.a.createElement("option",{value:"1"},"En cours"),r.a.createElement("option",{value:"2"},"Annul\xe9"),r.a.createElement("option",{value:"3"},"Expir\xe9"))}},{Header:"",Cell:function(n){return r.a.createElement("div",{className:"flex items-center"},(N()(n.original.expired)>=N()()||!n.original.expired)&&r.a.createElement(s.a,{title:"Editer"},r.a.createElement(d.a,{className:"text-orange text-20",onClick:function(){return e.history.push("/admin/offres/abonnement/"+n.original.id)}},r.a.createElement(f.a,null,"edit"))),!0===n.original.statut&&N()(n.original.expired).diff(N()(),"month",!0)<=1&&N()(n.original.expired).diff(N()(),"month",!0)>0&&r.a.createElement(s.a,{title:"Renouveler"},r.a.createElement(d.a,{onClick:function(){e.history.push("/admin/offres/renouvellement/"+n.original.id+"/1")},className:"text-teal text-20"},r.a.createElement(f.a,null,"autorenew"))),!0===n.original.statut&&N()(n.original.expired)<N()()&&r.a.createElement(s.a,{title:"Dupliquer"},r.a.createElement(d.a,{onClick:function(){e.history.push("/admin/offres/renouvellement/"+n.original.id+"/2")},className:"text-green-700 text-20"},r.a.createElement(f.a,null,"file_copy"))))}}],manual:!0,pages:g,page:O.page-1,defaultPageSize:10,loading:m,showPageSizeOptions:!1,onPageChange:function(e){O.page=e+1,t(p.L(O))},onSortedChange:function(e,n,a){O.page=1,O.filter.id=e[0].id,O.filter.direction=e[0].desc?"desc":"asc",t(p.L(O))},onFilteredChange:function(e){O.page=1,O.search=e,j(O)},noDataText:"Aucune abonnement trouv\xe9e",loadingText:"Chargement...",ofText:"sur"}))}),S=t(98),T=t(1035),P=t(18);var x=function(e){return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(i.d,{animation:"transition.expandIn",delay:300},r.a.createElement(f.a,{className:"text-32 mr-0 sm:mr-12"},"cloud")),r.a.createElement(i.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(S.a,{className:"hidden sm:flex",variant:"h6"},"Abonnements"))),r.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"}),r.a.createElement(i.d,{animation:"transition.slideRightIn",delay:300},r.a.createElement(T.a,{component:P.a,to:"/admin/offres/abonnement/new",className:"whitespace-no-wrap",variant:"contained"},r.a.createElement("span",{className:"hidden sm:flex"},"Ajouter nouveau abonnement"),r.a.createElement("span",{className:"flex sm:hidden"},"New"))))},j=t(1108),M=t(346);n.default=Object(o.a)("abonnementOffreApp",j.a)(function(){var e=Object(E.b)(),n=Object(E.c)(function(e){return e.abonnementOffreApp.abonnements.parametres});return Object(a.useEffect)(function(){e(p.A(n))},[e,n]),r.a.createElement(r.a.Fragment,null,r.a.createElement(M.Helmet,null,r.a.createElement("title",null,"Abonnements | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(i.o,{classes:{content:"flex flex-col h-full",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(x,null),content:r.a.createElement(v,null),innerScroll:!0}))})}}]);