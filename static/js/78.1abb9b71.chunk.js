(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{1244:function(e,t,a){"use strict";var r=a(3),n=a.n(r),s=a(4),l=a.n(s),o=a(0),c=a.n(o),i=a(2),u=a(8),p=a(89),d=c.a.forwardRef(function(e,t){var a=e.children,r=e.classes,s=e.className,o=e.disableTypography,u=void 0!==o&&o,d=l()(e,["children","classes","className","disableTypography"]);return c.a.createElement("div",n()({className:Object(i.a)(r.root,s),ref:t},d),u?a:c.a.createElement(p.a,{variant:"h6"},a))});t.a=Object(u.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(d)},1245:function(e,t,a){"use strict";var r=a(3),n=a.n(r),s=a(0),l=a.n(s),o=a(8),c=a(89),i=l.a.forwardRef(function(e,t){return l.a.createElement(c.a,n()({component:"p",variant:"body1",color:"textSecondary",ref:t},e))});t.a=Object(o.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(i)},1538:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(39),l=a(7),o=a(136),c=a(1140),i=a(1244),u=a(1229),p=a(1245),d=a(1230),m=a(1227),E=a(1204),f=a(365),h=a(50),S=a(102),g=a(33),b=a(10);const v="[SECTEURS APP] GET SECTEURS",O="[SECTEURS APP] GET_PARENTS",y="[SOUS_SECTEURS APP] GET SOUS_SECTEURS",C="[SOUS_SECTEURS APP] SET PARAMETRES DATA",_="[SOUS_SECTEURS APP] REQUEST SOUS_SECTEURS",A="[SOUS_SECTEURS APP] OPEN NEW SOUS_SECTEURS DIALOG",j="[SOUS_SECTEURS APP] CLOSE NEW SOUS_SECTEURS DIALOG",P="[SOUS_SECTEURS APP] OPEN EDIT SOUS_SECTEURS DIALOG",T="[SOUS_SECTEURS APP] CLOSE EDIT SOUS_SECTEURS DIALOG",U="[SOUS_SECTEURS APP] ADD SOUS_SECTEUR",x="[SOUS_SECTEURS APP] SAVE ERROR",N="[SOUS_SECTEURS APP] UPDATE SOUS_SECTEUR",R="[SOUS_SECTEURS APP] REMOVE SOUS_SECTEUR";function w(e){var t="";e.search.length>0&&e.search.map(function(e,a){t+="&"+e.id+"="+e.value});const a=h.a.get("/api/sous_secteurs?page=".concat(e.page).concat(t,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction,"&props[]=id&props[]=name&props[]=secteur&props[]=parent&props[]=fournisseurs"));return e=>(e({type:_}),a.then(t=>{e({type:y,payload:t.data})}))}function D(e){return{type:C,parametres:e}}function k(e,t){let a={del:!0,name:e.name+"_deleted-"+e.id};return r=>{return r({type:_}),h.a.put(e["@id"],a).then(e=>Promise.all([r(Object(g.B)({message:"Sous-secteur bien supprim\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>r(w(t)))).catch(e=>{r({type:R}),e.response.data&&e.response.data["hydra:description"]&&r(Object(g.B)({message:e.response.data["hydra:description"],anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}const I="[DIALOG] OPEN",F="[DIALOG] CLOSE";function L(){return{type:F}}function W(e){return{type:I,options:e}}var z=a(1221),M=a(8);var B=function(e){const t=Object(l.b)(),a=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.entities}),o=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.pageCount}),S=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.loading}),g=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.parametres}),O=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.searchText}),[y,C]=Object(r.useState)(null);if(Object(M.a)(e=>({tooltip:{maxWidth:220,fontSize:e.typography.pxToRem(12),border:"1px solid #dadde9","& b":{fontWeight:e.typography.fontWeightMedium}}}))(z.a),Object(r.useEffect)(()=>{t(function(){const e=h.a.get("/api/secteurs?pagination=false&props[]=id&props[]=name");return t=>e.then(e=>{t({type:v,payload:e.data["hydra:member"]})})}())},[t]),Object(r.useEffect)(()=>{a&&C(function(e,t){const a=Object.keys(e).map(t=>e[t]);return 0===t.length?a:s.y.filterArrayByString(a,t)}(a,O))},[a,O]),!y)return null;const _=b.a.debounce(e=>t(D(e)),700);return n.a.createElement(s.d,{animation:"transition.slideUpIn",delay:300},n.a.createElement(f.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:(e,a,r)=>({className:"cursor-pointer",onClick:(e,r)=>{a&&t(function(e){return{type:P,data:e}}(a.original))}}),data:y,columns:[{Header:"Activit\xe9",accessor:"name",filterable:!0},{Header:"Secteur",accessor:"secteur.name",filterable:!0,Cell:e=>n.a.createElement("div",{className:"flex items-center"},e.original.secteur?e.original.secteur.name:"")},{Header:"",sortable:!1,width:64,Cell:e=>n.a.createElement("div",{className:"flex items-center"},n.a.createElement(c.a,{className:"text-red text-20",onClick:a=>{a.stopPropagation(),t(W({children:n.a.createElement(n.a.Fragment,null,n.a.createElement(i.a,{id:"alert-dialog-title"},"Suppression"),n.a.createElement(u.a,null,n.a.createElement(p.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),n.a.createElement(d.a,null,n.a.createElement(m.a,{onClick:()=>t(L()),color:"primary"},"Non"),n.a.createElement(m.a,{onClick:a=>{t(k(e.original,g)),t(L())},color:"primary",autoFocus:!0},"Oui")))}))}},n.a.createElement(E.a,null,"delete")))}],manual:!0,pages:o,page:g.page-1,defaultPageSize:10,loading:S,showPageSizeOptions:!1,onPageChange:e=>{g.page=e+1,t(D(g))},onSortedChange:(e,a,r)=>{g.page=1,g.filter.id=e[0].id,g.filter.direction=e[0].desc?"desc":"asc",t(D(g))},onFilteredChange:e=>{g.page=1,g.search=e,_(g)},noDataText:"Aucune activit\xe9 trouv\xe9e",loadingText:"Chargement...",ofText:"sur"}))},G=a(89);var H=function(e){const t=Object(l.b)();return n.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},n.a.createElement("div",{className:"flex items-center"},n.a.createElement(s.d,{animation:"transition.expandIn",delay:300},n.a.createElement(E.a,{className:"text-32 mr-0 sm:mr-12"},"ballot")),n.a.createElement(s.d,{animation:"transition.slideLeftIn",delay:300},n.a.createElement(G.a,{className:"hidden sm:flex",variant:"h6"},"Gestion des Activit\xe9s"))),n.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"}),n.a.createElement(s.d,{animation:"transition.slideRightIn",delay:300},n.a.createElement(m.a,{onClick:e=>t({type:A}),className:"whitespace-no-wrap",variant:"contained"},n.a.createElement("span",{className:"hidden sm:flex"},"Ajouter nouvelle activit\xe9"),n.a.createElement("span",{className:"flex sm:hidden"},"New"))))},V=a(1223),q=a(1218),J=a(1228),Q=a(137),K=a(51),X=a.n(K),Y=a(368);const Z={name:""};var $=function(e){const t=Object(l.b)(),a=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.sous_secteursDialog}),o=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.secteur}),f=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.parents}),v=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.parametres}),{form:y,handleChange:C,setForm:_}=Object(Q.b)(Z),[A,P]=Object(r.useState)(!1),R=Object(r.useRef)(null),D=Object(r.useCallback)(()=>{if("edit"===a.type&&a.data){let e={value:a.data.secteur["@id"],label:a.data.secteur.name};a.data.parent&&(a.data.parent={value:a.data.parent["@id"],label:a.data.parent.name}),_({...a.data}),_(b.a.set({...a.data},"secteur",e))}"new"===a.type&&_({...Z,...a.data})},[a.data,a.type,_]);function I(){"edit"===a.type?t({type:T}):t({type:j})}function F(){t(k(y,v)),t(L()),I()}function z(e,a){_(b.a.set({...y},a,e)),"secteur"===a&&e.value&&t(function(e){const t=h.a.get("".concat(e,"/sous_secteurs?pagination=false&props[]=id&props[]=name"));return e=>t.then(t=>{e({type:O,payload:t.data["hydra:member"]})})}(e.value))}return Object(r.useEffect)(()=>{a.props.open&&D()},[a.props.open,D]),n.a.createElement(V.a,Object.assign({classes:{paper:"m-24"}},a.props,{onClose:I,fullWidth:!0,maxWidth:"xs"}),n.a.createElement(q.a,{position:"static",elevation:1},n.a.createElement(J.a,{className:"flex w-full"},n.a.createElement(G.a,{variant:"subtitle1",color:"inherit"},"new"===a.type?"Nouvelle activit\xe9":"Editer activit\xe9"))),n.a.createElement(X.a,{onValidSubmit:function(e){"new"===a.type?t(function(e,t){return e.secteur=e.secteur.value,e.parent&&(e.parent=e.parent.value),(a,r)=>h.a.post("/api/sous_secteurs",e).then(e=>Promise.all([a({type:U}),a(Object(g.B)({message:"Sous-secteur bien ajout\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>a(w(t)))).catch(e=>{a({type:x}),a(Object(g.B)({message:b.a.map(S.a.parseApiErrors(e),function(e,t){return t+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}(y,v)):t(function(e,t){return e.secteur=e.secteur.value,e.parent&&(e.parent=e.parent.value),(a,r)=>h.a.put(e["@id"],e).then(e=>Promise.all([a({type:N}),a(Object(g.B)({message:"Sous-secteur bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>a(w(t)))).catch(e=>{a({type:x}),a(Object(g.B)({message:b.a.map(S.a.parseApiErrors(e),function(e,t){return t+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}(y,v)),I()},onValid:function(){P(!0)},onInvalid:function(){P(!1)},ref:R,className:"flex flex-col overflow-hidden"},n.a.createElement(u.a,{classes:{root:"p-24"}},n.a.createElement("div",{className:"flex"},n.a.createElement("div",{className:"min-w-48 pt-20"},n.a.createElement(E.a,{color:"action"},"ballot")),n.a.createElement(s.F,{className:"mb-24",label:"Nom",autoFocus:!0,id:"name",name:"name",value:y.name,onChange:C,variant:"outlined",validations:{minLength:4},validationErrors:{minLength:"Min character length is 4"},required:!0,fullWidth:!0})),n.a.createElement("div",{className:"flex"},n.a.createElement("div",{className:"min-w-48 pt-20"},n.a.createElement(E.a,{color:"action"},"work")),n.a.createElement(Y.a,{id:"secteur",name:"secteur",className:"MuiFormControl-fullWidth MuiTextField-root mb-24",value:y.secteur,onChange:e=>z(e,"secteur"),placeholder:"S\xe9lectionner un secteur",textFieldProps:{label:"Secteur",InputLabelProps:{shrink:!0},variant:"outlined"},options:o,fullWidth:!0,required:!0})),n.a.createElement("div",{className:"flex"},n.a.createElement("div",{className:"min-w-48 pt-20"},n.a.createElement(E.a,{color:"action"},"work")),n.a.createElement(Y.a,{id:"parent",name:"parent",className:"MuiFormControl-fullWidth MuiTextField-root mb-24",value:y.parent,onChange:e=>z(e,"parent"),placeholder:"Parent optionnel",textFieldProps:{label:"Parent",InputLabelProps:{shrink:!0},variant:"outlined"},options:f,fullWidth:!0}))),"new"===a.type?n.a.createElement(d.a,{className:"justify-between pl-16"},n.a.createElement(m.a,{variant:"contained",color:"primary",type:"submit",disabled:!A},"Ajouter")):n.a.createElement(d.a,{className:"justify-between pl-16"},n.a.createElement(m.a,{variant:"contained",color:"primary",type:"submit",disabled:!A},"Modifier"),n.a.createElement(c.a,{onClick:()=>t(W({children:n.a.createElement(n.a.Fragment,null,n.a.createElement(i.a,{id:"alert-dialog-title"},"Suppression"),n.a.createElement(u.a,null,n.a.createElement(p.a,{id:"alert-dialog-description"},0===Object.keys(b.a.pullAllBy(y.fournisseurs,[{del:!0}],"del")).length?"Voulez vous vraiment supprimer cet enregistrement ?":"Vous ne pouvez pas supprimer cet enregistrement, car il est en relation avec d'autre(s) objet(s) !")),n.a.createElement(d.a,null,n.a.createElement(m.a,{onClick:()=>t(L()),color:"primary"},"Non"),0===Object.keys(b.a.pullAllBy(y.fournisseurs,[{del:!0}],"del")).length?n.a.createElement(m.a,{onClick:F,color:"primary",autoFocus:!0},"Oui"):n.a.createElement(m.a,{disabled:!0,color:"primary",autoFocus:!0},"Oui")))}))},n.a.createElement(E.a,null,"delete")))))},ee=a(43);const te={searchText:"",entities:null,pageCount:null,parametres:{page:1,search:[],filter:{id:"id",direction:"desc"}},routeParams:{},sous_secteursDialog:{type:"new",props:{open:!1},data:null},secteur:null,loading:!1,parents:null};var ae=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return{...e,secteur:t.payload};case O:return{...e,parents:t.payload};case _:return{...e,loading:!0};case y:return{...e,entities:t.payload["hydra:member"],pageCount:S.a.hydraPageCount(t.payload),loading:!1};case R:return{...e,loading:!1};case C:return{...e,parametres:{page:t.parametres.page,search:t.parametres.search,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}};case A:return{...e,sous_secteursDialog:{type:"new",props:{open:!0},data:null}};case j:return{...e,sous_secteursDialog:{type:"new",props:{open:!1},data:null}};case P:return{...e,sous_secteursDialog:{type:"edit",props:{open:!0},data:t.data}};case T:return{...e,sous_secteursDialog:{type:"edit",props:{open:!1},data:null}};default:return e}};const re={state:!1,options:{children:"Hi"}};var ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g.f:return{...e,state:!0,options:{...e.options,...t.options}};case g.a:return{...e,state:!1};default:return e}};var se=Object(ee.d)({sous_secteurs:ae,dialog:ne}),le=a(364);t.default=Object(o.a)("sous_secteursApp",se)(function(e){const t=Object(l.b)(),a=Object(r.useRef)(null),o=Object(l.c)(e=>{let{sous_secteursApp:t}=e;return t.sous_secteurs.parametres});return Object(r.useEffect)(()=>{t(w(o))},[t,o]),n.a.createElement(n.a.Fragment,null,n.a.createElement(le.Helmet,null,n.a.createElement("title",null,"Activit\xe9s | Les Achats Industriels"),n.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),n.a.createElement("meta",{name:"googlebot",content:"noindex"})),n.a.createElement(s.p,{classes:{contentWrapper:"p-0 sm:p-24 pb-80 sm:pb-80 h-full",content:"flex flex-col h-full",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:n.a.createElement(H,{pageLayout:a}),content:n.a.createElement(B,null),sidebarInner:!0,ref:a,innerScroll:!0}),n.a.createElement($,null))})}}]);