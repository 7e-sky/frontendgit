(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1051:function(e,a,t){"use strict";var n=t(3),r=t.n(n),i=t(4),l=t.n(i),s=t(0),c=t.n(s),o=(t(1),t(2)),u=t(7),m=t(98),d=c.a.forwardRef(function(e,a){var t=e.children,n=e.classes,i=e.className,s=e.disableTypography,u=void 0!==s&&s,d=l()(e,["children","classes","className","disableTypography"]);return c.a.createElement("div",r()({className:Object(o.a)(n.root,i),ref:a},d),u?t:c.a.createElement(m.a,{variant:"h6"},t))});a.a=Object(u.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(d)},1052:function(e,a,t){"use strict";var n=t(3),r=t.n(n),i=t(0),l=t.n(i),s=(t(1),t(7)),c=t(98),o=l.a.forwardRef(function(e,a){return l.a.createElement(c.a,r()({component:"p",variant:"body1",color:"textSecondary",ref:a},e))});a.a=Object(s.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(o)},1059:function(e,a,t){!function(e){"use strict";e.defineLocale("fr",{months:"janvier_f\xe9vrier_mars_avril_mai_juin_juillet_ao\xfbt_septembre_octobre_novembre_d\xe9cembre".split("_"),monthsShort:"janv._f\xe9vr._mars_avr._mai_juin_juil._ao\xfbt_sept._oct._nov._d\xe9c.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd\u2019hui \xe0] LT",nextDay:"[Demain \xe0] LT",nextWeek:"dddd [\xe0] LT",lastDay:"[Hier \xe0] LT",lastWeek:"dddd [dernier \xe0] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,a){switch(a){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})}(t(64))},1351:function(e,a,t){"use strict";t.r(a);var n=t(23),r=t(0),i=t.n(r),l=t(40),s=t(6),c=t(140),o=t(98),u=t(945),m=t(1029),d=t(958),p=t(1013),f=t(1051),h=t(1037),E=t(1052),v=t(1038),b=t(1035),g=t(347),O=t(8),j=t(54),y=(t(67),t(107)),A=t(36),N=t(10),w="[TEAMS APP] GET TEAMS",x="[TEAMS APP] SET SEARCH TEXT",P="[TEAMS APP] OPEN NEW TEAMS DIALOG",T="[TEAMS APP] CLOSE NEW TEAMS DIALOG",M="[TEAMS APP] OPEN EDIT TEAMS DIALOG",D="[TEAMS APP] CLOSE EDIT TEAMS DIALOG",S="[TEAMS APP] ADD TEAM",C="[TEAMS APP] SAVE ERROR",_="[TEAMS APP] UPDATE TEAM",L="[TEAMS APP] REMOVE TEAM",q="[TEAMS APP] UPLOAD IMAGE",R="[TEAMS APP] UPLOAD REQUEST",I="[TEAMS APP] UPLOAD ERROR";function H(e){var a=j.a.get("/api/acheteurs/".concat(e,"/teams"));return function(e){return a.then(function(a){e({type:w,payload:a.data["hydra:member"]})})}}function k(){return{type:T}}function F(e,a){var t={del:!0};return function(n,r){return j.a.put(e["@id"],t).then(function(e){return Promise.all([n({type:L}),n(Object(A.B)({message:"Acheteur / Master bien supprim\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return n(H(a))})})}}var Y="[DIALOG] OPEN",W="[DIALOG] CLOSE";function V(){return{type:W}}var B=t(64),z=t.n(B);var G=function(e){var a=Object(s.b)(),t=Object(s.c)(function(e){return e.teamsApp.teams.entities}),c=Object(s.c)(function(e){return e.auth.user}),O=Object(s.c)(function(e){return e.teamsApp.teams.searchText}),j=Object(r.useState)(null),y=Object(n.a)(j,2),A=y[0],N=y[1];return Object(r.useEffect)(function(){t&&N(function(e,a){var t=Object.keys(e).map(function(a){return e[a]});return 0===a.length?t:l.y.filterArrayByString(t,a)}(t,O))},[t,O]),A?0===A.length?i.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},i.a.createElement(o.a,{color:"textSecondary",variant:"h5"},"Il n'y a pas d'Acheteur / Master!")):i.a.createElement(l.d,{animation:"transition.slideUpIn",delay:300},i.a.createElement(g.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",data:A,columns:[{Header:"",Cell:function(e){return e.original.avatar?i.a.createElement(u.a,{className:"mr-8",alt:e.original.firstName,src:l.G+e.original.avatar.url}):i.a.createElement(u.a,{className:"mr-8",alt:e.original.firstName,src:"assets/images/avatars/images.png"})},className:"justify-center",width:64,sortable:!1},{Header:"Soci\xe9t\xe9",accessor:"user.societe",filterable:!0,Cell:function(e){return e.original.user?e.original.user.societe:""}},{Header:"Nom & Pr\xe9nom",accessor:"user",filterable:!0,Cell:function(e){return e.original.acheteur?"".concat(e.original.acheteur.first_name," ").concat(e.original.acheteur.last_name):"".concat(e.original.user.first_name," ").concat(e.original.user.last_name)}},{Header:"Ville",accessor:"user.ville",filterable:!0,Cell:function(e){return e.original.user?e.original.user.ville:""}},{Header:"Email",accessor:"email",filterable:!0,Cell:function(e){return e.original.email?e.original.email:""}},{Header:"T\xe9l\xe9phone",accessor:"phone",filterable:!0,Cell:function(e){return e.original.phone?e.original.phone:""}},{Header:"Date de cr\xe9ation",Cell:function(e){return z()(e.original.created).format("DD/MM/YYYY HH:mm")}},{Header:"",width:128,Cell:function(e){return i.a.createElement("div",{className:"flex items-center"},i.a.createElement(m.a,{title:"Editer"},i.a.createElement(d.a,{className:"text-orange text-20",onClick:function(t){var n;t.stopPropagation(),a((n=e.original,{type:M,data:n}))}},i.a.createElement(p.a,null,"edit"))),i.a.createElement(m.a,{title:"Supprimer"},i.a.createElement(d.a,{className:"text-red text-20",onClick:function(t){var n;t.stopPropagation(),a((n={children:i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,{id:"alert-dialog-title"},"Suppression"),i.a.createElement(h.a,null,i.a.createElement(E.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),i.a.createElement(v.a,null,i.a.createElement(b.a,{onClick:function(){return a(V())},color:"primary"},"Non"),i.a.createElement(b.a,{onClick:function(t){a(F(e.original,c.id)),a(V())},color:"primary",autoFocus:!0},"Oui")))},{type:Y,options:n}))}},i.a.createElement(p.a,null,"delete"))))}}],defaultPageSize:10,noDataText:"No teams found"})):null},U=t(139),Q=t(957),J=t(1014);var X=function(e){var a=Object(s.b)(),t=Object(s.c)(function(e){return e.teamsApp.teams.searchText}),n=Object(s.c)(function(e){return e.fuse.settings.mainTheme});return i.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},i.a.createElement("div",{className:"flex items-center"},i.a.createElement(l.d,{animation:"transition.expandIn",delay:300},i.a.createElement(p.a,{className:"text-32 mr-0 sm:mr-12"},"group")),i.a.createElement(l.d,{animation:"transition.slideLeftIn",delay:300},i.a.createElement(o.a,{className:"hidden sm:flex",variant:"h6"},"Cr\xe9ation d'acheteur / Master"))),i.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"},i.a.createElement(J.a,{theme:n},i.a.createElement(l.d,{animation:"transition.slideDownIn",delay:300},i.a.createElement(U.a,{className:"flex items-center w-full max-w-512 px-8 py-4 rounded-8",elevation:1},i.a.createElement(p.a,{className:"mr-8",color:"action"},"search"),i.a.createElement(Q.a,{placeholder:"Rechercher...",className:"flex flex-1",disableUnderline:!0,fullWidth:!0,value:t,inputProps:{"aria-label":"Search"},onChange:function(e){return a({type:x,searchText:e.target.value})}}))))),i.a.createElement(l.d,{animation:"transition.slideRightIn",delay:300},i.a.createElement(b.a,{onClick:function(e){return a({type:P})},className:"whitespace-no-wrap",variant:"contained"},i.a.createElement("span",{className:"hidden sm:flex"},"Ajouter"),i.a.createElement("span",{className:"flex sm:hidden"},"New"))))},K=t(1031),Z=t(1026),$=t(1036),ee=t(1039),ae=t(1041),te=t(1023),ne=t(1024),re=t(141),ie=t(197),le=t(55),se=t.n(le),ce=t(351),oe=t.n(ce),ue=t(352),me=t.n(ue),de={};var pe=function(e){var a=Object(s.b)(),t=Object(s.c)(function(e){return e.teamsApp.teams.teamsDialog}),c=Object(s.c)(function(e){return e.teamsApp.teams.imageReqInProgress}),m=Object(s.c)(function(e){return e.teamsApp.teams.avatar}),f=Object(s.c)(function(e){return e.auth.user}),E=Object(re.b)(de),g=E.form,w=E.handleChange,x=E.setForm,P=function(e){e.preventDefault()},T=Object(r.useState)(!1),M=Object(n.a)(T,2),L=M[0],Y=M[1],W=Object(r.useRef)(null),B=Object(r.useState)({showPassword:!1}),z=Object(n.a)(B,2),G=z[0],U=z[1],Q=function(){U(Object(O.a)({},G,{showPassword:!G.showPassword}))},J=Object(r.useCallback)(function(){"edit"===t.type&&t.data&&x(Object(O.a)({},t.data)),"new"===t.type&&x(Object(O.a)({},t.data,de))},[t.data,t.type,x]);function X(){"edit"===t.type?a({type:D}):a(k())}function le(e){""!==g.societe&&""!==g.firstName&&""!==g.lastName&&""!==g.phone&&""!==g.email&&("new"!==t.type||""!==g.password&&""!==g.confirmpassword)&&("new"===t.type?a(function(e,a){var t=Object(O.a)({},e,{codepostal:parseInt(e.codepostal,10),avatar:e.avatar?e.avatar["@id"]:null,isactif:!0});return function(e,n){return j.a.post("/api/teams",t).then(function(n){var r={societe:t.societe,firstName:t.firstName,lastName:t.lastName,phone:t.phone,email:t.email,password:t.password,confirmpassword:t.confirmpassword,avatar:t.avatar,isactif:!0};return j.a.post("/api/acheteurs",r).then(function(t){return e({type:S}),e(Object(A.B)({message:"Acheteur / Master bien ajout\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"})),e(k()),e(H(a)),t})}).catch(function(a){throw e({type:C}),e(Object(A.B)({message:N.a.map(y.a.parseApiErrors(a),function(e,a){return"".concat(a,": ").concat(e)}).join(", "),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"})),a})}}(g,f.id)):a(function(e,a){var t=Object(O.a)({},e,{avatar:e.avatar?e.avatar["@id"]:null});return function(n,r){return j.a.put(e["@id"],t).then(function(e){return Promise.all([n({type:_}),n(Object(A.B)({message:"Acheteur / Master bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(function(){return n(H(a))})}).catch(function(e){n({type:C}),n(Object(A.B)({message:N.a.map(y.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(g,f.id)),X())}return Object(r.useEffect)(function(){t.props.open&&J()},[t.props.open,J]),Object(r.useEffect)(function(){x(m?N.a.set(Object(O.a)({},g),"avatar",m):N.a.set(Object(O.a)({},g),"avatar",null))},[m]),i.a.createElement(K.a,Object.assign({classes:{paper:"m-24"}},t.props,{onClose:X,fullWidth:!0,maxWidth:"xs"}),i.a.createElement(Z.a,{position:"static",elevation:1},i.a.createElement($.a,{className:"flex w-full"},i.a.createElement(o.a,{variant:"subtitle1",color:"inherit"},"new"===t.type?"Nouveau Acheteur / Master":g.name))),i.a.createElement(se.a,{onValidSubmit:le,onValid:function(){Y(!0)},onInvalid:function(){Y(!1)},ref:W,className:"flex flex-col overflow-hidden"},i.a.createElement(h.a,{classes:{root:"p-24"}},i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"Soci\xe9t\xe9",id:"societe",name:"societe",value:g.societe,onChange:w,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"Nom",autoFocus:!0,id:"lastName",name:"lastName",value:g.lastName,onChange:w,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"Pr\xe9nom",id:"firstName",name:"firstName",value:g.firstName,onChange:w,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"Adresse 1",id:"adresse1",name:"adresse1",value:g.adresse1,onChange:w,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"Adresse 2",id:"adresse2",name:"adresse2",value:g.adresse2,onChange:w,variant:"outlined",fullWidth:!0})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"Code postal",id:"codepostal",type:"number",name:"codepostal",value:N.a.toString(g.codepostal),onChange:w,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"T\xe9l\xe9phone",id:"phone",name:"phone",value:g.phone,onChange:w,variant:"outlined",required:!0,fullWidth:!0,validationErrors:{isDefaultRequiredValue:"Ce champ est requis"}})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",label:"E-mail",id:"email",name:"email",value:g.email,onChange:w,variant:"outlined",validations:"isEmail",validationErrors:{isEmail:"Ce n'est pas un email valide",isDefaultRequiredValue:"Ce champ est requis"},required:!0,fullWidth:!0})),"new"===t.type&&i.a.createElement("div",null,i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",type:G.showPassword?"text":"password",name:"password",label:"Mot de passe",value:g.password,onChange:w,variant:"outlined",required:!0,fullWidth:!0,InputProps:{endAdornment:i.a.createElement(ee.a,{position:"end"},i.a.createElement(d.a,{"aria-label":"toggle password visibility",onClick:Q,onMouseDown:P},G.showPassword?i.a.createElement(oe.a,null):i.a.createElement(me.a,null)))},validations:{minLength:6},validationErrors:{minLength:"Le mot de passe doit contenir au moins 6 caract\xe8res",isDefaultRequiredValue:"Ce champ est requis"}})),i.a.createElement("div",{className:"flex"},i.a.createElement(l.F,{className:"mb-24",type:G.showPassword?"text":"password",name:"confirmpassword",label:"Confirmer mot de passe",value:g.confirmpassword,onChange:w,validations:{equalsField:"password"},validationErrors:{equalsField:"Les mots de passe doivent correspondre",isDefaultRequiredValue:"Ce champ est requis"},variant:"outlined",required:!0,fullWidth:!0,InputProps:{endAdornment:i.a.createElement(ee.a,{position:"end"},i.a.createElement(d.a,{"aria-label":"toggle password visibility",onClick:Q,onMouseDown:P},G.showPassword?i.a.createElement(oe.a,null):i.a.createElement(me.a,null)))}}))),c?i.a.createElement("div",{style:{paddingBottom:10,paddingTop:10,textAlign:"center"}},i.a.createElement(ae.a,null)):m&&i.a.createElement("div",{style:{textAlign:"center",paddingBottom:10,paddingTop:10}},i.a.createElement(u.a,{src:"".concat(ie.d).concat(m),style:{margin:"0 auto",height:"150px",width:"150px"}})),i.a.createElement("div",{className:"flex items-center"},i.a.createElement(te.a,{control:i.a.createElement(ne.a,{checked:g.isactif,onChange:function(e){console.log("Toggling isactif to:",e.target.checked),x(Object(O.a)({},g,{isactif:e.target.checked}))}}),label:"Actif"}))," *",i.a.createElement("div",{className:"flex"},i.a.createElement("input",{accept:"image/*",className:"hidden",id:"button-file",type:"file",onChange:function(e){var t=e.target.files[0];t&&a(function(e){return function(a,t){var n=new FormData;n.append("file",e);var r=j.a.post("/api/avatars",n,{headers:{"Content-Type":"multipart/form-data"}});return a({type:R}),r.then(function(e){return Promise.all([e,a({type:q,payload:e.data}),a(Object(A.B)({message:"Image t\xe9l\xe9charg\xe9e!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))])}).catch(function(e){a({type:I}),a(Object(A.B)({message:N.a.map(y.a.parseApiErrors(e),function(e,a){return a+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"}))})}}(t))}}),i.a.createElement("label",{htmlFor:"button-file"},i.a.createElement(b.a,{variant:"outlined",component:"span",className:"flex flex-1",disabled:c},"T\xe9l\xe9charger une image")))),"edit"===t.type?i.a.createElement(v.a,{className:"justify-between p-8"},i.a.createElement("div",{className:"px-16"},i.a.createElement(b.a,{variant:"contained",color:"primary",onClick:le,disabled:!L},"Sauvegarder")),i.a.createElement(d.a,{className:"min-w-auto",onClick:function(){a(F(g,f.id)),a(V()),X()}},i.a.createElement(p.a,null,"delete"))):i.a.createElement(v.a,{className:"justify-between p-8"},i.a.createElement("div",{className:"px-16"},i.a.createElement(b.a,{variant:"contained",color:"primary",type:"submit",disabled:!L},"Ajouter")))))},fe=t(46),he={entities:null,searchText:"",selectedTeamsIds:[],routeParams:{},teamsDialog:{type:"new",props:{open:!1},data:null},avatar:null,imageReqInProgress:!1},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case w:return Object(O.a)({},e,{entities:a.payload});case x:return Object(O.a)({},e,{searchText:a.searchText});case P:return Object(O.a)({},e,{teamsDialog:{type:"new",props:{open:!0},data:null}});case T:return Object(O.a)({},e,{teamsDialog:{type:"new",props:{open:!1},data:null}});case M:return Object(O.a)({},e,{teamsDialog:{type:"edit",props:{open:!0},data:a.data}});case D:return Object(O.a)({},e,{teamsDialog:{type:"edit",props:{open:!1},data:null}});case R:return Object(O.a)({},e,{imageReqInProgress:!0});case q:return Object(O.a)({},e,{avatar:a.payload,imageReqInProgress:!1});case I:return Object(O.a)({},e,{imageReqInProgress:!1});case"[TEAMS APP APP] REQUEST_SAVE":return Object(O.a)({},e,{loading:!0});case"[TEAMS APP APP]  SAVE_DATA":return Object(O.a)({},e,{loading:!1});default:return e}},ve={state:!1,options:{children:"Hi"}},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case A.f:return Object(O.a)({},e,{state:!0,options:Object(O.a)({},e.options,a.options)});case A.a:return Object(O.a)({},e,{state:!1});default:return e}},ge=Object(fe.d)({teams:Ee,dialog:be}),Oe=t(346);t(1059);a.default=Object(c.a)("teamsApp",ge)(function(e){var a=Object(s.b)(),t=Object(r.useRef)(null),c=Object(s.c)(function(e){return e.auth.user}),o=Object(s.c)(function(e){return e.auth.user.abonnement}),u=Object(s.c)(function(e){return e.auth.user.loadingAbonnement}),m=Object(r.useState)(!1),d=Object(n.a)(m,2),p=(d[0],d[1]),f=Object(r.useState)(!0),h=Object(n.a)(f,2),E=(h[0],h[1]),v=Object(r.useState)(!1),b=Object(n.a)(v,2),g=(b[0],b[1]),O=Object(r.useState)(0),j=Object(n.a)(O,2),y=(j[0],j[1]);return Object(r.useEffect)(function(){if(o)if(o.statut){var e=z()(o.expired).diff(z()(),"days");y(e),e<=0&&g(!0),o.statut&&e>0&&p(!0)}else E(!1)},[o]),Object(r.useEffect)(function(){c.id&&a(H(c.id))},[a,c]),u?i.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},i.a.createElement(ae.a,{color:"secondary"})," \u2002 Chargement ..."):i.a.createElement(i.a.Fragment,null,i.a.createElement(Oe.Helmet,null,i.a.createElement("title",null,"Acheteur / Master | Les Achats Industriels"),i.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),i.a.createElement("meta",{name:"googlebot",content:"noindex"})),i.a.createElement(l.p,{classes:{contentWrapper:"p-0 sm:p-24 pb-80 sm:pb-80 h-full",content:"flex flex-col h-full",leftSidebar:"w-256 border-0",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:i.a.createElement(X,{pageLayout:t}),content:i.a.createElement(G,null),sidebarInner:!0,ref:t,innerScroll:!0}),i.a.createElement(pe,null))})}}]);