(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{1284:function(e,t,a){"use strict";var n=a(50),r=a(59),l=a.n(r);const i="[CONSULTATIONS FOURNISSEUR APP] REQUEST CONSULTATIONS",o="[CONSULTATIONS FOURNISSEUR APP] SET PARAMETRES DATA",c="[USERS APP] GET CONSULTATIONS",s="[USERS APP] SET CONSULTATIONS SEARCH TEXT";function d(e,t){var a="";e.search.length>0&&e.search.map(function(e,t){e.value&&("created"===e.id||"dateExpiration"===e.id?a+="&"+e.id+"[after]="+e.value:"demande.statut"===e.id?"1"===e.value?a+="&demande.statut=1&demande.dateExpiration[strictly_after]=".concat(l()().format("YYYY-MM-DDTHH:mm:ss")):"3"===e.value&&(a+="&demande.dateExpiration[strictly_before]=".concat(l()().format("YYYY-MM-DDTHH:mm:ss"))):a+="&"+e.id+"="+e.value)});const r=n.a.get("/api/detail_visites?page=".concat(e.page).concat(a,"&fournisseur=").concat(t,"&order[").concat(e.filter.id,"]=").concat(e.filter.direction));return e=>(e({type:i}),r.then(t=>e({type:c,payload:t.data})))}function u(e){return{type:o,parametres:e}}var m=a(39),p=a(33);const f="[CONSULTATION FOURNISSEUR APP] REQUEST CONSULTATION",g="[CONSULTATION FOURNISSEUR APP] GET CONSULTATION",E="[CONSULTATION FOURNISSEUR APP] GET_PERSONNELS",h="[CONSULTATION FOURNISSEUR APP] REQUEST SAVE",N="[CONSULTATION FOURNISSEUR APP] SAVE CONSULTANTION",b="[CONSULTATION FOURNISSEUR APP] SAVE ERROR",S="[CONSULTATION FOURNISSEUR APP] CLEAN_UP";function O(){return e=>e({type:S})}function T(e){const t=n.a.get("/api/detail_visites/".concat(e));return e=>(e({type:f}),t.then(t=>{e({type:g,payload:t.data})}))}function v(e){const t=n.a.get("/api/fournisseurs/".concat(e,"/personnels"));return e=>t.then(t=>{e({type:E,payload:t.data["hydra:member"]})})}function x(e){let t={budget:parseFloat(e.budget),personnel:e.personnel?e.personnel.value:null,sendEmail:!!e.sendEmail&&e.sendEmail};const a=n.a.put(e["@id"],t);return e=>(e({type:h}),a.then(t=>(e(Object(p.B)({message:"Consultation Modifi\xe9e"})),e({type:N,payload:t.data}))).catch(t=>{e({type:b,payload:m.y.parseApiErrors(t)})}))}a.d(t,"f",function(){return i}),a.d(t,"k",function(){return o}),a.d(t,"c",function(){return c}),a.d(t,"j",function(){return s}),a.d(t,"n",function(){return d}),a.d(t,"q",function(){return u}),a.d(t,"e",function(){return f}),a.d(t,"b",function(){return g}),a.d(t,"d",function(){return E}),a.d(t,"g",function(){return h}),a.d(t,"h",function(){return N}),a.d(t,"i",function(){return b}),a.d(t,"a",function(){return S}),a.d(t,"l",function(){return O}),a.d(t,"m",function(){return T}),a.d(t,"o",function(){return v}),a.d(t,"p",function(){return x})},1350:function(e,t,a){"use strict";var n=a(43),r=a(1284),l=a(102);const i={data:[],pageCount:null,loading:!1,searchText:"",parametres:{page:1,description:"",search:[],filter:{id:"created",direction:"desc"}}};var o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.f:return{...e,loading:!0};case r.c:return{...e,data:t.payload["hydra:member"],pageCount:l.a.hydraPageCount(t.payload),loading:!1};case r.j:return{...e,searchText:t.searchText};case r.k:return{...e,parametres:{page:t.parametres.page,search:t.parametres.search,description:t.parametres.description,filter:{id:t.parametres.filter.id,direction:t.parametres.filter.direction}}};default:return e}};const c={data:null,error:null,loading:!1,personnels:null,request:!1};var s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.e:return{...e,loading:!0};case r.g:return{...e,request:!0};case r.a:return{...e,data:null,loading:!1,error:null};case r.b:return{...e,data:t.payload,loading:!1};case r.d:return{...e,personnels:t.payload};case r.h:return{...e,request:!1};case r.i:return{...e,error:t.payload,loading:!1};default:return e}};const d=Object(n.d)({consultations:o,consultation:s});t.a=d},1579:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(39),i=a(136),o=a(1151),c=a(1231),s=a(1160),d=a(1221),u=a(1204),m=a(1140),p=a(71),f=a(1284),g=a(7),E=a(59),h=a.n(E),N=a(102),b=a(365),S=a(1226),O=a(10);const T=Object(S.a)(e=>({root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},chip:{marginLeft:e.spacing(1),padding:2,background:"#ef5350",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chip2:{marginLeft:e.spacing(1),padding:2,background:"#4caf50",color:"white",fontWeight:"bold",fontSize:"11px",height:20},chipOrange:{marginLeft:e.spacing(1),padding:2,background:"#ff9800",color:"white",fontWeight:"bold",fontSize:"11px",height:20}}));var v=Object(p.g)(function(e){const t=T(),a=Object(g.b)(),i=Object(g.c)(e=>{let{consultationsFrsApp:t}=e;return t.consultations.data}),p=Object(g.c)(e=>{let{consultationsFrsApp:t}=e;return t.consultations.loading}),E=Object(g.c)(e=>{let{consultationsFrsApp:t}=e;return t.consultations.pageCount}),S=Object(g.c)(e=>{let{consultationsFrsApp:t}=e;return t.consultations.parametres}),v=Object(g.c)(e=>{let{consultationsFrsApp:t}=e;return t.consultations.searchText}),[x,y]=Object(n.useState)(null),A=Object(g.c)(e=>{let{auth:t}=e;return t.user});if(Object(n.useEffect)(()=>{i&&y(function(e,t){const a=Object.keys(e).map(t=>e[t]);return 0===t.length?a:N.a.filterArrayByString(a,t)}(i,v))},[i,v]),!x)return null;const C=O.a.debounce(e=>a(f.q(e)),1e3);return r.a.createElement(l.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(b.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:(t,a,n)=>({className:"h-64 cursor-pointer",onClick:(t,n)=>{a&&e.history.push("/consultations/"+a.original.id)}}),getTheadProps:(e,t,a)=>({className:"h-64 font-bold"}),data:x,columns:[{Header:"R\xe9f\xe9rence",className:"font-bold",filterable:!0,accessor:"demande.reference",Cell:e=>e.original.demande.reference?"RFQ-"+e.original.demande.reference:"En attente",Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement(o.a,{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:"",InputProps:{startAdornment:r.a.createElement(c.a,{position:"start"},"RFQ-")}})}},{Header:"\xc9tat",sortable:!1,accessor:"demande.statut",filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},h()(e.original.demande.dateExpiration)>=h()()?0===e.original.demande.statut?r.a.createElement("strong",{className:"text-orange"},"En attente"):1===e.original.demande.statut?r.a.createElement("strong",{className:"text-green"},"En cours"):r.a.createElement(s.a,{className:t.chip,label:"Refus\xe9e"}):r.a.createElement("strong",{className:"text-red"},"Expir\xe9e")),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement("select",{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"1"},"En cours"),r.a.createElement("option",{value:"3"},"Expir\xe9e"))}},{Header:"Affect\xe9e \xe0",className:"font-bold",filterable:!0,accessor:"personnel.name",Cell:e=>e.original.personnel?e.original.personnel.name:""},{Header:"Budget",className:"font-bold",accessor:"budget",sortable:!1,filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},e.original.budget,"\u2002",A.data&&A.data.currency?A.data.currency:"")},{Header:"Societ\xe9",accessor:"demande.acheteur.societe",sortable:!1,filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},e.original.demande.acheteur.societe,r.a.createElement(d.a,{title:e.original.demande.acheteur.firstName+" "+e.original.demande.acheteur.lastName},r.a.createElement(u.a,null,"account_circle")))},{Header:"Description",accessor:"demande.description",filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},O.a.capitalize(O.a.truncate(e.original.demande.description,{length:15,separator:" "})))},{Header:"Date d'expiration",accessor:"demande.dateExpiration",minWidth:125,filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},h()(e.original.demande.dateExpiration).format("DD/MM/YYYY"),h()(e.original.demande.dateExpiration)>=h()()?r.a.createElement(s.a,{className:t.chip2,label:0===h()(e.original.demande.dateExpiration).diff(h()(),"days")?h()(e.original.demande.dateExpiration).diff(h()(),"hours")+" h":h()(e.original.demande.dateExpiration).diff(h()(),"days")+" j"}):r.a.createElement(s.a,{className:t.chip,label:0===h()(e.original.demande.dateExpiration).diff(h()(),"days")?h()(e.original.demande.dateExpiration).diff(h()(),"hours")+" h":h()(e.original.demande.dateExpiration).diff(h()(),"days")+" j"})),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement(o.a,{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:"",type:"date",InputLabelProps:{shrink:!0}})}},{Header:"Statut",accessor:"statut",sortable:!1,filterable:!0,Cell:e=>r.a.createElement("div",{className:"flex items-center"},0===e.original.statut?r.a.createElement(s.a,{className:t.chipOrange,label:"En cours"}):1===e.original.statut?r.a.createElement(s.a,{className:t.chip2,label:"Gagn\xe9e"}):r.a.createElement(s.a,{className:t.chip,label:"Perdue"})),Filter:e=>{let{filter:t,onChange:a}=e;return r.a.createElement("select",{onChange:e=>a(e.target.value),style:{width:"100%"},value:t?t.value:""},r.a.createElement("option",{value:""},"Tous"),r.a.createElement("option",{value:"0"},"En cours"),r.a.createElement("option",{value:"1"},"Gagn\xe9e"),r.a.createElement("option",{value:"2"},"Perdue"))}},{Header:"",Cell:e=>r.a.createElement("div",{className:"flex items-center"},r.a.createElement(d.a,{title:"D\xe9tails"},r.a.createElement(m.a,{className:"text-teal text-20"},r.a.createElement(u.a,null,"remove_red_eye"))))}],manual:!0,defaultSortDesc:!0,pages:E,page:S.page-1,defaultPageSize:10,loading:p,showPageSizeOptions:!1,onPageChange:e=>{S.page=e+1,a(f.q(S))},onSortedChange:(e,t,n)=>{S.page=1,S.filter.id=e[0].id,S.filter.direction=e[0].desc?"desc":"asc",a(f.q(S))},onFilteredChange:e=>{S.page=1,S.search=e,C(S)},noDataText:"Aucune consultation trouv\xe9e",loadingText:"Chargement...",ofText:"sur"}))}),x=a(89);var y=function(e){return r.a.createElement("div",{className:"flex flex-1 w-full items-center justify-between"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(l.d,{animation:"transition.expandIn",delay:300},r.a.createElement(u.a,{className:"text-32 mr-0 sm:mr-12"},"move_to_inbox")),r.a.createElement(l.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(x.a,{className:"hidden sm:flex",variant:"h6"},"Vos consultations"))))},A=a(1350),C=a(364);t.default=Object(i.a)("consultationsFrsApp",A.a)(function(){const e=Object(g.b)(),t=Object(g.c)(e=>{let{consultationsFrsApp:t}=e;return t.consultations.parametres}),a=Object(g.c)(e=>{let{auth:t}=e;return t.user});return Object(n.useEffect)(()=>{a&&e(f.n(t,a.id))},[e,t,a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(C.Helmet,null,r.a.createElement("title",null,"Mes consultations | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(l.o,{classes:{content:"flex flex-col h-full",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(y,null),content:r.a.createElement(v,null),innerScroll:!0}))})}}]);