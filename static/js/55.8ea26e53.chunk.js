(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{1242:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};t.default=n},1244:function(e,t,a){"use strict";var n=a(3),r=a.n(n),s=a(4),l=a.n(s),i=a(0),c=a.n(i),o=a(2),u=a(8),m=a(89),d=c.a.forwardRef(function(e,t){var a=e.children,n=e.classes,s=e.className,i=e.disableTypography,u=void 0!==i&&i,d=l()(e,["children","classes","className","disableTypography"]);return c.a.createElement("div",r()({className:Object(o.a)(n.root,s),ref:t},d),u?a:c.a.createElement(m.a,{variant:"h6"},a))});t.a=Object(u.a)({root:{margin:0,padding:"16px 24px",flex:"0 0 auto"}},{name:"MuiDialogTitle"})(d)},1245:function(e,t,a){"use strict";var n=a(3),r=a.n(n),s=a(0),l=a.n(s),i=a(8),c=a(89),o=l.a.forwardRef(function(e,t){return l.a.createElement(c.a,r()({component:"p",variant:"body1",color:"textSecondary",ref:t},e))});t.a=Object(i.a)({root:{marginBottom:16}},{name:"MuiDialogContentText"})(o)},1533:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(39),l=a(7),i=a(136),c=a(89),o=a(1221),u=a(1140),m=a(1204),d=a(365),p=a(50),g=a(102),E=a(33),f=a(10);const h="[BLACK_LISTES APP] GET BLACK_LISTES",b="[BLACK_LISTES APP] SET SEARCH TEXT",v="[BLACK_LISTES APP] OPEN NEW BLACK_LISTES DIALOG",S="[BLACK_LISTES APP] CLOSE NEW BLACK_LISTES DIALOG",y="[BLACK_LISTES APP] OPEN EDIT BLACK_LISTES DIALOG",O="[BLACK_LISTES APP] CLOSE EDIT BLACK_LISTES DIALOG",L="[BLACK_LISTES APP] SAVE ERROR",A="[BLACK_LISTES APP]  SAVE_DATA",N="[BLACK_LISTES APP] REMOVE BLACK_LISTE",T="[BLACK_LISTES APP] REQUEST_SAVE";function C(e){const t=p.a.get("/api/acheteurs/".concat(e,"/blacklistes"));return e=>t.then(t=>{e({type:h,payload:t.data["hydra:member"]})})}function x(){return{type:S}}function k(){return{type:O}}function P(e,t,a){let n={etat:t};return r=>{const s=p.a.put(e["@id"],n);p.a.put(e["@id"],n);return s.then(e=>Promise.all([r({type:N}),r(Object(E.B)({message:t?"Bien blacklist\xe9":"Bien d\xe9blacklist\xe9",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"}))]).then(()=>r(C(a))))}}const j="[DIALOG] OPEN",I="[DIALOG] CLOSE";function w(){return{type:I}}var R=a(60),B=a.n(R);const F="[SEARCH FOURNISSEURAPP] SF_SET_SEARCH_TEXT",D="[SEARCH FOURNISSEURAPP] REQUEST_DATA",_="[SEARCH FOURNISSEURAPP] GET_DATA",H="[SEARCH FOURNISSEURAPP] SF_OPEN",U="[SEARCH FOURNISSEURAPP] SF_CLOSE",M="[SEARCH FOURNISSEURAPP] CLEAN_UP",z=B.a.CancelToken;let K,W;function G(e){return W&&clearTimeout(W),t=>{t({type:D}),W=setTimeout(()=>{t(function(e){K&&K();const t=p.a.get("/api/fournisseurs?societe=".concat(e,"&del=false&isactif=true&props[]=id&props[]=societe&props[]=firstName&props[]=lastName"),{cancelToken:new z(function(e){K=e})});return e=>t.then(t=>{e({type:_,payload:t.data})}).catch(e=>{B.a.isCancel(e)&&console.log("get canceled")})}(e))},300+1e3*Math.random())}}var V=a(59),Y=a.n(V);var q=function(e){const t=Object(l.b)(),a=Object(l.c)(e=>{let{blackListesApp:t}=e;return t.blackListes.entities}),i=Object(l.c)(e=>{let{blackListesApp:t}=e;return t.blackListes.searchText}),p=Object(l.c)(e=>{let{auth:t}=e;return t.user}),[g,E]=Object(n.useState)(null);return Object(n.useEffect)(()=>{a&&E(function(e,t){const a=Object.keys(e).map(t=>e[t]);return 0===t.length?a:s.y.filterArrayByString(a,t)}(a,i))},[a,i]),g?0===g.length?r.a.createElement("div",{className:"flex flex-1 items-center justify-center h-full"},r.a.createElement(c.a,{color:"textSecondary",variant:"h5"},"La liste est vide!")):r.a.createElement(s.d,{animation:"transition.slideUpIn",delay:300},r.a.createElement(d.b,{className:"-striped -highlight h-full sm:rounded-16 overflow-hidden",getTrProps:(e,a,n)=>({className:"cursor-pointer",onClick:(e,n)=>{a&&t(function(e){return{type:y,data:e}}(a.original))}}),getTheadProps:(e,t,a)=>({className:"h-64 font-bold"}),data:g,columns:[{Header:"Fournisseur",className:"font-bold",filterable:!0,id:"fournisseur",accessor:e=>e.fournisseur.societe},{Header:"Raison",accessor:"raison",filterable:!0,className:"font-bold"},{Header:"Date de Blackliste",id:"created",accessor:e=>Y()(e.created).format("DD/MM/YYYY HH:mm")},{Header:"Date de D\xe9blackliste",id:"deblacklister",accessor:e=>e.deblacklister?Y()(e.deblacklister).format("DD/MM/YYYY HH:mm"):""},{Header:"Etat",accessor:"etat",Cell:e=>e.original.etat?r.a.createElement(o.a,{title:"Blacklist\xe9"},r.a.createElement(u.a,{className:"text-red text-20",onClick:a=>{a.stopPropagation(),t(P(e.original,!1,p.id))}},r.a.createElement(m.a,null,"remove_circle"))):r.a.createElement(o.a,{title:"D\xe9blacklist\xe9"},r.a.createElement(u.a,{className:"text-green text-20",onClick:a=>{a.stopPropagation(),t(P(e.original,!0,p.id))}},r.a.createElement(m.a,null,"check_circle")))}],defaultPageSize:10,noDataText:"Aucun fournisseur blacklist\xe9",ofText:"sur"})):null},J=a(1227);var Q=function(e){const t=Object(l.b)();return Object(l.c)(e=>{let{blackListesApp:t}=e;return t.blackListes.searchText}),Object(l.c)(e=>{let{fuse:t}=e;return t.settings.mainTheme}),r.a.createElement("div",{className:"flex flex-1 items-center justify-between p-8 sm:p-24"},r.a.createElement("div",{className:"flex items-center"},r.a.createElement(s.d,{animation:"transition.expandIn",delay:300},r.a.createElement(m.a,{className:"text-32 mr-0 sm:mr-12"},"help_outline")),r.a.createElement(s.d,{animation:"transition.slideLeftIn",delay:300},r.a.createElement(c.a,{className:"hidden sm:flex",variant:"h6"},"G\xe9rer les Blacklistes Fournisseurs ( liste noire )"))),r.a.createElement("div",{className:"flex flex-1 items-center justify-center px-12"}),r.a.createElement(s.d,{animation:"transition.slideRightIn",delay:300},r.a.createElement(J.a,{onClick:e=>t({type:v}),className:"whitespace-no-wrap",variant:"contained"},r.a.createElement("span",{className:"hidden sm:flex"},"Blacklister un Fournisseur"),r.a.createElement("span",{className:"flex sm:hidden"},"New"))))},X=a(1209),Z=a(1223),$=a(1218),ee=a(1228),te=a(1229),ae=a(1150),ne=a(1233),re=a(1160),se=a(1230),le=a(1244),ie=a(1245),ce=a(137),oe=a(51),ue=a.n(oe),me=a(139),de=a.n(me),pe=a(1242),ge=a.n(pe),Ee=a(1151),fe=a(135),he=a(1147),be=a(1226),ve=a(371),Se=a.n(ve);const ye={raison:"",fournisseur:"",fournisseurEx:"",email:"",pays:"",ville:"",ice:"",siret:"",OUT:!1},Oe=Object(be.a)(e=>({root:{height:250,flexGrow:1},container:{position:"relative",width:"100%"},suggestion:{display:"block"},suggestionsList:{margin:0,padding:0,listStyleType:"none"},divider:{height:e.spacing(2)},buttonProgress:{color:ge.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}));function Le(e,t){let{query:a,isHighlighted:n}=t;return r.a.createElement(he.a,{selected:n,component:"div",className:"z-999",dense:!0},r.a.createElement(X.a,{className:"pl-0 ",primary:r.a.createElement(Se.a,{highlightClassName:"YourHighlightClass",searchWords:[a],autoEscape:!0,textToHighlight:e.societe}),secondary:e.firstName+" "+e.lastName}))}function Ae(e){const{classes:t,inputRef:a=(()=>{}),ref:n,...s}=e;return r.a.createElement(Ee.a,Object.assign({fullWidth:!0,InputProps:{inputRef:e=>{n(e),a(e)},classes:{input:t.input}}},s))}var Ne=function(e){const t=Oe(),a=Object(l.b)(),i=Object(l.c)(e=>{let{blackListesApp:t}=e;return t.blackListes.blackListesDialog}),o=Object(l.c)(e=>{let{blackListesApp:t}=e;return t.blackListes.loading}),d=Object(l.c)(e=>{let{blackListesApp:t}=e;return t.searchFournisseur}),[h,b]=r.a.useState(null),v=Object(l.c)(e=>{let{auth:t}=e;return t.user}),{form:S,handleChange:y,setForm:O}=Object(ce.b)(ye),N=Object(n.useRef)(null),I=Object(n.useRef)(null),[R,B]=Object(n.useState)(!1),D=Object(n.useRef)(null),_=Object(n.useCallback)(()=>{"edit"===i.type&&i.data&&(O({...i.data}),b(i.data.fournisseur),O(f.a.set({...i.data},"fournisseur",i.data.fournisseur["@id"]))),"new"===i.type&&O({...ye,...i.data})},[i.data,i.type,O]);function z(){"edit"===i.type?a(k()):a(x())}function K(e,t){O(f.a.set({...S},t,e.target.checked))}function W(){a(P(S,v.id)),a(w()),z()}function V(){a({type:H})}function Y(){a({type:U})}Object(n.useEffect)(()=>{i.props.open&&_()},[i.props.open,_]);const q={renderInputComponent:Ae,highlightFirstSuggestion:!0,suggestions:d.suggestions,onSuggestionsFetchRequested:function(e){let{value:t}=e;t.trim().length>1&&a(G(t.trim()))},onSuggestionsClearRequested:function(){a(e=>e({type:M}))},renderSuggestion:Le},[Q,X]=Object(n.useState)(""),[oe,me]=Object(n.useState)(""),[pe,ge]=Object(n.useState)(""),[Ee,he]=Object(n.useState)(""),[be,ve]=Object(n.useState)("");function K(e){O(f.a.set({...S},"OUT",e.target.checked)),e.target.checked?Y():V()}return Object(n.useEffect)(()=>{(e=>{ve("Maroc"===e?"ICE":"SIRET")})(Q)},[Q]),r.a.createElement(Z.a,Object.assign({classes:{paper:"m-24 overflow-visible"}},i.props,{onClose:z,fullWidth:!0,maxWidth:"xs"}),r.a.createElement($.a,{position:"static",elevation:1},r.a.createElement(ee.a,{className:"flex w-full"},r.a.createElement(c.a,{variant:"subtitle1",color:"inherit"},"new"===i.type?"Nouveau Fournisseur \xe0 BlackList\xe9":"Editer BlackListe"))),r.a.createElement(ue.a,{onValidSubmit:function(e){const t=Q,n=pe;let r="";r="Maroc"===t?S.ice:S.siret;const s={...S,pays:t,ville:n,ice:r};var l,c;"new"===i.type?a((l=s,c=v.id,e=>{e({type:T});const t=p.a.post("/api/black_listes",l),a=p.a.post("/api/mediateurs",l);return t.then(t=>Promise.all([a,e({type:A}),e(Object(E.B)({message:"Blacklist\xe9 avec succ\xe8s!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"})),e(x())]).then(()=>e(C(c)))).catch(t=>{e({type:L}),e(Object(E.B)({message:f.a.map(g.a.parseApiErrors(t),function(e,t){return t+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"})),e(x())})})):a(function(e,t){return a=>(a({type:T}),p.a.put(e["@id"],e).then(e=>Promise.all([a({type:A}),a(Object(E.B)({message:"Bien modifi\xe9!",anchorOrigin:{vertical:"top",horizontal:"right"},variant:"success"})),a(k())]).then(()=>a(C(t)))).catch(e=>{a({type:L}),a(Object(E.B)({message:f.a.map(g.a.parseApiErrors(e),function(e,t){return t+": "+e}),autoHideDuration:6e3,anchorOrigin:{vertical:"top",horizontal:"right"},variant:"error"})),a(k())}))}(s,v.id)),z()},onValid:function(){B(!0)},onInvalid:function(){B(!1)},ref:D,className:"flex flex-col overflow-visible"},r.a.createElement(te.a,{classes:{root:"p-24 overflow-visible"}},!S.OUT&&r.a.createElement("div",{className:"flex"},r.a.createElement("h5",null,"Pour ajouter \xe0 cette liste un fournisseur hors liste, veuillez saisir ",r.a.createElement("span",{style:{color:"red"}},"Fournisseur externe")," dans la barre de recherche.")),r.a.createElement("br",null),!S.OUT&&r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"min-w-48 pt-20"},r.a.createElement(m.a,{color:"action"},"work")),r.a.createElement("div",{className:"w-full",ref:I},r.a.createElement(de.a,Object.assign({},q,{getSuggestionValue:e=>e.societe,onSuggestionSelected:(e,t)=>{let{suggestion:a,method:n}=t;"enter"===n&&e.preventDefault(),b(a),O(f.a.set({...S},"fournisseur",a["@id"])),Y()},required:!0,inputProps:{classes:t,label:"Fournisseur",placeholder:"Cherchez le Fournisseur \xe0 blacklist\xe9",value:d.searchText,variant:"outlined",name:"fournisseur",onChange:function(e){a(function(e){return{type:F,searchText:e.target.value}}(e))},onFocus:V,InputLabelProps:{shrink:!0}},theme:{container:t.container,suggestionsContainerOpen:t.suggestionsContainerOpen,suggestionsList:t.suggestionsList,suggestion:t.suggestion},renderSuggestionsContainer:e=>r.a.createElement(ae.a,{anchorEl:I.current,open:Boolean(e.children)||d.noSuggestions||d.loading,popperOptions:{positionFixed:!0},className:"z-9999"},r.a.createElement("div",{ref:N},r.a.createElement(fe.a,Object.assign({elevation:1,square:!0},e.containerProps,{style:{width:I.current?I.current.clientWidth:null}}),e.children,d.noSuggestions&&r.a.createElement(c.a,{className:"px-16 py-12"},"Aucun r\xe9sultat.."),d.loading&&r.a.createElement("div",{className:"px-16 py-12 text-center"},r.a.createElement(ne.a,{color:"secondary"})," ",r.a.createElement("br",null)," Chargement ..."))))})))),h&&r.a.createElement(re.a,{label:h.societe,onDelete:function(){b(null),O(f.a.set({...S},"fournisseur",null))},className:"mt-8 ml-48"}),r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"min-w-48 "}),r.a.createElement(s.a,{className:"mb-24",name:"OUT",checked:S.OUT,label:S.OUT?"Fournisseur list\xe9":"Fournisseur Hors liste",onChange:K,fullWidth:!0})),!S.OUT&&r.a.createElement("div",{className:"flex"},r.a.createElement("select",{value:oe,onChange:e=>{me(e.target.value)}},r.a.createElement("option",{value:""},"S\xe9lectionnez un Raison"),["Probl\xe8me de communication","Retard de livraison","Non-conformit\xe9","Litiges sur les paiements","Augmentation des co\xfbts"].map((e,t)=>r.a.createElement("option",{key:t,value:e},e)))),!S.OUT&&r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"min-w-48 pt-20"},r.a.createElement(m.a,{color:"action"},"chat")),r.a.createElement(s.F,{className:"mb-24 mt-24",label:"Autres",id:"raison",name:"raison",value:S.raison,onChange:y,variant:"outlined",validations:{minLength:6},validationErrors:{minLength:"La longueur minimale des caract\xe8res est de 6"},required:!0,multiline:!0,rows:"4",fullWidth:!0})),S.OUT&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"flex",style:{marginTop:"-15px"}},r.a.createElement("select",{value:Q,onChange:e=>{X(e.target.value),ge(""),"Maroc"!==e.target.value?he("SIRET"):he("ICE"),O({...S,ice:"",siret:""})}},r.a.createElement("option",{value:""},"S\xe9lectionnez un pays"),["France","Allemagne","Espagne","Maroc"].map((e,t)=>r.a.createElement("option",{key:t,value:e},e))),Q&&r.a.createElement("select",{value:pe,onChange:e=>{ge(e.target.value),O({...S,ice:"",siret:""})}},r.a.createElement("option",{value:""},"S\xe9lectionnez une ville"),{France:["Paris","Marseille","Lyon"],Allemagne:["Berlin","Hambourg","Munich"],Espagne:["Madrid","Barcelone","Valence"],Maroc:["Casablanca","Rabat","Fes"]}[Q].map((e,t)=>r.a.createElement("option",{key:t,value:e},e))),Q&&pe&&r.a.createElement("div",null,r.a.createElement("p",null,"Pays s\xe9lectionn\xe9 : ",Q),r.a.createElement("p",null,"Ville s\xe9lectionn\xe9e : ",pe))),r.a.createElement("div",{className:"flex",style:{marginTop:"-15px"}},r.a.createElement(s.F,{className:"mb-24 mt-24",label:be,id:be.toLowerCase(),name:be.toLowerCase(),value:S[be.toLowerCase()],onChange:y,variant:"outlined",fullWidth:!0})),r.a.createElement("div",{className:"flex",style:{marginTop:"-15px"}},r.a.createElement(s.F,{className:"mb-24 mt-24",label:"Fournisseur *",id:"fournisseurEx",name:"fournisseurEx",value:S.fournisseurEx,onChange:y,variant:"outlined",fullWidth:!0})),r.a.createElement("div",{className:"flex",style:{marginTop:"-15px"}},r.a.createElement(s.F,{className:"mb-24 mt-24",label:"Email *",id:"email",name:"email",value:S.email,onChange:y,variant:"outlined",fullWidth:!0})),r.a.createElement(s.F,{className:"mb-24 mt-24",label:"raison *",id:"raison",name:"raison",value:S.raison,onChange:y,variant:"outlined",fullWidth:!0})),"edit"===i.type?r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"min-w-48 "}),r.a.createElement(s.a,{className:"mb-24 ",name:"etat",value:S.etat,label:"Blacklister",onChange:e=>K(e),fullWidth:!0})):""),"new"===i.type?r.a.createElement(se.a,{className:"pl-16"},r.a.createElement(J.a,{onClick:()=>a(x()),color:"primary"},"Annuler"),r.a.createElement(J.a,{variant:"contained",color:"primary",type:"submit",disabled:!R||!h||o},"Ajouter",o&&r.a.createElement(ne.a,{size:24,className:t.buttonProgress}))):r.a.createElement(se.a,{className:"justify-between pl-16"},r.a.createElement(J.a,{onClick:()=>a(k()),color:"primary"},"Annuler"),r.a.createElement(J.a,{variant:"contained",color:"primary",type:"submit",disabled:!R||!h||o},"Modifier",o&&r.a.createElement(ne.a,{size:24,className:t.buttonProgress})),r.a.createElement(u.a,{onClick:()=>a(function(e){return{type:j,options:e}}({children:r.a.createElement(r.a.Fragment,null,r.a.createElement(le.a,{id:"alert-dialog-title"},"Suppression"),r.a.createElement(te.a,null,r.a.createElement(ie.a,{id:"alert-dialog-description"},"Voulez vous vraiment supprimer cet enregistrement ?")),r.a.createElement(se.a,null,r.a.createElement(J.a,{onClick:()=>a(w()),color:"primary"},"Non"),r.a.createElement(J.a,{onClick:W,color:"primary",autoFocus:!0},"Oui")))}))},r.a.createElement(m.a,null,"delete")))))},Te=a(43);const Ce={entities:null,searchText:"",loading:!1,selectedSecteursIds:[],routeParams:{},blackListesDialog:{type:"new",props:{open:!1},data:null}};var xe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return{...e,loading:!0};case A:case L:return{...e,loading:!1};case h:return{...e,entities:t.payload};case b:return{...e,searchText:t.searchText};case v:return{...e,blackListesDialog:{type:"new",props:{open:!0},data:null}};case S:return{...e,blackListesDialog:{type:"new",props:{open:!1},data:null}};case y:return{...e,blackListesDialog:{type:"edit",props:{open:!0},data:t.data}};case O:return{...e,blackListesDialog:{type:"edit",props:{open:!1},data:null}};default:return e}};const ke={state:!1,options:{children:"Hi"}};var Pe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E.f:return{...e,state:!0,options:{...e.options,...t.options}};case E.a:return{...e,state:!1};default:return e}};const je={searchText:"",suggestions:[],loading:!1,opened:!1,noSuggestions:!1};var Ie=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return{...e,suggestions:[],noSuggestions:!1};case D:return{...e,loading:!0,suggestions:[],noSuggestions:!1};case _:{const a=t.payload["hydra:member"],n=0===a.length;return{...e,suggestions:a,noSuggestions:n,loading:!1}}case F:return{...e,searchText:t.searchText};case H:return{...e,opened:!0};case U:return{...e,opened:!1,searchText:""};default:return e}};var we=Object(Te.d)({blackListes:xe,dialog:Pe,searchFournisseur:Ie}),Re=a(364);t.default=Object(i.a)("blackListesApp",we)(function(e){const t=Object(l.b)(),a=Object(l.c)(e=>{let{auth:t}=e;return t.user}),i=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a&&t(C(a.id))},[t,a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Re.Helmet,null,r.a.createElement("title",null,"Black listes | Les Achats Industriels"),r.a.createElement("meta",{name:"robots",content:"noindex, nofollow"}),r.a.createElement("meta",{name:"googlebot",content:"noindex"})),r.a.createElement(s.o,{classes:{content:"flex flex-col h-full",header:"min-h-72 h-72 sm:h-136 sm:min-h-136"},header:r.a.createElement(Q,{pageLayout:i}),content:r.a.createElement(q,null),innerScroll:!0}),r.a.createElement(Ne,null))})}}]);